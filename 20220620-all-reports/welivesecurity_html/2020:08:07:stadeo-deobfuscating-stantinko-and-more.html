<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Vladislav Hrčka',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Stadeo: Deobfuscating Stantinko and more | WeLiveSecurity</title>
<meta name="description" content="ESET researchers introduce Stadeo, a set of scripts that can help fellow threat researchers and reverse engineers to deobfuscate the code of Stantinko and other malware."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/08/07/stadeo-deobfuscating-stantinko-and-more/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Stadeo: Deobfuscating Stantinko and more | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers introduce Stadeo, a set of scripts that can help fellow threat researchers and reverse engineers to deobfuscate the code of Stantinko and other malware." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/08/07/stadeo-deobfuscating-stantinko-and-more/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-08-07T12:00:43+00:00" />
<meta property="article:modified_time" content="2020-08-07T12:25:39+00:00" />
<meta property="og:updated_time" content="2020-08-07T12:25:39+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/08/wls_stadeo_unspl_1200.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/08/wls_stadeo_unspl_1200.jpg" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="627" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers introduce Stadeo, a set of scripts that can help fellow threat researchers and reverse engineers to deobfuscate the code of Stantinko and other malware." />
<meta name="twitter:title" content="Stadeo: Deobfuscating Stantinko and more | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/08/wls_stadeo_unspl_1200.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-courier-new-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/courier-new.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2020/08/10/stadeo-ferramenta-desofusca-codigo-stantinko/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2020/08/07/stadeo-desobfusquer-stantinko/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2020/08/07/stadeo-deobfuscating-stantinko-and-more/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/08/10/stadeo-herramienta-desofuscar-malware-statinko/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/08/07/stadeo-deobfuskationstool-fuer-das-stantinko-botnetz-und-mehr/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2020/08/10/stadeo-ferramenta-desofusca-codigo-stantinko/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/08/07/stadeo-desobfusquer-stantinko/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/08/10/stadeo-herramienta-desofuscar-malware-statinko/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/08/07/stadeo-deobfuskationstool-fuer-das-stantinko-botnetz-und-mehr/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2020/08/10/stadeo-ferramenta-desofusca-codigo-stantinko/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/08/07/stadeo-desobfusquer-stantinko/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/08/10/stadeo-herramienta-desofuscar-malware-statinko/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/08/07/stadeo-deobfuskationstool-fuer-das-stantinko-botnetz-und-mehr/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/08/wls_stadeo_unspl_1920.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Stadeo: Deobfuscating Stantinko and more</h1>
<div class="excerpt">We introduce Stadeo – a set of scripts that can help fellow threat researchers and reverse engineers to deobfuscate the code of Stantinko and other malware</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/vhrcka/" title="Vladislav Hrčka">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2019/11/vladislav-hrcka-222x179.jpg" alt="Vladislav Hrčka">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/vhrcka/" title="Vladislav Hrčka">
                    Vladislav Hrčka                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-08-07 14:00:43">7 Aug 2020 - 02:00PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F07%2Fstadeo-deobfuscating-stantinko-and-more%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F07%2Fstadeo-deobfuscating-stantinko-and-more%2F&text=Stadeo: Deobfuscating Stantinko and more%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F07%2Fstadeo-deobfuscating-stantinko-and-more%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>We introduce Stadeo – a set of scripts that can help fellow threat researchers and reverse engineers to deobfuscate the code of Stantinko and other malware</p>
                            </div>

                            <p>Stadeo is a set of tools primarily developed to facilitate analysis of <a href="https://www.welivesecurity.com/2017/07/20/stantinko-massive-adware-campaign-operating-covertly-since-2012/" target="_blank" rel="noopener">Stantinko</a>, which is a botnet performing click fraud, ad injection, social network fraud, password stealing attacks and <a href="https://www.welivesecurity.com/2019/11/26/stantinko-botnet-adds-cryptomining-criminal-activities/" target="_blank" rel="noopener">cryptomining</a>.</p>
<p>Stadeo was demonstrated for the first time at <a href="https://www.blackhat.com/us-20/arsenal/schedule/#stantinko-deobfuscation-arsenal-21025" target="_blank" rel="noopener">Black Hat USA 2020</a> and subsequently published for free use.</p>
<p>The scripts, written entirely in Python, deal with Stantinko’s unique control-flow-flattening (CFF) and string obfuscation techniques described in our March 2020 <a href="https://www.welivesecurity.com/2020/03/19/stantinko-new-cryptominer-unique-obfuscation-techniques/">blogpost</a>. Additionally, they can be utilized for other purposes: for example, we’ve already extended our approach to support deobfuscating the CFF featured in Emotet – a trojan that steals banking credentials and that downloads additional payloads such as ransomware.</p>
<p>Our deobfuscation methods use <a href="https://www.hex-rays.com/products/ida/">IDA</a>, which is a standard tool in the industry, and <a href="https://github.com/cea-sec/miasm" target="_blank" rel="noopener">Miasm</a> – an open source framework providing us with various data-flow analyses, a symbolic execution engine, a dynamic symbolic execution engine and the means to reassemble modified functions.</p>
<p>You can find Stadeo at <a href="https://github.com/eset/stadeo" target="_blank" rel="noopener">https://github.com/eset/stadeo</a>.</p>
<h2>Usage examples</h2>
<p>To work with Stadeo, we first need to set up a RPyC (Remote Python Call) server inside IDA, which allows us to access the IDA API from an arbitrary Python interpreter. You can use <a href="https://github.com/cea-sec/miasm/blob/master/example/ida/rpyc_ida.py" target="_blank" rel="noopener">this script</a> to open an RPyC server in IDA.</p>
<p>In all the examples below, we set up an RPyC server listening on 10.1.40.164:4455 (4455 being the default port), and then communicate with the server from a Python console.</p>
<p>We will use two Stadeo classes:</p>
<ul>
<li><strong>CFFStrategies</strong> for CFF deobfuscation</li>
<li><strong>StringRevealer</strong> for string deobfuscation</li>
</ul>
<p>Both classes can be initialized for both 32- and 64-bit architecture.</p>
<h3>Deobfuscating a single function</h3>
<p>SHA-1 of the sample: <span style="font-family: courier new, courier, monospace;">791ad58d9bb66ea08465aad4ea968656c81d0b8e</span></p>
<p>The code below deobfuscates the function at <strong>0x1800158B0</strong> with the parameter in the <strong>R9</strong> register set to <strong>0x567C</strong> and writes its deobfuscated version to the <strong>0x18008D000 </strong>address.</p>
<p>The <strong>R9</strong> parameter is a control variable for function-merging the CFF loop (merging variable) and it has to be specified using Miasm expressions, which are documented <a href="https://github.com/cea-sec/miasm/blob/master/doc/expression/expression.ipynb" target="_blank" rel="noopener">here</a>; note that one has to use <strong>RSP_init/ESP_init </strong>instead of <strong>RSP/ESP </strong>to refer to the stack parameters. For example, we would use <span style="font-family: courier new, courier, monospace;">ExprMem(ExprId(&#8220;ESP_init&#8221;, <strong>32</strong>) + ExprInt(<strong>4</strong>, <strong>32</strong>), <strong>32</strong>)</span> to target the first stack parameter on 32-bit architecture.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb355716c828836872" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from stadeo.cff.cff_strategies import CFFStrategies
from miasm.expression.expression import ExprId, ExprInt

cs = CFFStrategies(64)
cs.solve_loop(0x1800158B0,
              0x18008D000,
              context={ExprId("R9", 64): ExprInt(0x567c, 64)},
              ip='10.1.40.164')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb355716c828836872-1">1</div><div class="crayon-num" data-line="crayon-6057fb355716c828836872-2">2</div><div class="crayon-num" data-line="crayon-6057fb355716c828836872-3">3</div><div class="crayon-num" data-line="crayon-6057fb355716c828836872-4">4</div><div class="crayon-num" data-line="crayon-6057fb355716c828836872-5">5</div><div class="crayon-num" data-line="crayon-6057fb355716c828836872-6">6</div><div class="crayon-num" data-line="crayon-6057fb355716c828836872-7">7</div><div class="crayon-num" data-line="crayon-6057fb355716c828836872-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb355716c828836872-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">stadeo</span><span class="crayon-sy">.</span><span class="crayon-v">cff</span><span class="crayon-sy">.</span><span class="crayon-e">cff_strategies </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">CFFStrategies</span></div><div class="crayon-line" id="crayon-6057fb355716c828836872-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">miasm</span><span class="crayon-sy">.</span><span class="crayon-v">expression</span><span class="crayon-sy">.</span><span class="crayon-e">expression </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-v">ExprId</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-e">ExprInt</span></div><div class="crayon-line" id="crayon-6057fb355716c828836872-3">&nbsp;</div><div class="crayon-line" id="crayon-6057fb355716c828836872-4"><span class="crayon-v">cs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CFFStrategies</span><span class="crayon-sy">(</span><span class="crayon-cn">64</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb355716c828836872-5"><span class="crayon-v">cs</span><span class="crayon-sy">.</span><span class="crayon-e">solve_loop</span><span class="crayon-sy">(</span><span class="crayon-cn">0x1800158B0</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb355716c828836872-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0x18008D000</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb355716c828836872-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">context</span><span class="crayon-o">=</span><span class="crayon-sy">{</span><span class="crayon-e">ExprId</span><span class="crayon-sy">(</span><span class="crayon-s">"R9"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-sy">)</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">ExprInt</span><span class="crayon-sy">(</span><span class="crayon-cn">0x567c</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">64</span><span class="crayon-sy">)</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb355716c828836872-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ip</span><span class="crayon-o">=</span><span class="crayon-s">'10.1.40.164'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><div id="attachment_141691" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Call-to-the-obfuscated-function.png"><img class="wp-image-141691" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Call-to-the-obfuscated-function-150x150.png" alt="" width="700" height="406" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Call-to-the-obfuscated-function-300x174.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Call-to-the-obfuscated-function-257x149.png 257w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Call-to-the-obfuscated-function.png 719w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 1. Call to the obfuscated function</i></p></div></p>
<div id="attachment_141692" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Obfuscated-left-and-deobfuscated-right-CFG.png"><img class="wp-image-141692" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Obfuscated-left-and-deobfuscated-right-CFG-150x150.png" alt="" width="700" height="411" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Obfuscated-left-and-deobfuscated-right-CFG-300x176.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Obfuscated-left-and-deobfuscated-right-CFG-768x451.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Obfuscated-left-and-deobfuscated-right-CFG-1024x601.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Obfuscated-left-and-deobfuscated-right-CFG.png 1120w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 2. Obfuscated (left) and deobfuscated (right) CFG</i></p></div>
<h3>Processing reachable functions</h3>
<p>SHA-1 of the sample: <span style="font-family: courier new, courier, monospace;">e0087a763929dee998deebbcfa707273380f05ca</span></p>
<p>The following code recognizes only obfuscated functions reachable from <strong>0x1002DC50</strong> and searches for candidates for merging variables. Successfully recognized and deobfuscated functions are starting at <strong>0x10098000</strong>.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb3557173520072861" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from stadeo.cff.cff_strategies import CFFStrategies
strat = CFFStrategies(32)
res = strat.process_merging(0x1002DC50,
                            0x10098000,
                            ip="10.1.40.164")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb3557173520072861-1">1</div><div class="crayon-num" data-line="crayon-6057fb3557173520072861-2">2</div><div class="crayon-num" data-line="crayon-6057fb3557173520072861-3">3</div><div class="crayon-num" data-line="crayon-6057fb3557173520072861-4">4</div><div class="crayon-num" data-line="crayon-6057fb3557173520072861-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb3557173520072861-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">stadeo</span><span class="crayon-sy">.</span><span class="crayon-v">cff</span><span class="crayon-sy">.</span><span class="crayon-e">cff_strategies </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">CFFStrategies</span></div><div class="crayon-line" id="crayon-6057fb3557173520072861-2"><span class="crayon-v">strat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CFFStrategies</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb3557173520072861-3"><span class="crayon-v">res</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">strat</span><span class="crayon-sy">.</span><span class="crayon-e">process_merging</span><span class="crayon-sy">(</span><span class="crayon-cn">0x1002DC50</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb3557173520072861-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0x10098000</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb3557173520072861-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ip</span><span class="crayon-o">=</span><span class="crayon-s">"10.1.40.164"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><strong>Partial output:</strong></p>
<p><span style="font-family: courier new, courier, monospace;">skipping 0x1002dc50 with val None: 0xbadf00d</span><br />
<span style="font-family: courier new, courier, monospace;">mapping: 0x1001ffc0 -&gt; 0x10098000 with val @32[ESP_init + 0x8]: 0x6cef</span><br />
<span style="font-family: courier new, courier, monospace;">skipping 0x100010f0 with val None: 0xbadf00d</span><br />
<span style="font-family: courier new, courier, monospace;">mapping: 0x1000f0c0 -&gt; 0x100982b7 with val @32[ESP_init + 0x8]: 0x2012</span><br />
<span style="font-family: courier new, courier, monospace;">mapping: 0x1003f410 -&gt; 0x10098c8a with val @32[ESP_init + 0x4]: 0x21a4</span><br />
<span style="font-family: courier new, courier, monospace;">mapping: 0x1003f410 -&gt; 0x10098f3d with val @32[ESP_init + 0x4]: 0x772a</span><br />
<span style="font-family: courier new, courier, monospace;">skipping 0x1004ee79 (library func)</span><br />
<span style="font-family: courier new, courier, monospace;">&#8230;</span></p>
<p>Mapped functions were deobfuscated properly and skipped ones weren’t considered to be obfuscated. The format of the <strong>mapping</strong> lines in the output is:</p>
<p><span style="font-family: courier new, courier, monospace;">mapping: %obfuscated_function_address% -&gt; %deobfuscated_function_address% with val %merging_variable%: % merging_variable_value%</span></p>
<p>The default value for <span style="font-family: courier new, courier, monospace;">merging_variable_value</span> is <span style="font-family: courier new, courier, monospace;">0x0BADF00D</span>. The <strong>skipping</strong> lines follow the same pattern, but there’s no <span style="font-family: courier new, courier, monospace;">deobfuscated_function_address</span>. Library functions recognized by IDA are just skipped without further processing.</p>
<h3>Processing all functions</h3>
<p>SHA-1 of the sample: <span style="font-family: courier new, courier, monospace;">e575f01d3df0b38fc9dc7549e6e762936b9cc3c3</span></p>
<p>We use the following code only to deal with CFF featured in Emotet, whose CFF implementation fits into the description of common control-flow flattening <a href="https://www.welivesecurity.com/2020/03/19/stantinko-new-cryptominer-unique-obfuscation-techniques/" target="_blank" rel="noopener">here</a>.</p>
<p>We prefer this approach because the method <span style="font-family: courier new, courier, monospace;">CFFStrategies.process_all()</span> does not attempt to recognize merging variables that are not present in Emotet and searches only for one CFF loop per function; hence it is more efficient.</p>
<p>Successfully recognized and deobfuscated functions are sequentially written from <strong>0x0040B000</strong>. Format of the output is the same as in the <span style="font-family: courier new, courier, monospace;"><strong>process_merging</strong></span> method used in the <em>Processing reachable functions</em> example, but naturally there won’t be any merging variables.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb3557175008164309" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from stadeo.cff.cff_strategies import CFFStrategies
strat = CFFStrategies(32)
res = strat.process_all(0x0040b000,
                        ip="10.1.40.164")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb3557175008164309-1">1</div><div class="crayon-num" data-line="crayon-6057fb3557175008164309-2">2</div><div class="crayon-num" data-line="crayon-6057fb3557175008164309-3">3</div><div class="crayon-num" data-line="crayon-6057fb3557175008164309-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb3557175008164309-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">stadeo</span><span class="crayon-sy">.</span><span class="crayon-v">cff</span><span class="crayon-sy">.</span><span class="crayon-e">cff_strategies </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">CFFStrategies</span></div><div class="crayon-line" id="crayon-6057fb3557175008164309-2"><span class="crayon-v">strat</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">CFFStrategies</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb3557175008164309-3"><span class="crayon-v">res</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">strat</span><span class="crayon-sy">.</span><span class="crayon-e">process_all</span><span class="crayon-sy">(</span><span class="crayon-cn">0x0040b000</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb3557175008164309-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ip</span><span class="crayon-o">=</span><span class="crayon-s">"10.1.40.164"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><strong>Partial output:</strong></p>
<p><span style="font-family: courier new, courier, monospace;">mapping: 0x00401020 -&gt; 0x0040b000 with val None: 0xbadf00d</span><br />
<span style="font-family: courier new, courier, monospace;">skipping 0x00401670 with val None: 0xbadf00d</span><br />
<span style="font-family: courier new, courier, monospace;">mapping: 0x00401730 -&gt; 0x0040b656 with val None: 0xbadf00d</span><br />
<span style="font-family: courier new, courier, monospace;">&#8230;</span></p>
<div id="attachment_141693" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-obfuscated-left-and-deobfuscated-right-function-in-Emotet.png"><img class="wp-image-141693" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-obfuscated-left-and-deobfuscated-right-function-in-Emotet-150x150.png" alt="" width="700" height="508" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-obfuscated-left-and-deobfuscated-right-function-in-Emotet-300x218.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-obfuscated-left-and-deobfuscated-right-function-in-Emotet-768x557.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-obfuscated-left-and-deobfuscated-right-function-in-Emotet-1024x743.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-obfuscated-left-and-deobfuscated-right-function-in-Emotet.png 1173w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 3. Example of obfuscated (left) and deobfuscated (right) function in Emotet</i></p></div>
<h3>Redirecting references to deobfuscated functions</h3>
<p>Stadeo doesn&#8217;t automatically update references to functions after their deobfuscation. In the example below, we demonstrate how to patch a function call in Figure 1 from the <em>Deobfuscating a single function</em> example. The patched reference is shown in Figure 4.</p>
<p>We use the following code to patch calls, whose fourth parameter is <strong>0x567C</strong>, to the obfuscated function at <strong>0x1800158B0</strong> with the deobfuscated one at <strong>0x18008D000</strong>. Note that one has to make sure that IDA has recognized parameters of the function correctly and possibly <a href="https://www.hex-rays.com/products/ida/support/idadoc/1361.shtml" target="_blank" rel="noopener">fix </a>them.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb3557178588411267" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from stadeo.utils.xref_patcher import patch_xrefs
patch_xrefs(0x1800158B0,
            0x18008D000,
            {3: 0x567c},
            ip='10.1.40.164')</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb3557178588411267-1">1</div><div class="crayon-num" data-line="crayon-6057fb3557178588411267-2">2</div><div class="crayon-num" data-line="crayon-6057fb3557178588411267-3">3</div><div class="crayon-num" data-line="crayon-6057fb3557178588411267-4">4</div><div class="crayon-num" data-line="crayon-6057fb3557178588411267-5">5</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb3557178588411267-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">stadeo</span><span class="crayon-sy">.</span><span class="crayon-v">utils</span><span class="crayon-sy">.</span><span class="crayon-e">xref_patcher </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">patch_xrefs</span></div><div class="crayon-line" id="crayon-6057fb3557178588411267-2"><span class="crayon-e">patch_xrefs</span><span class="crayon-sy">(</span><span class="crayon-cn">0x1800158B0</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb3557178588411267-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-cn">0x18008D000</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb3557178588411267-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-sy">{</span><span class="crayon-cn">3</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">0x567c</span><span class="crayon-sy">}</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb3557178588411267-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">ip</span><span class="crayon-o">=</span><span class="crayon-s">'10.1.40.164'</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><div id="attachment_141694" style="width: 620px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-Patched-reference.png"><img class="wp-image-141694 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-Patched-reference.png" alt="" width="610" height="414" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-Patched-reference.png 610w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-Patched-reference-300x204.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-Patched-reference-151x103.png 151w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-Patched-reference-114x76.png 114w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-Patched-reference-97x65.png 97w" sizes="(max-width: 610px) 100vw, 610px" /></a><p class="wp-caption-text"><i>Figure 4. Patched reference</i></p></div></p>
<h3>Revealing obfuscated strings in a function</h3>
<p>The function <span style="font-family: courier new, courier, monospace;">StringRevealer.process_funcs()</span> reveals obfuscated strings in the specified function and returns a map of deobfuscated strings and their addresses.</p>
<p>Note that control flow of the target function has to have been deobfuscated already.</p>
<p>In the example below, we deobfuscate the strings of the function at <strong>0x100982B7</strong>, shown in Figure 5. The function itself was deobfuscated in the previous <em>Processing reachable functions</em> example.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb355717a774593643" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
from stadeo.string.string_revealer import StringRevealer
sr = StringRevealer(32)
strings = sr.process_funcs([0x100982B7],
                           ip="10.1.40.164")</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb355717a774593643-1">1</div><div class="crayon-num" data-line="crayon-6057fb355717a774593643-2">2</div><div class="crayon-num" data-line="crayon-6057fb355717a774593643-3">3</div><div class="crayon-num" data-line="crayon-6057fb355717a774593643-4">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb355717a774593643-1"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">stadeo</span><span class="crayon-sy">.</span><span class="crayon-k ">string</span><span class="crayon-sy">.</span><span class="crayon-e">string_revealer </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">StringRevealer</span></div><div class="crayon-line" id="crayon-6057fb355717a774593643-2"><span class="crayon-v">sr</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">StringRevealer</span><span class="crayon-sy">(</span><span class="crayon-cn">32</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb355717a774593643-3"><span class="crayon-v">strings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">sr</span><span class="crayon-sy">.</span><span class="crayon-e">process_funcs</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-cn">0x100982B7</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb355717a774593643-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-v">ip</span><span class="crayon-o">=</span><span class="crayon-s">"10.1.40.164"</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><div id="attachment_141695" style="width: 620px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5.-Part-of-the-function-at-0x100982B7-which-clearly-assembles-a-string.png"><img class="wp-image-141695" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5.-Part-of-the-function-at-0x100982B7-which-clearly-assembles-a-string-150x150.png" alt="" width="610" height="576" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5.-Part-of-the-function-at-0x100982B7-which-clearly-assembles-a-string-300x283.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5.-Part-of-the-function-at-0x100982B7-which-clearly-assembles-a-string.png 691w" sizes="(max-width: 610px) 100vw, 610px" /></a><p class="wp-caption-text"><i>Figure 5. Part of the function at 0x100982B7 which clearly assembles a string</i></p></div></p>
<p>Content of the strings variable after the execution is:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb355717b035108698" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{0x100982B7: {'SeLockMemoryPrivilege'}}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb355717b035108698-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb355717b035108698-1"><span class="crayon-sy">{</span><span class="crayon-cn">0x100982B7</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">'SeLockMemoryPrivilege'</span><span class="crayon-sy">}</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p>&nbsp;</p>
<p>We hope that you find the Stadeo tools and this explanation of their use helpful. If you have any enquiries reach out to us at threatintel[at]eset.com or open an issue on <a href="https://github.com/eset/stadeo" target="_blank" rel="noopener">https://github.com/eset/stadeo</a>.</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/vhrcka/" title="Vladislav Hrčka">
                    Vladislav Hrčka                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-08-07 14:00:43">7 Aug 2020 - 02:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Stadeo: Deobfuscating Stantinko and more">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Stadeo: Deobfuscating Stantinko and more">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Stadeo: Deobfuscating Stantinko and more">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Stadeo: Deobfuscating Stantinko and more">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F07%2Fstadeo-deobfuscating-stantinko-and-more%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F07%2Fstadeo-deobfuscating-stantinko-and-more%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F07%2Fstadeo-deobfuscating-stantinko-and-more%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"141686 https:\/\/backend.welivesecurity.com\/?p=141686","disqusShortname":"welivesecurity","disqusTitle":"Stadeo: Deobfuscating Stantinko and more","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/08\/07\/stadeo-deobfuscating-stantinko-and-more\/","postId":"141686"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>