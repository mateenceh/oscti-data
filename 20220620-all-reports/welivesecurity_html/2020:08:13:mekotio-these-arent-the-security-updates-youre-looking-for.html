<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Mekotio: These aren’t the security updates you’re looking for… | WeLiveSecurity</title>
<meta name="description" content="ESET researchers dissect Mekotio, a banking trojan that targets mainly Latin American countries and uses a SQL database as a C&amp;C server."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/08/13/mekotio-these-arent-the-security-updates-youre-looking-for/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Mekotio: These aren’t the security updates you’re looking for… | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers dissect Mekotio, a banking trojan that targets mainly Latin American countries and uses a SQL database as a C&amp;C server." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/08/13/mekotio-these-arent-the-security-updates-youre-looking-for/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-08-13T09:30:17+00:00" />
<meta property="article:modified_time" content="2020-08-14T19:01:35+00:00" />
<meta property="og:updated_time" content="2020-08-14T19:01:35+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/08/mekotio-banking-trojan-security-pdates.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/08/mekotio-banking-trojan-security-pdates.jpg" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="480" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers dissect Mekotio, a banking trojan that targets mainly Latin American countries and uses a SQL database as a C&amp;C server." />
<meta name="twitter:title" content="Mekotio: These aren’t the security updates you’re looking for… | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/08/mekotio-banking-trojan-security-pdates.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2020/08/14/mekotio-analise-desta-familia-de-malware-bancario-que-e-direcionada-ao-brasil/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2020/08/13/mekotio-cheval-de-troie-bancaire/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2020/08/13/mekotio-these-arent-the-security-updates-youre-looking-for/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/08/13/mekotio-analisis-familia-malware-bancario-latinoamerica/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/08/25/mekotio-nicht-die-sicherheitsupdates-die-sie-suchen/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2020/08/14/mekotio-analise-desta-familia-de-malware-bancario-que-e-direcionada-ao-brasil/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/08/13/mekotio-cheval-de-troie-bancaire/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/08/13/mekotio-analisis-familia-malware-bancario-latinoamerica/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/08/25/mekotio-nicht-die-sicherheitsupdates-die-sie-suchen/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2020/08/14/mekotio-analise-desta-familia-de-malware-bancario-que-e-direcionada-ao-brasil/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2020/08/13/mekotio-cheval-de-troie-bancaire/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/08/13/mekotio-analisis-familia-malware-bancario-latinoamerica/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/08/25/mekotio-nicht-die-sicherheitsupdates-die-sie-suchen/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/08/mekotio-banking-trojan.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Mekotio: These aren’t the security updates you’re looking for…</h1>
<div class="excerpt">Another in our occasional series demystifying Latin American banking trojans</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-08-13 11:30:17">13 Aug 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F13%2Fmekotio-these-arent-the-security-updates-youre-looking-for%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F13%2Fmekotio-these-arent-the-security-updates-youre-looking-for%2F&text=Mekotio: These aren’t the security updates you’re looking for…%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F13%2Fmekotio-these-arent-the-security-updates-youre-looking-for%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Another in our occasional series demystifying Latin American banking trojans</p>
                            </div>

                            <p>In this installment of our series, we introduce Mekotio, a Latin American banking trojan targeting mainly Brazil, Chile, Mexico, Spain, Peru and Portugal. The most notable feature of the newest variants of this malware family is using a SQL database as a C&amp;C server.</p>
<div id="attachment_141874" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Countries-affected-by-Mekotio.png"><img class="wp-image-141874" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Countries-affected-by-Mekotio-150x150.png" alt="" width="800" height="433" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Countries-affected-by-Mekotio-300x162.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Countries-affected-by-Mekotio-768x416.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Countries-affected-by-Mekotio-1024x554.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1.-Countries-affected-by-Mekotio.png 1497w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><i>Figure 1. Countries affected by Mekotio</i></p></div>
<p>As with many other Latin American banking trojans we have described earlier in this series, Mekotio has followed a rather chaotic development path, with its features being modified very often. Based on its internal versioning, we believe there are multiple variants being developed simultaneously. However, similar to <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">Casbaneiro</a>, these variants are practically impossible to separate from each other, so we will refer to them all as Mekotio.</p>
<h2>Characteristics</h2>
<p>Mekotio is a typical Latin American banking trojan that has been active since at least 2015. As such, it attacks by displaying fake pop-up windows to its victims, trying to entice them to divulge sensitive information. These windows are carefully designed to target Latin American banks and other financial institutions.</p>
<p>Mekotio collects the following information about its victims:</p>
<ul>
<li>Firewall configuration</li>
<li>Whether the victim has administrative privileges</li>
<li>Version of the installed Windows operating system</li>
<li>Whether anti-fraud protection products (GAS Tecnologia Warsaw and IBM Trusteer<sup><a href="#_ftn1" name="_ftnref1">[1]</a></sup>) are installed</li>
<li>List of installed antimalware solutions</li>
</ul>
<p>Mekotio ensures persistence either by using a Run key or creating an LNK file in the startup folder.</p>
<p>As is common for most Latin American banking trojans, Mekotio has several typical backdoor capabilities. It can take screenshots, manipulate windows, simulate mouse and keyboard actions, restart the machine, restrict access to various banking websites and update itself. Some variants are also able to steal bitcoins by replacing a bitcoin wallet in the clipboard and to exfiltrate credentials stored by the Google Chrome browser. Interestingly, one command is apparently intended to cripple the victim’s machine by trying to remove all files and folders in the <span style="font-family: courier new, courier, monospace;">C:\Windows <span style="font-family: georgia, palatino, serif;">tree</span></span><span style="font-family: georgia, palatino, serif;">.</span></p>
<p>One way to identify Mekotio is a specific message box the trojan displays on several occasions (see Figure 2).</p>
<div id="attachment_141947" style="width: 510px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Message-box-used-by-all-Mekotio-variants-1.png"><img class="wp-image-141947" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Message-box-used-by-all-Mekotio-variants-1.png" alt="" width="500" height="300" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Message-box-used-by-all-Mekotio-variants-1.png 676w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2.-Message-box-used-by-all-Mekotio-variants-1-300x180.png 300w" sizes="(max-width: 500px) 100vw, 500px" /></a><p class="wp-caption-text"><i>Figure 2. Message box used by all Mekotio variants <br /><small>(translation: “We are currently performing security updates on the site! Please, try again later! New security measures are being adopted: (1) new security plugin and (2) new visual look of the site. Your system will be restarted to complete the operation.”)</small></i></p></div>
<p>To ease stealing passwords with its keylogging feature, Mekotio disables the “AutoComplete” option in Internet Explorer. This feature, when enabled, saves time for Internet Explorer users by remembering inputs on various types of fields that have been filled in previously. Mekotio turns it off by changing the following Windows Registry values:</p>
<ul>
<li>HKCU\Software\Microsoft\windows\CurrentVersion\Explorer\AutoComplete\
<ul>
<li>AutoSuggest = “No”</li>
</ul>
</li>
<li>HKCU\Software\Microsoft\Internet Explorer\Main\
<ul>
<li>Use FormSuggest = “No”</li>
<li>FormSuggest Passwords = “No”</li>
<li>FormSuggest PW Ask = “No”</li>
</ul>
</li>
</ul>
<p>For an in-depth analysis of one specific variant of Mekotio targeting Chile, refer to <a href="https://www.welivesecurity.com/la-es/2020/07/14/mekotio-troyano-bancario-dirigido-principalmente-chile-tambien-busca-criptomonedas/" target="_blank" rel="noopener">ESET’s recently published article</a> (in Spanish).</p>
<h1>Distribution</h1>
<p>We believe the main distribution method for Mekotio is spam (see Figure 3 for an example). Since 2018, we have observed 38 different distribution chains used by this family. Most of these chains consist of several stages and end up downloading a ZIP archive, as is typical for Latin American banking trojans. We dissect the two most commonly used chains in the following sections.</p>
<div id="attachment_141876" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-a-spam-email-distributing-Mekotio.png"><img class="wp-image-141876" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-a-spam-email-distributing-Mekotio-150x150.png" alt="" width="800" height="341" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-a-spam-email-distributing-Mekotio-300x128.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-a-spam-email-distributing-Mekotio-768x328.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-a-spam-email-distributing-Mekotio-1024x437.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3.-Example-of-a-spam-email-distributing-Mekotio.png 1167w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><i>Figure 3. Example of a spam email distributing Mekotio <br /><small>(Translation: “Dear citizen, Your requested receipt: … Download receipt”)</small></i></p></div>
<h3>Chain 1: Passing context</h3>
<p>The first chain consists of four consecutive stages, as illustrated in Figure 4. A simple BAT dropper drops a VBScript downloader and executes it using two command line parameters – a custom HTTP verb<a href="#_ftn2" name="_ftnref2"><sup>[2]</sup></a> (“111SA”), and a URL from which to download the next stage. The downloader downloads the next stage (yet another downloader) from the provided URL while using a custom User-Agent value (“MyCustomUser” and its variations). The third stage downloads a PowerShell script, correcting the URL from which to download Mekotio inside the script’s body, before executing it. The PowerShell script then downloads Mekotio from the corrected URL and installs and executes it (the execution process is described in detail later).</p>
<div id="attachment_141877" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-One-distribution-chain-used-by-Mekotio-that-passes-context-between-stages.png"><img class="wp-image-141877" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-One-distribution-chain-used-by-Mekotio-that-passes-context-between-stages-150x150.png" alt="" width="800" height="336" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-One-distribution-chain-used-by-Mekotio-that-passes-context-between-stages-300x126.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-One-distribution-chain-used-by-Mekotio-that-passes-context-between-stages-768x322.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-One-distribution-chain-used-by-Mekotio-that-passes-context-between-stages-1024x430.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4.-One-distribution-chain-used-by-Mekotio-that-passes-context-between-stages.png 1373w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><i>Figure 4. One distribution chain used by Mekotio that passes context between stages</i></p></div>
<p>There are two interesting things about this chain. The first one is the usage of custom values for both User-Agent header and HTTP verb. These can be used to identify some of Mekotio’s network activity.</p>
<p>The other interesting aspect is the passing of context (either as command line arguments or by modifying the body of the next stage). This is a simple, yet effective, form of anti-analysis technique, because if you have Downloader 1 without the matching Dropper, you will have neither the URL nor the custom HTTP verb needed to obtain the next stage of the malware. Likewise, having Downloader 3 without Downloader 2 is useless, because the URL is missing. This approach makes analysis harder without the knowledge of context.</p>
<h3>Chain 2: MSI with embedded JavaScript</h3>
<p>As with many other Latin American banking trojans: Mekotio utilizes MSI in some of its latest distribution chains. In this case, the chain is much shorter and less robust, as only a single JavaScript, serving as the final stage, is embedded in the MSI and executed.</p>
<p>Compared to the PowerShell final stage from the previous chain, there are some visible similarities. The main one (shown in Figure 5) is the installation routine, called after downloading and extracting the ZIP archive, that renames the contents of the extracted ZIP archive according to file size. That is closely connected to the execution method described in the next section.</p>
<div id="attachment_141878" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5.-Comparison-of-installation-routine-in-JavaScript-and-PowerShell-scripts-used-by-Mekotio-highlighting-the-similarity-in-basing-the-decision-on-file-size.png"><img class="wp-image-141878" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5.-Comparison-of-installation-routine-in-JavaScript-and-PowerShell-scripts-used-by-Mekotio-highlighting-the-similarity-in-basing-the-decision-on-file-size-150x150.png" alt="" width="800" height="256" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5.-Comparison-of-installation-routine-in-JavaScript-and-PowerShell-scripts-used-by-Mekotio-highlighting-the-similarity-in-basing-the-decision-on-file-size-300x96.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5.-Comparison-of-installation-routine-in-JavaScript-and-PowerShell-scripts-used-by-Mekotio-highlighting-the-similarity-in-basing-the-decision-on-file-size-768x245.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5.-Comparison-of-installation-routine-in-JavaScript-and-PowerShell-scripts-used-by-Mekotio-highlighting-the-similarity-in-basing-the-decision-on-file-size-1024x327.png 1024w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><i>Figure 5. Comparison of installation routine in JavaScript and PowerShell scripts used by Mekotio, highlighting the similarity in basing the decision on file size</i></p></div>
<h3>Execution by abusing AutoIt interpreter</h3>
<p>Mekotio is most commonly executed by abusing the legitimate AutoIt interpreter. In this scenario, the ZIP archive contains (besides the Mekotio banking trojan) a legitimate AutoIt interpreter and a small AutoIt loader or injector script. The final stage of the distribution chain executes the AutoIt interpreter and passes the loader or injector script to it to interpret. That script then executes the banking trojan. Figure 6 illustrates the whole process.</p>
<div id="attachment_141879" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-6.-The-execution-method-most-commonly-used-by-Mekotio.png"><img class="wp-image-141879" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-6.-The-execution-method-most-commonly-used-by-Mekotio-150x150.png" alt="" width="800" height="211" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-6.-The-execution-method-most-commonly-used-by-Mekotio-300x79.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-6.-The-execution-method-most-commonly-used-by-Mekotio-768x203.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-6.-The-execution-method-most-commonly-used-by-Mekotio-1024x270.png 1024w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><i>Figure 6. The execution method most commonly used by Mekotio</i></p></div>
<p>Mekotio is not the only Latin American banking trojan using this method, but it favors it significantly more than its competitors.</p>
<h2>Cryptography</h2>
<p>The algorithm used to encrypt strings in Mekotio’s binaries is essentially the same one Casbaneiro uses. However, many variants of Mekotio modify how the data are processed before being decrypted. The first few bytes of the hardcoded decryption key may be ignored, as may some bytes of the encrypted string. Some variants further encode encrypted strings with base64. The specifics of these methods vary.</p>
<h2>C&amp;C server communication</h2>
<h3>SQL database as C&amp;C server</h3>
<p>Some variants of Mekotio base their network protocol on <a href="https://github.com/Maickonn/Delphi_Remote_Access_PC" target="_blank" rel="noopener">Delphi_Remote_Access_PC</a>, as does Casbaneiro. When that is not the case, Mekotio utilizes a SQL database as a sort of C&amp;C server. This technique is <a href="https://securityintelligence.com/new-banking-trojan-mnubot-discovered-by-ibm-x-force-research/" target="_blank" rel="noopener">not unheard of</a> in relation to Latin American banking trojans. Instead of a SELECT command, Mekotio seems to rely on executing SQL procedures. That way, it is not immediately clear what the underlying database looks like. However, the login string is still hardcoded in the binary.</p>
<h3>C&amp;C server address generation</h3>
<p>We have observed three different algorithms for how Mekotio obtains the address of its C&amp;C server. We describe them below in the chronological order that we encountered them.</p>
<p><strong>Based on hardcoded lists of “fake domains”</strong></p>
<p>The first method relies on two hardcoded lists of domains – one for generating the C&amp;C domain and the other one for the port. A random domain is chosen from both lists and resolved. The IP address is further modified. When generating the C&amp;C domain, a hardcoded number is subtracted from the last octet of the resolved IP address. When generating the C&amp;C port, the octets are joined together and treated like a number. For clarity, we have implemented both algorithms in Python, as seen in Figure 7. Notice that this approach is surprisingly similar to the one used by <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">Casbaneiro</a> (marked as method 5 in the hyperlinked analysis).</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb31ccb47468791248" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def generate_domain(base_domains, num):
	domain = to_ip(random.choice(base_domains))
	octets = domain.split(".")
	octets[3] = chr(int(octets[3]) - num)
	return octets.join(".")

def generate_port(base_domains):
	domain = to_ip(random.choice(base_domains))
	return int(domain.split(".").join(""))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb31ccb47468791248-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb47468791248-2">2</div><div class="crayon-num" data-line="crayon-6057fb31ccb47468791248-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb47468791248-4">4</div><div class="crayon-num" data-line="crayon-6057fb31ccb47468791248-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb47468791248-6">6</div><div class="crayon-num" data-line="crayon-6057fb31ccb47468791248-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb47468791248-8">8</div><div class="crayon-num" data-line="crayon-6057fb31ccb47468791248-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb31ccb47468791248-1"><span class="crayon-e">def </span><span class="crayon-e">generate_domain</span><span class="crayon-sy">(</span><span class="crayon-v">base_domains</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb47468791248-2"><span class="crayon-h">	</span><span class="crayon-v">domain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_ip</span><span class="crayon-sy">(</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">choice</span><span class="crayon-sy">(</span><span class="crayon-v">base_domains</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb31ccb47468791248-3"><span class="crayon-h">	</span><span class="crayon-v">octets</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">domain</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb47468791248-4"><span class="crayon-h">	</span><span class="crayon-v">octets</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">octets</span><span class="crayon-sy">[</span><span class="crayon-cn">3</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-v">num</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb31ccb47468791248-5"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">octets</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb47468791248-6">&nbsp;</div><div class="crayon-line" id="crayon-6057fb31ccb47468791248-7"><span class="crayon-e">def </span><span class="crayon-e">generate_port</span><span class="crayon-sy">(</span><span class="crayon-v">base_domains</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb47468791248-8"><span class="crayon-h">	</span><span class="crayon-v">domain</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">to_ip</span><span class="crayon-sy">(</span><span class="crayon-v">random</span><span class="crayon-sy">.</span><span class="crayon-e">choice</span><span class="crayon-sy">(</span><span class="crayon-v">base_domains</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb31ccb47468791248-9"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-sy">(</span><span class="crayon-v">domain</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-s">"."</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-s">""</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><em>Figure 7. Code for generating C&amp;C domain and port from hardcoded lists of domains</em></p>
<h4><strong>Based on current hour</strong></h4>
<p>The second approach utilizes a Domain Generation Algorithm (DGA) based on current local time (therefore, victim’s time zone affects the result). The algorithm takes the current day of the week, day of the month and hour and uses them to generate a single string. It then calculates the MD5 of that string, represented as a hexadecimal string. The result joined with a hardcoded suffix is the C&amp;C server domain (its port is hardcoded in the binary). Figure 8 shows our Python implementation of this algorithm.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb31ccb56521288686" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
day_names = {
	0: "MON",
	1: "TUE",
	2: "WED",
	3: "THU",
	4: "FRI",
	5: "SAT",
	6: "SUN",
}

hour_names = {
	7: "AM02",
	8: "AM03",
	9: "AM04",
	10: "AM05",
	11: "AM06",
	12: "PM01",
	13: "PM02",
	14: "PM03",
	15: "PM04",
	16: "PM05",
	17: "PM06"
}

def get_hour_name(hour):
	if hour &lt;= 6 or hour &gt;= 18:
		return "AM01"
	else
		return hour_names[hour]

def generate_domain(suffix):
	time = get_current_time()
	dga_data = "%s%02d%s" % (day_names[time.dayOfWeek], time.day, hour_names[time.hour])
	dga_data = hexlify(md5(dga_data))
	return dga_data.lower() + suffix</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-2">2</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-4">4</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-6">6</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-8">8</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-10">10</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-12">12</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-14">14</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-16">16</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-18">18</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-20">20</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-22">22</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-24">24</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-26">26</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-28">28</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-30">30</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-32">32</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb56521288686-34">34</div><div class="crayon-num" data-line="crayon-6057fb31ccb56521288686-35">35</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb31ccb56521288686-1"><span class="crayon-v">day_names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-2"><span class="crayon-h">	</span><span class="crayon-cn">0</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"MON"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-3"><span class="crayon-h">	</span><span class="crayon-cn">1</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"TUE"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-4"><span class="crayon-h">	</span><span class="crayon-cn">2</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"WED"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-5"><span class="crayon-h">	</span><span class="crayon-cn">3</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"THU"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-6"><span class="crayon-h">	</span><span class="crayon-cn">4</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"FRI"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-7"><span class="crayon-h">	</span><span class="crayon-cn">5</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"SAT"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-8"><span class="crayon-h">	</span><span class="crayon-cn">6</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"SUN"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-9"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-10">&nbsp;</div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-11"><span class="crayon-v">hour_names</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-12"><span class="crayon-h">	</span><span class="crayon-cn">7</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"AM02"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-13"><span class="crayon-h">	</span><span class="crayon-cn">8</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"AM03"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-14"><span class="crayon-h">	</span><span class="crayon-cn">9</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"AM04"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-15"><span class="crayon-h">	</span><span class="crayon-cn">10</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"AM05"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-16"><span class="crayon-h">	</span><span class="crayon-cn">11</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"AM06"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-17"><span class="crayon-h">	</span><span class="crayon-cn">12</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"PM01"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-18"><span class="crayon-h">	</span><span class="crayon-cn">13</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"PM02"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-19"><span class="crayon-h">	</span><span class="crayon-cn">14</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"PM03"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-20"><span class="crayon-h">	</span><span class="crayon-cn">15</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"PM04"</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-21"><span class="crayon-h">	</span><span class="crayon-cn">16</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"PM05"</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-22"><span class="crayon-h">	</span><span class="crayon-cn">17</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"PM06"</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-23"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-24">&nbsp;</div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-25"><span class="crayon-e">def </span><span class="crayon-e">get_hour_name</span><span class="crayon-sy">(</span><span class="crayon-v">hour</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-26"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">hour</span><span class="crayon-h"> </span><span class="crayon-o">&lt;=</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">hour</span><span class="crayon-h"> </span><span class="crayon-o">&gt;=</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-27"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-s">"AM01"</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-28"><span class="crayon-h">	</span><span class="crayon-st">else</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-29"><span class="crayon-h">		</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">hour_names</span><span class="crayon-sy">[</span><span class="crayon-v">hour</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-30">&nbsp;</div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-31"><span class="crayon-e">def </span><span class="crayon-e">generate_domain</span><span class="crayon-sy">(</span><span class="crayon-v">suffix</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-32"><span class="crayon-h">	</span><span class="crayon-v">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_current_time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-33"><span class="crayon-h">	</span><span class="crayon-v">dga_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"%s%02d%s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">day_names</span><span class="crayon-sy">[</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-v">dayOfWeek</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-v">day</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">hour_names</span><span class="crayon-sy">[</span><span class="crayon-v">time</span><span class="crayon-sy">.</span><span class="crayon-v">hour</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb56521288686-34"><span class="crayon-h">	</span><span class="crayon-v">dga_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hexlify</span><span class="crayon-sy">(</span><span class="crayon-e">md5</span><span class="crayon-sy">(</span><span class="crayon-v">dga_data</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb31ccb56521288686-35"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dga_data</span><span class="crayon-sy">.</span><span class="crayon-e">lower</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">suffix</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0009 seconds] -->
<p><em>Figure 8. Code for generating C&amp;C domain based on current hour</em></p>
<h4><strong>Based on current day</strong></h4>
<p>The third algorithm is somewhat similar to the second one. It differs in the format of the string created from local time and the fact that it uses a different suffix each day. Additionally, it generates the C&amp;C port in a similar manner. Once again, the Python re-implementation of the code is illustrated in Figure 9.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb31ccb58898388112" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def generate_domain(domains_list, subdomain):
	time = get_current_time()
	dga_data = "%02d%02d%s" % (time.day, time.month, subdomain)
	dga_data = hexlify(md5(dga_data))
	return dga_data[:20] + "." + domains_list[time.day - 1]

def generate_port(portstring):
	time = get_current_time()
	return int("%d%02d%d" % (time.day, time.dayOfWeek, time.month))</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb31ccb58898388112-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb58898388112-2">2</div><div class="crayon-num" data-line="crayon-6057fb31ccb58898388112-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb58898388112-4">4</div><div class="crayon-num" data-line="crayon-6057fb31ccb58898388112-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb58898388112-6">6</div><div class="crayon-num" data-line="crayon-6057fb31ccb58898388112-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6057fb31ccb58898388112-8">8</div><div class="crayon-num" data-line="crayon-6057fb31ccb58898388112-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb31ccb58898388112-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">generate_domain</span><span class="crayon-sy">(</span><span class="crayon-v">domains_list</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subdomain</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb58898388112-2"><span class="crayon-h">	</span><span class="crayon-k ">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_current_time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb31ccb58898388112-3"><span class="crayon-h">	</span><span class="crayon-v">dga_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"%02d%02d%s"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-v">day</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-v">month</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">subdomain</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb58898388112-4"><span class="crayon-h">	</span><span class="crayon-v">dga_data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">hexlify</span><span class="crayon-sy">(</span><span class="crayon-k ">md5</span><span class="crayon-sy">(</span><span class="crayon-v">dga_data</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb31ccb58898388112-5"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">dga_data</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">20</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-s">"."</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">domains_list</span><span class="crayon-sy">[</span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-v">day</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb58898388112-6">&nbsp;</div><div class="crayon-line" id="crayon-6057fb31ccb58898388112-7"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">generate_port</span><span class="crayon-sy">(</span><span class="crayon-v">portstring</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-6057fb31ccb58898388112-8"><span class="crayon-h">	</span><span class="crayon-k ">time</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">get_current_time</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-6057fb31ccb58898388112-9"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-k ">int</span><span class="crayon-sy">(</span><span class="crayon-s">"%d%02d%d"</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-v">day</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-v">dayOfWeek</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-v">month</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p><em>Figure 9. Code for generating C&amp;C domain and port based on current day</em></p>
<h2>Multiple concurrent variants?</h2>
<p>We already mentioned that, similar to other Latin American banking trojans, Mekotio follows a rather chaotic development cycle. However, besides that, there are indicators that there are multiple variants of Mekotio being developed simultaneously.</p>
<p>The two main indicators are internal versioning and the format of the string used for exfiltrating information about the victim’s machine collected by Mekotio. We have identified four different versioning schemes:</p>
<ul>
<li>Numbering (001, 002, 072, 39A, …)</li>
<li>Version by date (01-07, 15-06, 17-10, 20-09, …)</li>
<li>Version by full date (02_03_20, 13_03_20, 26_05_20, …)</li>
<li>Numbering and date combined (103&#8211;30-09, 279&#8211;07-05, 293&#8211;25-05, …)</li>
</ul>
<p>Each of these schemes is associated with a specific format of the exfiltrated data string. Since we see multiple of these schemes simultaneously, we believe that there may be multiple threat actors using different variants of Mekotio.</p>
<h2>Conclusion</h2>
<p>In this blog post, we have analyzed Mekotio, a Latin American banking trojan active since at least 2015. As in the other banking trojans described in this series, Mekotio shares common characteristics for this type of malware, such as being written in Delphi, using fake pop-up windows, containing backdoor functionality and targeting Spanish- and Portuguese-speaking countries.</p>
<p>We have focused on the most interesting features of this banking trojan, such as its primary method of execution by abusing the legitimate AutoIt interpreter, using SQL database as a C&amp;C server or the different methods Mekotio uses to generate the address of its C&amp;C server.</p>
<p>We have also mentioned several features that are surprisingly similar to Casbaneiro.</p>
<p><em>For any inquiries, contact us at threatintel@eset.com. Indicators of Compromise can also be found in <a href="https://github.com/eset/malware-ioc/tree/master/mekotio" target="_blank" rel="noopener">our GitHub repository</a>.</em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>Hashes</h3>
<h4>Mekotio samples</h4>

<table id="tablepress-863" class="tablepress tablepress-id-863">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">AEA1FD2062CD6E1C0430CA36967D359F922A2EC3</td><td class="column-2">Mekotio banking trojan (SQL variant)</td><td class="column-3">Win32/Spy.Mekotio.CQ</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">8CBD4BE36646E98C9D8C18DA954942620E515F32</td><td class="column-2">Mekotio banking trojan</td><td class="column-3">Win32/Spy.Mekotio.O</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">297C2EDE67AE6F4C27858DCB0E84C495A57A7677</td><td class="column-2">Mekotio banking trojan</td><td class="column-3">Win32/Spy.Mekotio.DD</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">511C7CFC2B942ED9FD7F99E309A81CEBD1228B50</td><td class="column-2">Mekotio banking trojan</td><td class="column-3">Win32/Spy.Mekotio.T</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">47C3C058B651A04CA7C0FF54F883A05E2A3D0B90</td><td class="column-2">Mekotio banking trojan</td><td class="column-3">Win32/Spy.Mekotio.CD</td>
</tr>
</tbody>
</table>

<h4>Legitimate AutoIt interpreter being abused</h4>

<table id="tablepress-864" class="tablepress tablepress-id-864">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">ACC07666F4C1D4461D3E1C263CF6A194A8DD1544</td><td class="column-2">AutoIt v3 Script interpreter</td><td class="column-3">clean</td>
</tr>
</tbody>
</table>

<h3>Network communication</h3>
<ul>
<li>User-Agent: “MyCustomUser”, “4M5yC6u4stom5U8se3r” (and other variations)</li>
<li>HTTP verb: “111SA”</li>
</ul>
<h3>Bitcoin wallets</h3>
<ul>
<li>1PkVmYNiT6mobnDgq8M6YLXWqFraW2jdAk</li>
<li>159cFxcSSpup2D4NSZiuBXgsGfgxWCHppv</li>
<li>1H35EiMsXDeDJif2fTC98i81n4JBVFfru6</li>
</ul>
<h2>MITRE ATT&amp;CK techniques</h2>
<p>Note: This table was built using <a href="https://attack.mitre.org/versions/" target="_blank" rel="noopener">version 7</a> of the MITRE ATT&amp;CK framework.</p>

<table id="tablepress-865" class="tablepress tablepress-id-865">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1566/002/" rel="noopener" target="_blank">T1566.002</a></td><td class="column-3">Phishing: Spearphishing Link</td><td class="column-4">Mekotio distribution chains start with a malicious link in an email.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="3" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1059/" rel="noopener" target="_blank">T1059</a></td><td class="column-3">Command and Scripting Interpreter</td><td class="column-4">Mekotio is most commonly executed by abusing the legitimate AutoIt interpreter. </td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1059/001/" rel="noopener" target="_blank">T1059.001</a></td><td class="column-3">Command and Scripting Interpreter: PowerShell</td><td class="column-4">Mekotio uses PowerShell to execute its distribution chain stages.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1059/005/" rel="noopener" target="_blank">T1059.005</a></td><td class="column-3">Command and Scripting Interpreter: Visual Basic</td><td class="column-4">Mekotio uses VBScript to execute its distribution chain stages.</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1547/001/" rel="noopener" target="_blank">T1547.001</a></td><td class="column-3">Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</td><td class="column-4">Mekotio ensures persistence by using a Run key or creating a LNK file in the startup folder.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1218/" rel="noopener" target="_blank">T1218</a></td><td class="column-3">Signed Binary Proxy Execution</td><td class="column-4">Mekotio is executed by running a legitimate AutoIt interpreter and passing a loader script for it to interpret.</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1555/003/" rel="noopener" target="_blank">T1555.003</a></td><td class="column-3">Credentials from Password Stores: Credentials from Web Browsers</td><td class="column-4">Mekotio steals credentials from the Google Chrome browser.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="4" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1010/" rel="noopener" target="_blank">T1010</a></td><td class="column-3">Application Window Discovery</td><td class="column-4">Mekotio discovers various security tools and banking applications based on window names.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Mekotio discovers banking protection software based on file system paths.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1518/001/" rel="noopener" target="_blank">T1518.001</a></td><td class="column-3">Software Discovery: Security Software Discovery</td><td class="column-4">Mekotio detects the presence of banking protection products. </td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Mekotio collects information about the victim's machine, such as firewall status and Windows version.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1056/001/" rel="noopener" target="_blank">T1056.001</a></td><td class="column-3">Input Capture: Keylogging</td><td class="column-4">Mekotio is capable of capturing keystrokes.</td>
</tr>
<tr class="row-14 even">
	<td rowspan="3" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1568/002/" rel="noopener" target="_blank">T1568.002</a></td><td class="column-3">Dynamic Resolution: Domain Generation Algorithms</td><td class="column-4">Mekotio generates its C&amp;C domain using a DGA.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1568/003/" rel="noopener" target="_blank">T1568.003</a></td><td class="column-3">Dynamic Resolution: DNS Calculation</td><td class="column-4">Mekotio uses an algorithm to modify the resolved IP address to obtain the actual C&amp;C address.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1095/" rel="noopener" target="_blank">T1095</a></td><td class="column-3">Non-Application Layer Protocol</td><td class="column-4">Mekotio’s network protocol in variants not using SQL is based on Remote_Delphi_Access_PC.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2 Channel</td><td class="column-4">Mekotio sends the data it retrieves to its C&amp;C server.</td>
</tr>
</tbody>
</table>

<p><small><em><a href="#_ftnref1" name="_ftn1">[1]</a> Anti-fraud solutions used very frequently in Latin America.</em><br />
<em><a href="#_ftnref2" name="_ftn2">[2]</a> Common HTTP verbs are GET and POST.</em><br />
</small></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-08-13 11:30:17">13 Aug 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Mekotio: These aren’t the security updates you’re looking for…">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Mekotio: These aren’t the security updates you’re looking for…">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Mekotio: These aren’t the security updates you’re looking for…">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Mekotio: These aren’t the security updates you’re looking for…">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F13%2Fmekotio-these-arent-the-security-updates-youre-looking-for%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F13%2Fmekotio-these-arent-the-security-updates-youre-looking-for%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F08%2F13%2Fmekotio-these-arent-the-security-updates-youre-looking-for%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"141736 https:\/\/backend.welivesecurity.com\/?p=141736","disqusShortname":"welivesecurity","disqusTitle":"Mekotio: These aren\u2019t the security updates you\u2019re looking for\u2026","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/08\/13\/mekotio-these-arent-the-security-updates-youre-looking-for\/","postId":"141736"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>