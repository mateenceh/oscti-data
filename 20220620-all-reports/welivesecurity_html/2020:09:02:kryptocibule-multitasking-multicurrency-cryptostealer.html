<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Matthieu Faou',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>KryptoCibule: The multitasking multicurrency cryptostealer | WeLiveSecurity</title>
<meta name="description" content="ESET researchers analyze a previously undocumented trojan that is distributed via malicious torrents and uses a range of tricks to squeeze cryptocoins from its victims."/>
<link rel="canonical" href="https://www.welivesecurity.com/2020/09/02/kryptocibule-multitasking-multicurrency-cryptostealer/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="KryptoCibule: The multitasking multicurrency cryptostealer | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers analyze a previously undocumented trojan that is distributed via malicious torrents and uses a range of tricks to squeeze cryptocoins from its victims." />
<meta property="og:url" content="https://www.welivesecurity.com/2020/09/02/kryptocibule-multitasking-multicurrency-cryptostealer/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2020-09-02T09:30:31+00:00" />
<meta property="article:modified_time" content="2020-09-04T19:36:56+00:00" />
<meta property="og:updated_time" content="2020-09-04T19:36:56+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/09/KryptoCibule-multitasking-multicurrency-cryptostealer.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2020/09/KryptoCibule-multitasking-multicurrency-cryptostealer.jpg" />
<meta property="og:image:width" content="640" />
<meta property="og:image:height" content="427" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers analyze a previously undocumented trojan that is distributed via malicious torrents and uses a range of tricks to squeeze cryptocoins from its victims." />
<meta name="twitter:title" content="KryptoCibule: The multitasking multicurrency cryptostealer | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2020/09/KryptoCibule-multitasking-multicurrency-cryptostealer.jpg" />
<meta name="twitter:creator" content="@matthieu_faou" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/2020/09/02/kryptocibule-multitasking-multicurrency-cryptostealer/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2020/09/03/kryptocibule-malware-mina-roba-criptomonedas-exfiltra-archivos/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2020/09/02/kryptocibule-der-multitasking-krypto-stealer/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/09/03/kryptocibule-malware-mina-roba-criptomonedas-exfiltra-archivos/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/09/02/kryptocibule-der-multitasking-krypto-stealer/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2020/09/03/kryptocibule-malware-mina-roba-criptomonedas-exfiltra-archivos/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2020/09/02/kryptocibule-der-multitasking-krypto-stealer/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2020/09/kryptocibule-cryptocurrency-mining-trojan.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>KryptoCibule: The multitasking multicurrency cryptostealer</h1>
<div class="excerpt">ESET researchers analyze a previously undocumented trojan that is spread via malicious torrents and uses multiple tricks to squeeze cryptocoins from its victims while staying under the radar</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/02/Matthieu-Faou-222x179.jpg" alt="Matthieu Faou">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/acotecyr/" title="Alexandre Côté Cyr">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="Alexandre Côté Cyr">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/acotecyr/" title="Alexandre Côté Cyr">
                    Alexandre Côté Cyr                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2020-09-02 11:30:31">2 Sep 2020 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F09%2F02%2Fkryptocibule-multitasking-multicurrency-cryptostealer%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F09%2F02%2Fkryptocibule-multitasking-multicurrency-cryptostealer%2F&text=KryptoCibule: The multitasking multicurrency cryptostealer%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F09%2F02%2Fkryptocibule-multitasking-multicurrency-cryptostealer%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers analyze a previously undocumented trojan that is spread via malicious torrents and uses multiple tricks to squeeze cryptocoins from its victims while staying under the radar</p>
                            </div>

                            <p>ESET researchers have uncovered a hitherto undocumented malware family that we named KryptoCibule. This malware is a triple threat in regard to cryptocurrencies. It uses the victim&#8217;s resources to mine coins, tries to hijack transactions by replacing wallet addresses in the clipboard, and exfiltrates cryptocurrency-related files, all while deploying multiple techniques to avoid detection. KryptoCibule makes extensive use of the Tor network and the BitTorrent protocol in its communication infrastructure.</p>
<p>The malware, written in C#, also employs some legitimate software. Some, such as Tor and the Transmission torrent client, are bundled with the installer; others are downloaded at runtime, including Apache httpd and the Buru SFTP server. An overview of the various components and their interactions is shown in Figure 1.</p>
<div id="attachment_142511" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1-1.png"><img class="wp-image-142511" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1-1-150x150.png" alt="" width="700" height="499" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1-1-300x214.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1-1-768x548.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-1-1.png 850w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 1. KryptoCibule components and tools</i></p></div>
<p>When the malware is first executed, the host is assigned a unique identifier with the format <span style="font-family: courier new, courier, monospace;">{adjective}-{noun}</span> where <span style="font-family: courier new, courier, monospace;">{adjective} <span style="font-family: georgia, palatino, serif;">and</span> {noun}</span> are random words taken from two hardcoded lists which provide over 10 million unique combinations. This identifier is then used to identify the host in communications with the C&amp;C servers.</p>
<p>On top of the crypto-related components, KryptoCibule also has RAT functionality. Among the commands it supports are <span style="font-family: courier new, courier, monospace;">EXEC</span>, which allows execution of arbitrary commands and <span style="font-family: courier new, courier, monospace;">SHELL</span>, which downloads a PowerShell script from the C&amp;C. This script then loads a backdoor generated with the post-exploitation tool <a href="https://github.com/n1nj4sec/pupy" target="_blank" rel="noopener">Pupy</a>.</p>
<p>The name KryptoCibule derives from the Czech and Slovak words for “crypto” and “onion”.</p>
<h2>Timeline</h2>
<p>We have uncovered multiple versions of this malware, enabling us to trace its evolution all the way back to December 2018. Figure 2 shows the changes made over time to KryptoCibule.</p>
<div id="attachment_142512" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2-1.png"><img class="wp-image-142512" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2-1-150x150.png" alt="" width="700" height="245" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2-1-300x105.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2-1-768x269.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2-1-1024x359.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-2-1.png 1036w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 2. Timeline of updates and functionality changes</i></p></div>
<h2>Targets</h2>
<p>According to ESET telemetry (shown in Figure 3), the malware seems to target mostly users in Czechia (the Czech Republic) and Slovakia. This reflects the user base of the site on which the infected torrents are found.</p>
<div id="attachment_142513" style="width: 460px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3-1.png"><img class="wp-image-142513" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3-1.png" alt="" width="450" height="430" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3-1.png 589w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-3-1-300x287.png 300w" sizes="(max-width: 450px) 100vw, 450px" /></a><p class="wp-caption-text"><i>Figure 3. In our telemetry data, over 85% of detections were located in Czechia and Slovakia</i></p></div>
<p>Almost all the malicious torrents were available on uloz.to; a <abbr title="At the time of this writing, this website and its localized variant (ulozto.cz and ulozto.sk respectively) are both in the Alexa top 50 most visited sites in Czechia and in the top 75 most visited sites for Slovakia">popular</abbr> file sharing site in Czechia and Slovakia (see Figure 4). We&#8217;ll explain how these torrents are used to spread KryptoCibule in the next section.</p>
<div id="attachment_142514" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4-1.png"><img class="wp-image-142514" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4-1-150x150.png" alt="" width="700" height="352" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4-1-300x151.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4-1-768x387.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-4-1.png 892w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 4. One of the malicious torrents on uloz.to</i></p></div>
<p>As detailed in the <em>Anti-detection and anti-analysis techniques</em> section below, KryptoCibule specifically checks for ESET, Avast, and AVG endpoint security products; ESET is headquartered in Slovakia, while the other two are owned by Avast, which is headquartered in Czechia.</p>
<h2>Torrents</h2>
<p>KryptoCibule makes use of the BitTorrent protocol to spread to new victims and to download additional tools and updates.</p>
<h3>Initial Compromise</h3>
<p>KryptoCibule is spread through malicious torrents for ZIP files whose contents masquerade as installers for cracked or pirated software and games. Although other files may be included, as seen in Figure 5, there are five that are common to all KryptoCibule installer archives. <span style="font-family: courier new, courier, monospace;">packed.001</span> is the malware, while<span style="font-family: courier new, courier, monospace;"> packed.002</span> is the installer for the expected software. Both are XOR-encrypted with keys contained in <span style="font-family: courier new, courier, monospace;">Setup.exe</span>.</p>
<p>When <span style="font-family: courier new, courier, monospace;">Setup.exe</span> is executed, it decodes both the malware and the expected installer files. It then launches the malware – in the background – and the expected installer – front and center – giving the victim no indication that anything is amiss.</p>
<div id="attachment_142515" style="width: 632px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5-1.png"><img class="wp-image-142515 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5-1.png" alt="" width="622" height="174" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5-1.png 622w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-5-1-300x84.png 300w" sizes="(max-width: 622px) 100vw, 622px" /></a><p class="wp-caption-text"><i>Figure 5. Content of the <span style="font-family: courier new, courier, monospace;">Dead.Cells.Incl.All.DLC</span> archive with only the minimum common set of KryptoCibule installer files shown</i></p></div>
<h3>Additional software and updates</h3>
<p>The BitTorrent protocol is also used to download updates to the malware, and additional software.</p>
<p>KryptoCibule installs the<span style="font-family: courier new, courier, monospace;"> transmission-daemon</span> torrent client and manages it by issuing commands via its RPC interface on port 9091 with transmission-remote. The RPC interface uses the hardcoded credentials <span style="font-family: courier new, courier, monospace;">superman:krypton</span>.</p>
<p>To install further software for the malware’s use, such as the SFTP server, the Launcher component makes an HTTP GET request to <span style="font-family: courier new, courier, monospace;">%C&amp;C%/softwareinfo?title=&lt;software name&gt;</span> and receives a JSON response containing a <abbr title="Magnet links are a type of URI that identify files by using a cryptographic hash of their contents rather than their location. These links may also include metadata about the file. They are commonly used in the BitTorrent protocol to identify files to be shared. See https://www.bittorrent.com/blog/2016/01/27/reshaping-the-internet-whats-a-magnet-link/">magnet URI</abbr> for the torrent to download and other information indicating how to install and execute the program. Figure 6 shows an example of such a response.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb147d98e944024627" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
{"Magnet": "magnet:?xt=urn[:]btih:67yd647nivxhumoedvwnwnzve55b3bxj&amp;dn=free-BuruServer-x64-v1.7.3.zip", "Version": 1,"ExecutableRelativePath": "", "ExecutableFileName": "buru.exe","ExecutableArgs": "run", "InstallFile": "", "HasCustomConfig": true}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb147d98e944024627-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb147d98e944024627-1"><span class="crayon-sy">{</span><span class="crayon-s">"Magnet"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"magnet:?xt=urn[:]btih:67yd647nivxhumoedvwnwnzve55b3bxj&amp;dn=free-BuruServer-x64-v1.7.3.zip"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"Version"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span><span class="crayon-s">"ExecutableRelativePath"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"ExecutableFileName"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"buru.exe"</span><span class="crayon-sy">,</span><span class="crayon-s">"ExecutableArgs"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">"run"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"InstallFile"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-s">""</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"HasCustomConfig"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-t">true</span><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p><small><em>Figure 6. Sample response for a <span style="font-family: courier new, courier, monospace;">GET /softwareinfo?title=ssh_server</span> request</em></small></p>
<p>The mechanism for getting updates is similar. The malware first gets global settings via HTTP from <span style="font-family: courier new, courier, monospace;">%C&amp;C%/settingsv5</span>. Among other things, this response contains a magnet URI for the latest version of the malware. It then makes a GET request to <span style="font-family: courier new, courier, monospace;">%C&amp;C%/version</span> to get the most recent version number. If the local version is lower than that version, the torrent is downloaded and installed.</p>
<p>Torrents are added to Transmission using the following command:</p>
<p><span style="font-family: courier new, courier, monospace;">transmission-remote localhost -n superman:krypton -a &#8220;&lt;magnet URI&gt;&#8221;</span></p>
<p>A hardcoded list of 50 <abbr title="In the BitTorrent protocol, a tracker is a server that helps clients find and coordinate with peers to transfer files. See https://en.wikipedia.org/wiki/BitTorrent_tracker ">trackers</abbr> is used to get peers for all torrents.</p>
<h3>Seeding malicious torrents</h3>
<p>Victims are also used to <abbr title="In the BitTorrent protocol, a seed is a peer that has a complete torrent and that lets others download that torrent’s files from it. See https://help.bittorrent.com/support/solutions/articles/29000023347-what-is-seeding- ">seed</abbr> both the torrents used by the malware and the malicious torrents that help spread it. Infected hosts get a list of magnet URIs from <span style="font-family: courier new, courier, monospace;">%C&amp;C%/magnets</span>, download them all and keep seeding them. This ensures that these files are widely available for others to download, which helps speed up the downloads and provides redundancy.</p>
<h2>Anti-detection and anti-analysis techniques</h2>
<p>This malware leverages a variety of techniques to avoid detection, along with some basic anti-analysis protections.</p>
<p>It starts with the initial access vector. The executable contained inside the ZIP archive is a rather benign installer program that masquerades as the legitimate InstallShield program. This file is scrambled with the open source program <a href="https://github.com/obfuscar/obfuscar" target="_blank" rel="noopener">Obfuscar</a>. This same tool is used on all of the malware&#8217;s custom executables. The malicious code itself is located inside an XOR-encrypted file, the key being a GUID hardcoded in <span style="font-family: courier new, courier, monospace;">Setup.exe</span>.</p>
<p>The malware is then installed to the hardcoded path <span style="font-family: courier new, courier, monospace;">%ProgramFiles(x86)%\Adobe\Acrobat Reader DC\Reader\update</span> and uses legitimate Adobe Acrobat Reader executable names for the bundled Tor executable and its own. Some of the files contained in the install folder can be seen in Figure 7.</p>
<div id="attachment_142516" style="width: 563px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-7.png"><img class="wp-image-142516 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-7.png" alt="" width="553" height="184" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-7.png 553w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-7-300x100.png 300w" sizes="(max-width: 553px) 100vw, 553px" /></a><p class="wp-caption-text"><i>Figure 7. Some of the files in the install folder. <span style="font-family: courier new, courier, monospace;">Armsvc.exe</span> is the malware and <span style="font-family: courier new, courier, monospace;">ADelRCP.exe</span> is the Tor executable. Both filenames are actually used by Adobe Reader.</i></p></div>
<p>To achieve persistence, KryptoCibule creates a scheduled task to be run every five minutes with the following command. Once again, it uses an Adobe Reader-related name.</p>
<p><span style="font-family: courier new, courier, monospace;">schtasks.exe /CREATE /SC MINUTE /MO 5 /TN &#8220;<strong>Adobe Update Task</strong>&#8221; /TR \&#8221;&#8221;%ProgramFiles(x86)%\Adobe\Acrobat Reader DC\Reader\Update\armsvc.exe\&#8221;&#8221; [/RL HIGHEST] /F [/RU SYSTEM]</span></p>
<p>Before first executing its payload and on every iteration of the main loop, the malware performs a check for running analysis software using the following list. If any process with a matching name is found, it stops all running components and exits.</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">cain</span></li>
<li><span style="font-family: courier new, courier, monospace;">filemon</span></li>
<li><span style="font-family: courier new, courier, monospace;">netmon</span></li>
<li><span style="font-family: courier new, courier, monospace;">netstat</span></li>
<li><span style="font-family: courier new, courier, monospace;">nmwifi</span></li>
<li><span style="font-family: courier new, courier, monospace;">perfmon</span></li>
<li><span style="font-family: courier new, courier, monospace;">processhacker</span></li>
<li><span style="font-family: courier new, courier, monospace;">procexp</span></li>
<li><span style="font-family: courier new, courier, monospace;">procexp64</span></li>
<li><span style="font-family: courier new, courier, monospace;">procmon</span></li>
<li><span style="font-family: courier new, courier, monospace;">regmon</span></li>
<li><span style="font-family: courier new, courier, monospace;">tasklist</span></li>
<li><span style="font-family: courier new, courier, monospace;">taskmgr</span></li>
<li><span style="font-family: courier new, courier, monospace;">tcpvcon</span></li>
<li><span style="font-family: courier new, courier, monospace;">tcpview</span></li>
<li><span style="font-family: courier new, courier, monospace;">wireshark</span></li>
</ul>
<h3>Antivirus evasion</h3>
<p>Before initializing the cryptominer components, the malware performs a case-insensitive check of the <span style="font-family: courier new, courier, monospace;">rootSecurityCenter2\AntiVirusProduct WMI</span> object for the strings <span style="font-family: courier new, courier, monospace;">avast</span>, <span style="font-family: courier new, courier, monospace;">avg</span> and <span style="font-family: courier new, courier, monospace;">eset</span>, as seen in the decompiled code in Figure 8. Should any of these strings be detected If any of them were detected, the cryptominer components will not be installed.</p>
<div id="attachment_142517" style="width: 631px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-8.png"><img class="wp-image-142517 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-8.png" alt="" width="621" height="308" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-8.png 621w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-8-300x149.png 300w" sizes="(max-width: 621px) 100vw, 621px" /></a><p class="wp-caption-text"><i>Figure 8. Cleaned up decompiled code of the function used to check for specific security products</i></p></div>
<p>Whenever the malware installs itself, an update or a new component, the install path used is excluded from Windows Defender automatic scanning by issuing the following command:</p>
<p><span style="font-family: courier new, courier, monospace;">powershell -c &#8220;Add-MpPreference -ExclusionPath &#8216;&lt;install path&gt;'&#8221;</span></p>
<p>It also creates firewall rules using innocuous-looking names to explicitly allow inbound and outbound traffic from its components.  A rule to block outbound traffic from the ESET Kernel Service (<span style="font-family: courier new, courier, monospace;">ekrn.exe</span>) is also created by the function shown in Figure 9.</p>
<div id="attachment_142518" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-9.png"><img class="wp-image-142518" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-9-150x107.png" alt="" width="700" height="94" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-9-300x40.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-9-768x103.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-9.png 794w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 9. Function that blocks outbound traffic from <span style="font-family: courier new, courier, monospace;">ekrn.exe</span> in the Windows Firewall</i></p></div>
<h3>Tor network usage</h3>
<p>KryptoCibule brings along the <span style="font-family: courier new, courier, monospace;">tor.exe</span> command line tool, masquerading as <span style="font-family: courier new, courier, monospace;">ADelRCP.exe</span>, and a configuration file (seen in Figure 10) as <span style="font-family: courier new, courier, monospace;">libstringutils.dll</span>.</p>
<div id="attachment_142519" style="width: 369px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-10.png"><img class="wp-image-142519 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-10.png" alt="" width="359" height="257" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-10.png 359w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-10-300x215.png 300w" sizes="(max-width: 359px) 100vw, 359px" /></a><p class="wp-caption-text"><i>Figure 10. The Tor configuration file used by the latest version of the malware</i></p></div>
<p>This sets up a SOCKS proxy on port 9050 that is used by the malware to relay all communications with the C&amp;C servers through the Tor network. This has the dual benefit of encrypting the communications and making it virtually impossible to trace the actual server or servers behind these URIs.</p>
<p>The second part of the configuration file sets up <abbr title="In Tor, onion services are a way of making a service running on a certain port only reachable via the Tor network.">onion services</abbr> on the victimized host. These are accessible by the operators over the Tor network. When first starting up these services, Tor automatically generates a <span style="font-family: courier new, courier, monospace;">.onion</span> URI for the host. This unique hostname is then sent to <span style="font-family: courier new, courier, monospace;">%C&amp;C%/transferhost/&lt;unique name&gt;</span>. We will discuss how these onion services are used in the upcoming sections.</p>

<table id="tablepress-866" class="tablepress tablepress-id-866">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Port Number</th><th class="column-2">Service</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">9091</td><td class="column-2">Transmission Daemon RPC interface</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">9999</td><td class="column-2">Apache httpd server</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">9187</td><td class="column-2">Buru SFTP server</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">9188</td><td class="column-2">Buru Web Admin</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">12461</td><td class="column-2">MiniWeb HTTP server</td>
</tr>
</tbody>
</table>

<p>The onion URIs for two C&amp;C servers are contained in the malware. One of these provides a REST API that the malware uses for most communications, while the other is used to download files. Additional URIs can be obtained one at a time with a request to <span style="font-family: courier new, courier, monospace;">%C&amp;C%/server</span>.  Some older versions of the malware use these to download updates via port 12461. We believe that these URIs point to other infected hosts. The versions of the malware that use them have code to place their downloaded updates into a directory served by the MiniWeb HTTP server on that same port.</p>
<p>We were able to identify one IP address for the file server C&amp;C in our telemetry data.</p>
<h2>Acquiring cryptocurrency</h2>
<p>KryptoCibule has three components that leverage infected hosts in order to obtain cryptocurrencies.</p>
<h3>Cryptomining</h3>
<p>The latest versions of KryptoCibule use <span style="font-family: courier new, courier, monospace;">XMRig</span>, an open source program that mines Monero using the CPU, and <span style="font-family: courier new, courier, monospace;">kawpowminer</span>, another open source program that mines Ethereum using the GPU. The second one is only used if a dedicated GPU is found on the host. Both of these programs are set up to connect to an operator-controlled mining server over the Tor proxy.</p>
<p>On every iteration of the main loop, the malware checks the battery level and the time since the last user input. It then starts or stops the miner processes based on this information. If the host has received no user input in the last 3 minutes and has at least 30% battery, both the GPU and CPU miners are run without limits. Otherwise, the GPU miner is suspended, and the CPU miner is limited to one thread. If the battery level is under 10%, both miners are stopped. This is done to reduce the likelihood of being noticed by the victim.</p>
<h3>Clipboard hijacking</h3>
<p>The second component masquerades as <span style="font-family: courier new, courier, monospace;">SystemArchitectureTranslation.exe</span>. It uses the <a href="https://docs.microsoft.com/en-us/windows/win32/api/winuser/nf-winuser-addclipboardformatlistener" target="_blank" rel="noopener">AddClipboardFormatListener function</a> to monitor changes to the clipboard and to apply the replacement rules obtained from <span style="font-family: courier new, courier, monospace;">%C&amp;C%/regexes</span> to its content. The code for this listener is shown in Figure 11. The value <span style="font-family: courier new, courier, monospace;">0x31D</span> corresponds to the <span style="font-family: courier new, courier, monospace;">WM_CLIPBOARDUPDATE</span> constant.</p>
<p>These rules, in the form <span style="font-family: courier new, courier, monospace;">&lt;regular_expresssion&gt;!&lt;wallet&gt;</span>, match the format of cryptocurrency wallet addresses and replace them with addresses of wallets controlled by the malware operator. This is an attempt to redirect transactions made by the victim to the operator&#8217;s wallets. This component uses a <a href="https://docs.microsoft.com/en-us/dotnet/api/system.io.filesystemwatcher" target="_blank" rel="noopener">FileSystemWatcher</a> to reload replacement rules whenever the <span style="font-family: courier new, courier, monospace;">settings.cfg</span> file is changed.</p>
<div id="attachment_142520" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-11.png"><img class="wp-image-142520" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-11-150x150.png" alt="" width="700" height="247" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-11-300x106.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-11-768x271.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-11-420x149.png 420w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-11.png 959w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 11. Decompiled code for the listener function used by the clipboard hook</i></p></div>
<p>At the time of this writing, the wallets used by the clipboard hijacking component had received a little over US$1800 in Bitcoin and Ethereum. One such wallet is shown in Figure 12. By correlating wallets used as sources in the same transactions as known ones, we were able to uncover at least four additional Bitcoin wallets that likely belong to KryptoCibule&#8217;s operators.</p>
<div id="attachment_142521" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-12.png"><img class="wp-image-142521" src="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-12-150x150.png" alt="" width="700" height="179" srcset="https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-12-300x77.png 300w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-12-768x197.png 768w, https://www.welivesecurity.com/wp-content/uploads/2020/08/Figure-12.png 836w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><i>Figure 12. A Bitcoin wallet used by the clipboard-hijacking component</i></p></div>
<h3>File exfiltration</h3>
<p>The third component walks through the filesystem of each available drive and looks for filenames that contain certain terms. A list of such terms we obtained during our investigation is shown in Figure 13.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6057fb147d9a4424341479" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
["wallet.dat", "utc--2014", "utc--2015", "utc--2016", "utc--2017", "utc--2018", "utc--2019", "utc--2020", ".address.txt", "electrum", "bitcoin", "litecoin", "ethereum", "cardano", "zcash", "monero", "cripto", "krypto", "binance", "tradeogre", "coinbase", "tether", "daedalus", "stellar", "tezos", "chainlink", "blockchain", "verge", "bittrex", "ontology", "vechain", "doge", "qtum", "augur", "omisego", "digibyte", "seele", "enjin", "steem", "bytecoin", "zilliqa", "zcoin", "miner", "xmrig", "xmr-stak","electroneum", "heslo", "waves", "banka", "crypto", "hesla", "seed", "metamask", "antminer", "trezor", "ledger", "private", "trx", "exodus", "password", "jaxx", "guarda", "atomic.exe", "copay.exe", "Green Address Wallet.exe", "msigna.exe", "ArmoryQT.exe", ".ssh", ".aws", "Desktop"]</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6057fb147d9a4424341479-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6057fb147d9a4424341479-1"><span class="crayon-sy">[</span><span class="crayon-s">"wallet.dat"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"utc--2014"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"utc--2015"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"utc--2016"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"utc--2017"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"utc--2018"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"utc--2019"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"utc--2020"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">".address.txt"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"electrum"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"bitcoin"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"litecoin"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"ethereum"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"cardano"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"zcash"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"monero"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"cripto"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"krypto"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"binance"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"tradeogre"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"coinbase"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"tether"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"daedalus"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"stellar"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"tezos"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"chainlink"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"blockchain"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"verge"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"bittrex"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"ontology"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"vechain"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"doge"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"qtum"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"augur"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"omisego"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"digibyte"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"seele"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"enjin"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"steem"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"bytecoin"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"zilliqa"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"zcoin"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"miner"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"xmrig"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"xmr-stak"</span><span class="crayon-sy">,</span><span class="crayon-s">"electroneum"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"heslo"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"waves"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"banka"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"crypto"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"hesla"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"seed"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"metamask"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"antminer"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"trezor"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"ledger"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"private"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"trx"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"exodus"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"password"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"jaxx"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"guarda"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"atomic.exe"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"copay.exe"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"Green Address Wallet.exe"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"msigna.exe"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"ArmoryQT.exe"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">".ssh"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">".aws"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"Desktop"</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0007 seconds] -->
<p><small><em>Figure 13. A list of words to search for, taken from the <span style="font-family: courier new, courier, monospace;">GET %C&amp;C%/settingsv5</span> response</em></small></p>
<p>Most terms refer to cryptocurrencies, wallets or miners, but a few more generic ones like crypto (in several languages), seed and password are present also. The list contains similar terms in Czech and Slovak such as <span style="font-family: courier new, courier, monospace;">heslo</span>, <span style="font-family: courier new, courier, monospace;">hesla</span> and <span style="font-family: courier new, courier, monospace;">banka</span> (these are the words for &#8220;password&#8221;, &#8220;passwords&#8221; and &#8220;bank&#8221;, respectively). A few terms also correspond to paths or files that could provide other interesting data (Desktop, private) including private keys (<span style="font-family: courier new, courier, monospace;">.ssh</span>, <span style="font-family: courier new, courier, monospace;">.aws</span>). It gathers the full path of each of the matching files and sends the list to <span style="font-family: courier new, courier, monospace;">%C&amp;C%/found/&lt;unique name&gt;</span>.</p>
<p>We believe that this works in tandem with the SFTP server running as an onion service on port 9187. This server creates mappings for every available drive and makes them available using credentials hardcoded in the malware. The gathered paths can thus be used for file exfiltration by having an attacker-controlled machine request them from the infected host over SFTP.</p>
<p>KryptoCibule also installs a legitimate Apache httpd server that is configured to act as a forward proxy without any restrictions and that is reachable as an onion service on port 9999.</p>
<h2>Conclusion</h2>
<p>The KryptoCibule malware has been in the wild since late 2018 and is still active, but it doesn&#8217;t seem to have attracted much attention until now. Its use of legitimate open-source tools along with the wide range of anti-detection methods deployed are likely responsible for this. The relatively low number of victims (in the hundreds) and their being mostly confined to two countries may also contribute to this. New capabilities have regularly been added to KryptoCibule over its lifetime and it continues to be under active development.</p>
<p>Presumably the malware operators were able to earn more money by stealing wallets and mining cryptocurrencies than what we found in the wallets used by the clipboard hijacking component. The revenue generated by that component alone does not seem enough to justify the development effort observed.</p>
<h2>Indicators of Compromise (IoCs)</h2>
<p>The comprehensive list of Indicators of Compromise (IoCs) and samples can be found in <a href="https://github.com/eset/malware-ioc/tree/master/kryptocibule/" target="_blank" rel="noopener">our GitHub repository</a>.</p>
<h3>Samples</h3>

<table id="tablepress-867" class="tablepress tablepress-id-867">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">3BCEF852639F85803974943FC34EFF2D6D7D916D</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">armsvc.exe</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">MSIL/KryptoCibule.A</span></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">352743EBE6A0638CC0614216AD000B6A43C4D46E</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">SystemArchitectureTranslation.exe</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">MSIL/KryptoCibule.A</span></td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">70480D5F4CB10DE42DD2C863DDF57102BE6FA9E0</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Updater.exe</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">MSIL/KryptoCibule.A</span></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">2E568CDF9B28824FBA1D7C16D8D0BE1D73A3FEBA</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Setup.exe</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">MSIL/KryptoCibule.A</span></td>
</tr>
</tbody>
</table>

<h2>Network</h2>
<ul>
<li><span style="font-family: courier new, courier, monospace;">rlwryismmgjijryr55u5rqlbqghqvrwxe5qgxupuviyysxkky5wah6yd.onion<br />
</span></li>
<li><span style="font-family: courier new, courier, monospace;">4dtu3lxrpx6nn7snjovoc3ldiy4x67k7qsrgzftvkrttoqbwnsuirhqd.onion<br />
</span></li>
<li><span style="font-family: courier new, courier, monospace;">v6lajszeqfkt3h2nptorindpf3mow5p3thrx2vuqbqzbv3tjrcqmgdqd.onion</span></li>
</ul>
<h2>Scheduled Tasks</h2>

<table id="tablepress-868" class="tablepress tablepress-id-868">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Name</th><th class="column-2">Executable Path</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">GoogleUpdateTask</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">%LocalAppData%\Microsoft\Architecture\SystemArchitectureTranslation.exe</span></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Adobe Update Task</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">%ProgramFiles(X86)%\Adobe\Acrobat Reader DC\Reader\Update\armsvc.exe</span></td>
</tr>
</tbody>
</table>

<h2>MITRE ATT&amp;CK techniques</h2>
<p><em>This table was built using </em><a href="https://attack.mitre.org/versions/">version 7</a><em> of the ATT&amp;CK framework.</em></p>

<table id="tablepress-870" class="tablepress tablepress-id-870">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1189/" rel="noopener" target="_blank">T1189</a></td><td class="column-3">Drive-by Compromise</td><td class="column-4">KryptoCibule is spread through torrent and file-sharing websites.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="4" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1059/001/" rel="noopener" target="_blank">T1059.001</a></td><td class="column-3">Command and Scripting Interpreter: PowerShell</td><td class="column-4">KryptoCibule directly executes PowerShell commands.<br />
Some commands received from the C&amp;C use PowerShell.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1059/003/" rel="noopener" target="_blank">T1059.003</a></td><td class="column-3">Command and Scripting Interpreter: Windows Command Shell</td><td class="column-4">Commands received from the KryptoCibule C&amp;C are executed with <span style="font-family: courier new, courier, monospace;">cmd.exe</span>.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1106/" rel="noopener" target="_blank">T1106</a></td><td class="column-3">Native API</td><td class="column-4">KryptoCibule uses the <span style="font-family: courier new, courier, monospace;">System.Diagnostics.Process</span> C# class to run processes.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1204/002/" rel="noopener" target="_blank">T1204.002</a></td><td class="column-3">User Execution: Malicious File</td><td class="column-4">KryptoCibule requires victims to run an installer from a downloaded torrent.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1053/005/" rel="noopener" target="_blank">T1053.005</a></td><td class="column-3">Scheduled Task/Job: Scheduled Task</td><td class="column-4">KryptoCibule attains persistence by creating a scheduled task to run the main executable every five minutes.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="10" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">KryptoCibule executables are obfuscated with Obfuscar.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1036/" rel="noopener" target="_blank">T1036</a></td><td class="column-3">Masquerading</td><td class="column-4">KryptoCibule components use misleading names and a configuration file masquerades as a DLL.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1036/004/" rel="noopener" target="_blank">T1036.004</a></td><td class="column-3">Masquerading: Masquerade Task or Service</td><td class="column-4">KryptoCibule tasks are named after legitimate and benign looking software.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1036/005/" rel="noopener" target="_blank">T1036.005</a></td><td class="column-3">Masquerading: Match Legitimate Name or Location</td><td class="column-4">KryptoCibule uses paths and filenames that match those of Adobe Reader for malware and Tor client.<br />
BuruServer uses paths and filenames for OpenSSH.<br />
Transmission is installed to Java runtime directories.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">The files that come with the KryptoCibule installer are XOR-encrypted.<br />
PowerShell commands from the KryptoCibule C&amp;C are base64-encoded.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1497/" rel="noopener" target="_blank">T1497</a></td><td class="column-3">Virtualization/Sandbox Evasion</td><td class="column-4">The KryptoCibule payload is not executed if an analysis tool is detected.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1497/002/" rel="noopener" target="_blank">T1497.002</a></td><td class="column-3">Virtualization/Sandbox Evasion: User Activity Based Checks</td><td class="column-4">KryptoCibule uses the time since last input to set limits on cryptominer CPU usage.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1562/001/" rel="noopener" target="_blank">T1562.001</a></td><td class="column-3">Impair Defenses: Disable or Modify Tools</td><td class="column-4">KryptoCibule uses  <span style="font-family: courier new, courier, monospace;">Add-MpPreference -ExclusionPath</span> to exclude malware and installed tools from Windows Defender scanning.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1562/004/" rel="noopener" target="_blank">T1562.004</a></td><td class="column-3">Impair Defenses: Disable or Modify System Firewall</td><td class="column-4">KryptoCibule uses  <span style="font-family: courier new, courier, monospace;">advfirewall firewall add rule</span>  to allow its tools and block the ESET Kernel Service.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1564/003/" rel="noopener" target="_blank">T1564.003</a></td><td class="column-3">Hide Artifacts: Hidden Window</td><td class="column-4">KryptoCibule hides process windows using the  <span style="font-family: courier new, courier, monospace;">windowstyle hidden</span> option.</td>
</tr>
<tr class="row-18 even">
	<td rowspan="4" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">KryptoCibule uses  <span style="font-family: courier new, courier, monospace;">System.Diagnostics.Process.GetProcesses</span> to get a list of running processes.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">KryptoCibule obtains information about host’s timezone, locale, power status, OS and hardware.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">KryptoCibule has a component that looks for files on the local file system.  </td>
</tr>
<tr class="row-21 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1518/001/" rel="noopener" target="_blank">T1518.001</a></td><td class="column-3">Software Discovery: Security Software Discovery</td><td class="column-4">KryptoCibule looks for antivirus software in the  <span style="font-family: courier new, courier, monospace;">root\\SecurityCenter2 → AntivirusProduct ManagementObject</span>.<br />
The cryptominer component is not installed if it detects an installed antivirus product.</td>
</tr>
<tr class="row-22 even">
	<td rowspan="2" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1005/" rel="noopener" target="_blank">T1005  </a></td><td class="column-3">Data from Local System</td><td class="column-4">KryptoCibule learches all attached drives for a list of filenames .</td>
</tr>
<tr class="row-23 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1119/" rel="noopener" target="_blank">T1119</a></td><td class="column-3">Automated Collection</td><td class="column-4">KryptoCibule programmatically collect paths for files to be exfiltrated.</td>
</tr>
<tr class="row-24 even">
	<td rowspan="6" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1071/001/" rel="noopener" target="_blank">T1071.001</a></td><td class="column-3">Application Layer Protocol: Web Protocols</td><td class="column-4">KryptoCibule uses HTTP for C&amp;C communication.</td>
</tr>
<tr class="row-25 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1071/002/" rel="noopener" target="_blank">T1071.002 </a></td><td class="column-3">File Transfer Protocols</td><td class="column-4">KryptoCibule downloads updates and additional tools via BitTorrent.</td>
</tr>
<tr class="row-26 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1090/003/" rel="noopener" target="_blank">T1090.003</a></td><td class="column-3">Proxy: Multi-hop Proxy</td><td class="column-4">KryptoCibule bundles Tor and uses it as a SOCKS proxy to communicate with its C&amp;C.</td>
</tr>
<tr class="row-27 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1105/" rel="noopener" target="_blank">T1105</a></td><td class="column-3">Ingress Tool Transfer</td><td class="column-4">KryptoCibule downloads additional tools using BitTorrent.</td>
</tr>
<tr class="row-28 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1568/" rel="noopener" target="_blank">T1568</a></td><td class="column-3">Dynamic Resolution</td><td class="column-4">KryptoCibule gets additional onion URIs over HTTP.</td>
</tr>
<tr class="row-29 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1571/" rel="noopener" target="_blank">T1571</a></td><td class="column-3">Non-Standard Port</td><td class="column-4">KryptoCibule uses port 9187 for SFTP server, and 9999 and 12461 for HTTP servers.</td>
</tr>
<tr class="row-30 even">
	<td rowspan="3" class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1020/" rel="noopener" target="_blank">T1020</a></td><td class="column-3">Automated Exfiltration</td><td class="column-4">Logs, file locations and system info are automatically collected and sent to the KryptoCibule C&amp;C.</td>
</tr>
<tr class="row-31 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2   Channel</td><td class="column-4">Logs, file locations and system info are sent via the KryptoCibule HTTP C&amp;C channel.</td>
</tr>
<tr class="row-32 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1048/" rel="noopener" target="_blank">T1048</a></td><td class="column-3">Exfiltration Over Alternative Protocol</td><td class="column-4">KryptoCibule exfiltrates files over SFTP.</td>
</tr>
<tr class="row-33 odd">
	<td rowspan="2" class="column-1">Impact</td><td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1496/" rel="noopener" target="_blank">T1496</a></td><td class="column-3">Resource Hijacking</td><td class="column-4">KryptoCibule uses XMRig and Kawpowminer to mine cryptocurrency on victim systems.</td>
</tr>
<tr class="row-34 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v7/techniques/T1565/" rel="noopener" target="_blank">T1565</a></td><td class="column-3">Data Manipulation</td><td class="column-4">KryptoCibule replaces cryptocurrency wallet addresses in the clipboard in an attempt to hijack transfers.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/acotecyr/" title="Alexandre Côté Cyr">
                    Alexandre Côté Cyr                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2020-09-02 11:30:31">2 Sep 2020 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="KryptoCibule: The multitasking multicurrency cryptostealer">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="KryptoCibule: The multitasking multicurrency cryptostealer">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="KryptoCibule: The multitasking multicurrency cryptostealer">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="KryptoCibule: The multitasking multicurrency cryptostealer">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F09%2F02%2Fkryptocibule-multitasking-multicurrency-cryptostealer%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F09%2F02%2Fkryptocibule-multitasking-multicurrency-cryptostealer%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2020%2F09%2F02%2Fkryptocibule-multitasking-multicurrency-cryptostealer%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"142373 https:\/\/backend.welivesecurity.com\/?p=142373","disqusShortname":"welivesecurity","disqusTitle":"KryptoCibule: The multitasking multicurrency cryptostealer","disqusUrl":"https:\/\/www.welivesecurity.com\/2020\/09\/02\/kryptocibule-multitasking-multicurrency-cryptostealer\/","postId":"142373"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>