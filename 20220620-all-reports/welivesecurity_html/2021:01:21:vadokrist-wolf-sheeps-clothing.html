<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Vadokrist: A wolf in sheep&#8217;s clothing | WeLiveSecurity</title>
<meta name="description" content="ESET dissects Vadokrist, a banking trojan that targets financial institutions in Brazil and is distributed via malicious spam emails."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/01/21/vadokrist-wolf-sheeps-clothing/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Vadokrist: A wolf in sheep&#8217;s clothing | WeLiveSecurity" />
<meta property="og:description" content="ESET dissects Vadokrist, a banking trojan that targets financial institutions in Brazil and is distributed via malicious spam emails." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/01/21/vadokrist-wolf-sheeps-clothing/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2021-01-21T10:30:48+00:00" />
<meta property="article:modified_time" content="2021-01-21T07:15:02+00:00" />
<meta property="og:updated_time" content="2021-01-21T07:15:02+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/01/eset-malware-research-vadokrist-wolf-sheeps-clothing.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/01/eset-malware-research-vadokrist-wolf-sheeps-clothing.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="666" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET dissects Vadokrist, a banking trojan that targets financial institutions in Brazil and is distributed via malicious spam emails." />
<meta name="twitter:title" content="Vadokrist: A wolf in sheep&#8217;s clothing | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/01/eset-malware-research-vadokrist-wolf-sheeps-clothing.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/br/2021/01/21/vadokrist-malware-bancario-direcionado-ao-brasil/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2021/01/21/vadokrist-loup-bergerie/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2021/01/21/vadokrist-wolf-sheeps-clothing/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2021/01/21/vadokrist-analisis-de-este-malware-bancario-que-apunta-a-brasil/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2021/01/25/vadokrist-ein-wolf-im-schafspelz/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2021/01/21/vadokrist-malware-bancario-direcionado-ao-brasil/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2021/01/21/vadokrist-loup-bergerie/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2021/01/21/vadokrist-analisis-de-este-malware-bancario-que-apunta-a-brasil/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2021/01/25/vadokrist-ein-wolf-im-schafspelz/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2021/01/21/vadokrist-malware-bancario-direcionado-ao-brasil/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2021/01/21/vadokrist-loup-bergerie/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2021/01/21/vadokrist-analisis-de-este-malware-bancario-que-apunta-a-brasil/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2021/01/25/vadokrist-ein-wolf-im-schafspelz/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/01/eset-research-malware-vadokrist-wolf-sheeps-clothing.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Vadokrist: A wolf in sheep&#8217;s clothing</h1>
<div class="excerpt">Another in our occasional series demystifying Latin American banking trojans</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-01-21 11:30:48">21 Jan 2021 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F01%2F21%2Fvadokrist-wolf-sheeps-clothing%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F01%2F21%2Fvadokrist-wolf-sheeps-clothing%2F&text=Vadokrist: A wolf in sheep&#8217;s clothing%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F01%2F21%2Fvadokrist-wolf-sheeps-clothing%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Another in our occasional series demystifying Latin American banking trojans</p>
                            </div>

                            <p>Vadokrist is a Latin American banking trojan that ESET has been tracking since 2018 and that is active almost exclusively in Brazil. In this installment of our series, we examine its main features and some connections to other Latin American banking trojan families.</p>
<p>Vadokrist shares several important features with families we have described earlier in the series, namely <a href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" target="_blank" rel="noopener">Amavaldo</a>, <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">Casbaneiro</a>, <a href="https://www.welivesecurity.com/2020/04/28/grandoreiro-how-engorged-can-exe-get/" target="_blank" rel="noopener">Grandoreiro</a> and <a href="https://www.welivesecurity.com/2020/08/13/mekotio-these-arent-the-security-updates-youre-looking-for/" target="_blank" rel="noopener">Mekotio</a>. We recently published a <a href="https://www.welivesecurity.com/2020/10/01/latam-financial-cybercrime-competitors-crime-sharing-ttps/" target="_blank" rel="noopener">white paper</a> dedicated to documenting the similarities between Latin American banking trojans, whereas this blogpost series focuses more on the detailed analysis of one family at a time.</p>
<h2>Characteristics</h2>
<p>Vadokrist is written in Delphi. One of the most notable characteristics is the unusually large amount of unused code in the binaries. After further examination, we believe this is an attempt to evade detection and dissuade or slow analysis. We were able to link some of the code to existing Delphi projects, such as <a href="https://www.quickreport.co.uk/product-information/" target="_blank" rel="noopener">QuickReport</a>.</p>
<p>Vadokrist stores strings inside string tables. It used to contain an implementation of a string table identical to Casbaneiro (illustrated in Figure 1); however, some recent versions of this banking trojan switched to using multiple string tables, each for a different purpose (list of targets, general configuration, backdoor command names, etc.).</p>
<div id="attachment_147143" style="width: 565px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-1.-String-table-implementation-in-earlier-Vadokrist-binaries.png"><img class="wp-image-147143 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-1.-String-table-implementation-in-earlier-Vadokrist-binaries.png" alt="" width="555" height="756" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-1.-String-table-implementation-in-earlier-Vadokrist-binaries.png 555w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-1.-String-table-implementation-in-earlier-Vadokrist-binaries-220x300.png 220w" sizes="(max-width: 555px) 100vw, 555px" /></a><p class="wp-caption-text"><i>Figure 1. String table implementation in earlier Vadokrist binaries</i></p></div>
<p>The vast majority of Latin American banking trojans collect information about the victim machine (typically computer name and version of the Windows OS) when first run. The only information Vadokrist collects is the victim’s username and it does so only after initiating an attack on a targeted financial institution, not, unlike most other Latin American banking trojans, at install time.</p>
<p>To ensure persistence, Vadokrist utilizes either a Run key or it creates a LNK file in the startup folder.</p>
<p>Its backdoor capabilities are typical for this type of threat, being able to manipulate the mouse and simulate keyboard input, log keystrokes, take screenshots, and restart the machine. It is also able to prevent access to some websites, which it does in a rather clumsy way by killing the browser process when the victim attempts to visit such websites. We believe this technique is used to prevent the victims from accessing their online bank accounts once the attackers have compromised it, aiding them in retaining control.</p>
<h2>Cryptography</h2>
<p>The majority of Vadokrist binaries implement a cryptographic algorithm we have seen in other Latin American banking trojans (namely Amavaldo and Casbaneiro) that we have dubbed TripleKey. Vadokrist uses this algorithm to protect its strings, and occasionally payloads and remote configurations as well (we dig deeper into this topic later). For clarity, we have implemented the algorithm in Python, as seen in Figure 2.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60580e1222e3f308657273" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def decrypt_payload(data_enc, key1, key2, key3):
    data_dec = str()

    for c in data_enc:
		x = data_enc[i] ^ (key3 &gt;&gt; 8) &amp; 0xFF
		data_dec += chr(x)
		key3 = ((x + key3) &amp; 0xFF) * key1 + key2

    return data_dec

def decrypt_string(data_enc, key1, key2, key3):
    data_dec = str()

    for c in data_enc:
		x = data_enc[i] ^ (key3 &gt;&gt; 8) &amp; 0xFF
		data_dec += chr(x)
		key3 = ((data_enc[i] + key3) &amp; 0xFFFF) * key1 + key2

    return data_dec</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60580e1222e3f308657273-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580e1222e3f308657273-2">2</div><div class="crayon-num" data-line="crayon-60580e1222e3f308657273-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580e1222e3f308657273-4">4</div><div class="crayon-num" data-line="crayon-60580e1222e3f308657273-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580e1222e3f308657273-6">6</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom" data-line="crayon-60580e1222e3f308657273-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580e1222e3f308657273-8">8</div><div class="crayon-num" data-line="crayon-60580e1222e3f308657273-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580e1222e3f308657273-10">10</div><div class="crayon-num" data-line="crayon-60580e1222e3f308657273-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580e1222e3f308657273-12">12</div><div class="crayon-num" data-line="crayon-60580e1222e3f308657273-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580e1222e3f308657273-14">14</div><div class="crayon-num" data-line="crayon-60580e1222e3f308657273-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580e1222e3f308657273-16">16</div><div class="crayon-num crayon-marked-num crayon-top crayon-bottom" data-line="crayon-60580e1222e3f308657273-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-60580e1222e3f308657273-18">18</div><div class="crayon-num" data-line="crayon-60580e1222e3f308657273-19">19</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60580e1222e3f308657273-1"><span class="crayon-e">def </span><span class="crayon-e">decrypt_payload</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key3</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580e1222e3f308657273-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60580e1222e3f308657273-3">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60580e1222e3f308657273-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">data_enc</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-60580e1222e3f308657273-5"><span class="crayon-h">		</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_enc</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">key3</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580e1222e3f308657273-6"><span class="crayon-h">		</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom" id="crayon-60580e1222e3f308657273-7"><span class="crayon-h">		</span><span class="crayon-v">key3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">key3</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">key1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">key2</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580e1222e3f308657273-8">&nbsp;</div><div class="crayon-line" id="crayon-60580e1222e3f308657273-9"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-e">data_dec</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580e1222e3f308657273-10">&nbsp;</div><div class="crayon-line" id="crayon-60580e1222e3f308657273-11"><span class="crayon-e">def </span><span class="crayon-e">decrypt_string</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key1</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key2</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key3</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580e1222e3f308657273-12"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">str</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60580e1222e3f308657273-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60580e1222e3f308657273-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-v">data_enc</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-60580e1222e3f308657273-15"><span class="crayon-h">		</span><span class="crayon-v">x</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">data_enc</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">key3</span><span class="crayon-h"> </span><span class="crayon-o">&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580e1222e3f308657273-16"><span class="crayon-h">		</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-e">chr</span><span class="crayon-sy">(</span><span class="crayon-v">x</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-marked-line crayon-top crayon-bottom" id="crayon-60580e1222e3f308657273-17"><span class="crayon-h">		</span><span class="crayon-v">key3</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">data_enc</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-v">key3</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFFFF</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">key1</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-e">key2</span></div><div class="crayon-line crayon-striped-line" id="crayon-60580e1222e3f308657273-18">&nbsp;</div><div class="crayon-line" id="crayon-60580e1222e3f308657273-19"><span class="crayon-e">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">data_dec</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0006 seconds] -->
<p><em>Figure 2. TripleKey encryption scheme used by Vadokrist to protect strings, payloads and remote configurations</em></p>
<p>Besides that, we have seen Vadokrist using RC4 in some of its recent binaries and, in the past, TwoFish as well. This is quite rare among Latin American banking trojans as most of them never use generally known cryptographic algorithms.</p>
<h2>Distribution</h2>
<h3>MSI overload</h3>
<p>Recent spam emails distributing Vadokrist contain two nested ZIP archives that contain two files – an MSI installer and a CAB archive. If a victim executes the MSI installer, it locates the CAB archive and extracts its contents (an MSI loader) to disk. It then executes an embedded JavaScript file that adds a Run key entry, making sure the MSI loader is executed on system startup. Finally, the script restarts the machine. On startup, the MSI loader executes an embedded DLL – the Vadokrist banking trojan. The whole process is illustrated in Figure 3. Notice that no actual downloader is in place; the banking trojan is distributed directly by these spam emails.</p>
<div id="attachment_147144" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-3.-Execution-chain-recently-used-by-Vadokrist.png"><img class="wp-image-147144" src="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-3.-Execution-chain-recently-used-by-Vadokrist-660x1024.png" alt="" width="600" height="931" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-3.-Execution-chain-recently-used-by-Vadokrist-660x1024.png 660w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-3.-Execution-chain-recently-used-by-Vadokrist-193x300.png 193w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-3.-Execution-chain-recently-used-by-Vadokrist-768x1192.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-3.-Execution-chain-recently-used-by-Vadokrist.png 1000w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><i>Figure 3. Execution chain recently used by Vadokrist</i></p></div>
<p>The JavaScript file is worth mentioning because of its obfuscation. It leverages <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Comma_Operator" target="_blank" rel="noopener">how the comma operator (,) works in JavaScript</a> and abuses it to greatly reduce readability and possibly to bypass emulation. It obfuscates conditions using the logical AND operator (&amp;&amp;) in a similar manner. See an example in Figure 4.</p>
<div id="attachment_147145" style="width: 910px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-4.-JavaScript-installer-used-by-Vadokrist.png"><img class="wp-image-147145" src="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-4.-JavaScript-installer-used-by-Vadokrist-150x150.png" alt="" width="900" height="303" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-4.-JavaScript-installer-used-by-Vadokrist-300x101.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-4.-JavaScript-installer-used-by-Vadokrist-768x259.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-4.-JavaScript-installer-used-by-Vadokrist-1024x345.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-4.-JavaScript-installer-used-by-Vadokrist.png 1463w" sizes="(max-width: 900px) 100vw, 900px" /></a><p class="wp-caption-text"><i>Figure 4. JavaScript installer used by Vadokrist. The bottom part shows the script with transformed operators for better readability.</i></p></div>
<h3>Older distribution &amp; execution techniques</h3>
<p>We observed Vadokrist, like most other Latin American banking trojans, using several implementations of the typical distribution chain. We won’t cover all of them, but two are worth mentioning. We have seen Vadokrist sharing a Delphi downloader with Grandoreiro and a whole distribution chain with Mekotio – in fact, the one marked as Chain 1 in our <a href="https://www.welivesecurity.com/2020/08/13/mekotio-these-arent-the-security-updates-youre-looking-for/" target="_blank" rel="noopener">blogpost about Mekotio</a>.</p>
<p>Vadokrist occasionally relies on DLL side-loading with a specific injector to decrypt and execute the banking trojan. This injector is identical to the one used by Amavaldo and implements the aforementioned TripleKey algorithm for data decryption.</p>
<h2>Remote configuration</h2>
<p>Vadokrist utilizes remote configuration both in downloaders and the actual banking trojan, usually hosted on public storage services such as GitHub.</p>
<p>The configuration file is usually encrypted, either by TripleKey or RC4. In Figure 5, you can see that in both cases the data can be decrypted without any additional knowledge – in the case of the TripleKey method, we can extract all three keys from the end of the string and in the case of RC4, we can derive the key from the password. In the case of the latter, the encrypted data is further encoded by base64.</p>
<p>The delimiter also changes from time to time. So far, we have seen three different characters used: “|”, “!” and “/”.</p>
<div id="attachment_147146" style="width: 510px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-5.-Encrypted-remote-configuration-files-used-by-Vadokrist.png"><img class="wp-image-147146" src="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-5.-Encrypted-remote-configuration-files-used-by-Vadokrist.png" alt="" width="500" height="226" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-5.-Encrypted-remote-configuration-files-used-by-Vadokrist.png 595w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-5.-Encrypted-remote-configuration-files-used-by-Vadokrist-300x136.png 300w" sizes="(max-width: 500px) 100vw, 500px" /></a><p class="wp-caption-text"><i>Figure 5. Encrypted remote configuration files used by Vadokrist</i></p></div>
<p>Now that we know how to decrypt the configuration file, let’s examine its contents. In the case of the banking trojan, the result is easy to understand, as it is the IP address of a C&amp;C server. For downloaders, the format is a bit more complex, as illustrated in Figure 6.</p>
<div id="attachment_147147" style="width: 910px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-6.-Different-formats-of-remote-configuration-used-by-Vadokrist-downloaders.png"><img class="wp-image-147147" src="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-6.-Different-formats-of-remote-configuration-used-by-Vadokrist-downloaders-150x150.png" alt="" width="900" height="207" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-6.-Different-formats-of-remote-configuration-used-by-Vadokrist-downloaders-300x69.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-6.-Different-formats-of-remote-configuration-used-by-Vadokrist-downloaders-768x177.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-6.-Different-formats-of-remote-configuration-used-by-Vadokrist-downloaders-1024x236.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/01/Figure-6.-Different-formats-of-remote-configuration-used-by-Vadokrist-downloaders.png 1449w" sizes="(max-width: 900px) 100vw, 900px" /></a><p class="wp-caption-text"><i>Figure 6. Different formats of remote configuration used by Vadokrist downloaders</i></p></div>
<p>To simplify, we recognize a configuration with an optional ID and six fields:</p>
<ul>
<li>[mandatory] The URL to download the banking trojan from</li>
<li>[optional] Special folder (first part of the installation path)</li>
<li>[optional] Installation flag (described below)</li>
<li>[optional] Path (second part of the installation path)</li>
<li>[optional] Filename (third and final part of the installation path)</li>
<li>[mandatory] Notification URL</li>
</ul>
<p>Two of these fields may require further explanation. If the installation flag is set to “T”, all three parts of the installation path will be used; otherwise the first one will be ignored. The only thing that is sent to the <em>notification</em> URL is whether an application <span style="font-family: courier new, courier, monospace;">Core.exe</span> is running – a check familiar from other Latin American banking trojans that try to detect the presence of anti-fraud software Warsaw GAS Tecnologia.</p>
<p>You can see that the first variant uses all the fields, the second one does not use the ID, and the third one only uses the two mandatory URL fields. The delimiter usage here is a bit more complex, as one delimiter is used to separate different entries and a different one to separate fields of an entry. Additionally, you can see that the delimiters change here as well.</p>
<p>The dynamically changing format of the configuration file indicates Vadokrist is under active and continuous development.</p>
<h2>Conclusion</h2>
<p>In this blogpost, we have dissected Vadokrist, a Latin American banking trojan that is focused on Brazil. We have shown that it has typical characteristics of a Latin American banking trojan – it is written in Delphi, offers backdoor functionality and targets financial institutions. Its main deviation from the typical implementation is that it does not collect information about victims right after successfully compromising their machines.</p>
<p>We have covered its encryption schemes, distribution and execution methods and remote configuration formats. Vadokrist seems to be connected to Amavaldo, Casbaneiro, Grandoreiro and Mekotio, other Latin American banking trojans described earlier in our series.</p>
<p><em>For any inquiries, contact us at threatintel@eset.com. Indicators of Compromise can also be found in <a href="https://github.com/eset/malware-ioc/tree/master/vadokrist" target="_blank" rel="noopener">our GitHub repository</a>.</em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>Hashes</h3>
<h4>Campaign “MSI overload”</h4>

<table id="tablepress-901" class="tablepress tablepress-id-901">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">D8C6DDACC42645DF0F760489C5A4C3AA686998A1</td><td class="column-2">MSI installer</td><td class="column-3">JS/TrojanDownloader.Banload.ABD</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">01ECACF490F303891118893242F5600EF9154184</td><td class="column-2">MSI loader</td><td class="column-3">Win32/Spy.Vadokrist.T</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">F81A58C11AF26BDAFAC1EB2DD1D468C5A80F8F28</td><td class="column-2">Vadokrist banking trojan</td><td class="column-3">Win32/Spy.Vadokrist.T</td>
</tr>
</tbody>
</table>

<h4>Other</h4>

<table id="tablepress-902" class="tablepress tablepress-id-902">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">8D7E133530E4CCECE9CD4FD8C544E0913D26FE4B</td><td class="column-2">Vadokrist banking trojan</td><td class="column-3">Win32/Spy.Vadokrist.AF</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">AD4289E61642A4A724C9F44356540DF76A35B741</td><td class="column-2">Vadokrist banking trojan</td><td class="column-3">Win32/Spy.Vadokrist.T</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">BD71A9D09F7E445BE5ACDF412657C8CFCE0F717D</td><td class="column-2">Vadokrist banking trojan</td><td class="column-3">Win32/Spy.Vadokrist.AD</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">06C0A039DEDBEF4B9013F8A35AACD7F33CD47524</td><td class="column-2">Downloader (MSI/JS)</td><td class="column-3">JS/TrojanDownloader.Banload.AAO</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">FADA4C27B78DDE798F1E917F82226B983C5B74D8</td><td class="column-2">Downloader (Delphi)</td><td class="column-3">Win32/Spy.Vadokrist.Y</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">525FCAA13E3867B58E442B4B1B612664AFB5A5C0</td><td class="column-2">Injector shared with Amavaldo</td><td class="column-3">Win32/Spy.Amavaldo.L</td>
</tr>
</tbody>
</table>

<h3>Recent C&amp;C servers</h3>
<ul>
<li>104.41.26[.]216</li>
<li>104.41.41[.]216</li>
<li>104.41.47[.]53</li>
<li>191.232.212[.]242</li>
<li>191.232.243[.]100</li>
<li>191.235.78[.]249</li>
<li>191.237.255[.]155</li>
<li>191.239.244[.]141</li>
<li>191.239.245[.]87</li>
<li>191.239.255[.]102</li>
</ul>
<h2>MITRE ATT&amp;CK techniques</h2>
<p><em>Note: This table was built using <a href="https://attack.mitre.org/resources/versions/" target="_blank" rel="noopener">version 8</a> of the MITRE ATT&amp;CK framework.</em></p>

<table id="tablepress-903" class="tablepress tablepress-id-903">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="2" class="column-1">Resource Development</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1583/001/" rel="noopener" target="_blank">T1583.001</a></td><td class="column-3">Acquire Infrastructure: Domains</td><td class="column-4">Vadokrist registers its own domains to be used as C&amp;C servers.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1587/001/" rel="noopener" target="_blank">T1587.001</a></td><td class="column-3">Develop Capabilities: Malware</td><td class="column-4">Vadokrist is operated by the same group that develops it.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1566/001/" rel="noopener" target="_blank">T1566.001</a></td><td class="column-3">Phishing: Spearphishing Attachment</td><td class="column-4">Vadokrist is distributed as a spam attachment.</td>
</tr>
<tr class="row-5 odd">
	<td rowspan="4" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1059/001/" rel="noopener" target="_blank">T1059.001</a></td><td class="column-3">Command and Scripting Interpreter: PowerShell</td><td class="column-4">Vadokrist uses PowerShell in some distribution chains.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1059/005/" rel="noopener" target="_blank">T1059.005</a></td><td class="column-3">Command and Scripting Interpreter: Visual Basic</td><td class="column-4">Vadokrist uses VBScript in some distribution chains.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1059/007/" rel="noopener" target="_blank">T1059.007</a></td><td class="column-3">Command and Scripting Interpreter: JavaScript/JScript</td><td class="column-4">Vadokrist uses JavaScript in its recent distribution chains.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1204/002/" rel="noopener" target="_blank">T1204.002</a></td><td class="column-3">User Execution: Malicious File</td><td class="column-4">Vadokrist relies on the user to execute the malicious binary.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1547/001/" rel="noopener" target="_blank">T1547.001</a></td><td class="column-3">Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</td><td class="column-4">Vadokrist ensures persistence via Run key or LNK file in the startup folder.</td>
</tr>
<tr class="row-10 even">
	<td rowspan="4" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Vadokrist is often distributed encrypted and encrypts its remote configuration.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1574/002/" rel="noopener" target="_blank">T1574.002</a></td><td class="column-3">Hijack Execution Flow: DLL Side-Loading</td><td class="column-4">Vadokrist is sometimes executed by this technique.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1036/005/" rel="noopener" target="_blank">T1036.005</a></td><td class="column-3">Masquerading: Match Legitimate Name or Location</td><td class="column-4">Vadokrist masquerades as legitimate software.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1218/007/" rel="noopener" target="_blank">T1218.007</a></td><td class="column-3">Signed Binary Proxy Execution: Msiexec</td><td class="column-4">Vadokrist uses the MSI format for execution.</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1056/001/" rel="noopener" target="_blank">T1056.001</a></td><td class="column-3">Input Capture: Keylogging</td><td class="column-4">Vadokrist can capture keystrokes.</td>
</tr>
<tr class="row-15 odd">
	<td rowspan="4" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1010/" rel="noopener" target="_blank">T1010</a></td><td class="column-3">Application Window Discovery</td><td class="column-4">Vadokrist looks for bank-related windows based on their names.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">Vadokrist tries to discover anti-fraud software by process name.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Vadokrist discovers victim’s username.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Vadokrist can take screenshots.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1132/002/" rel="noopener" target="_blank">T1132.002</a></td><td class="column-3">Data Encoding: Non-Standard Encoding</td><td class="column-4">Vadokrist communicates via a custom protocol encrypted with the TripleKey algorithm.</td>
</tr>
<tr class="row-20 even">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2 Channel</td><td class="column-4">Vadokrist exfiltrates data via C&amp;C server.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-01-21 11:30:48">21 Jan 2021 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybercrime/" class="category-tag-btn">Cybercrime</a>                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/fbi-cybercrime-losses-2020-ic3-623x432.jpg"
                                                         alt="Vadokrist: A wolf in sheep&#8217;s clothing">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/18/fbi-cybercrime-losses-topped-us42billion-2020/">
                                                    FBI: Cybercrime losses topped US$4.2 billion in 2020                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/03/exchange-servers-under-siege-10-apt-groups-623x432.jpg"
                                                         alt="Vadokrist: A wolf in sheep&#8217;s clothing">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/">
                                                    Exchange servers under siege from at least 10 APT groups                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/apple-m1-macs-malware-1-623x432.jpg"
                                                         alt="Vadokrist: A wolf in sheep&#8217;s clothing">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/18/malware-authors-already-taking-aim-apple-m1-macs/">
                                                    Malware authors already taking aim at Apple M1 Macs                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/02/eset-kobalos-hpc-high-performance-computing-malware-research-623x432.jpg"
                                                         alt="Vadokrist: A wolf in sheep&#8217;s clothing">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/02/02/kobalos-complex-linux-threat-high-performance-computing-infrastructure/">
                                                    Kobalos – A complex Linux threat to high performance computing infrastructure                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F01%2F21%2Fvadokrist-wolf-sheeps-clothing%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F01%2F21%2Fvadokrist-wolf-sheeps-clothing%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F01%2F21%2Fvadokrist-wolf-sheeps-clothing%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"147072 https:\/\/backend.welivesecurity.com\/?p=147072","disqusShortname":"welivesecurity","disqusTitle":"Vadokrist: A wolf in sheep\u2019s clothing","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/01\/21\/vadokrist-wolf-sheeps-clothing\/","postId":"147072"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>