<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'ESET Research',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>
<script>(function() {
  var _fbq = window._fbq || (window._fbq = []);
  if (!_fbq.loaded) {
    var fbds = document.createElement('script');
    fbds.async = true;
    fbds.src = '//connect.facebook.net/en_US/fbds.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(fbds, s);
    _fbq.loaded = true;
  }
  _fbq.push(['addPixelId', '1518099328403839']);
})();
window._fbq = window._fbq || [];
window._fbq.push(['track', 'PixelInitialized', {}]);
</script>
<noscript><img height="1" width="1" alt="" style="display:none" src="https://www.facebook.com/tr?id=1518099328403839&amp;ev=NoScript" /></noscript>
<meta property="fb:pages" content="56844830907" />
<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Ousaban: Private photo collection hidden in a CABinet | WeLiveSecurity</title>
<meta name="description" content="ESET research dissects Ousaban, a banking trojan that uses overlay windows to steal credentials and more data from financial institutions in Brazil."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Ousaban: Private photo collection hidden in a CABinet | WeLiveSecurity" />
<meta property="og:description" content="ESET research dissects Ousaban, a banking trojan that uses overlay windows to steal credentials and more data from financial institutions in Brazil." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2021-05-05T09:30:55+00:00" />
<meta property="article:modified_time" content="2021-05-05T09:47:11+00:00" />
<meta property="og:updated_time" content="2021-05-05T09:47:11+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/05/ousaban-banking-trojan-brazil-eset-research.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/05/ousaban-banking-trojan-brazil-eset-research.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="415" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET research dissects Ousaban, a banking trojan that uses overlay windows to steal credentials and more data from financial institutions in Brazil." />
<meta name="twitter:title" content="Ousaban: Private photo collection hidden in a CABinet | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/05/ousaban-banking-trojan-brazil-eset-research.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/fr/2021/05/05/ousaban-photos-caches-cabinet-cheval-troie/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/" hreflang="en" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>
<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.3";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2021/05/05/ousaban-photos-caches-cabinet-cheval-troie/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2021/05/05/ousaban-photos-caches-cabinet-cheval-troie/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong> 
					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/05/ousaban-brazil-banking-trojan-eset-research-1.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Ousaban: Private photo collection hidden in a CABinet</h1>
<div class="excerpt">Another in our occasional series demystifying Latin American banking trojans</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/04/android-fullpage-1024x576-Copy-222x179.jpg" alt="ESET Research">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-05-05 11:30:55">5 May 2021 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F05%2F05%2Fousaban-private-photo-collection-hidden-cabinet%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F05%2F05%2Fousaban-private-photo-collection-hidden-cabinet%2F&text=Ousaban: Private photo collection hidden in a CABinet%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F05%2F05%2Fousaban-private-photo-collection-hidden-cabinet%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Another in our occasional series demystifying Latin American banking trojans</p>
                            </div>

                            <p>Ousaban is a Latin American banking trojan active exclusively in Brazil. ESET has been tracking this malware family since 2018. In common with most other LATAM banking trojans, Ousaban uses overlay windows to steal credentials and more from financial institutions. However, unlike most other LATAM banking trojans, Ousaban’s developers have extended the use of overlay windows to steal credentials from popular regional email services. In this installment of our series, we examine its main features and many connections to other Latin American banking trojan families.</p>
<h2>Characteristics</h2>
<p>Ousaban is written in Delphi, as are the vast majority of the other Latin American banking trojans ESET is tracking. And, as do many of them, Ousaban shows signs of active and continuous development.</p>
<p>The name ESET assigned to this family is a portmanteau of two words – “<strong>ousa</strong>dia”, which means “boldness” in Portuguese, and “<strong>ban</strong>king trojan”. The reason for such a name is that for a very long time, Ousaban was distributed alongside the images (some of them obscene) shown in Figure 1. In the most recent campaigns distributing Ousaban, this is no longer the case.</p>
<div id="attachment_150314" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_01_DecoyImages.png"><img class="wp-image-150314" src="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_01_DecoyImages-300x118.png" alt="" width="700" height="276" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_01_DecoyImages-300x118.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_01_DecoyImages-768x303.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_01_DecoyImages-1024x404.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_01_DecoyImages.png 1546w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 1. Various images distributed alongside the Ousaban banking trojan</em></p></div>
<p>Ousaban is also known as Javali, a name assigned by Kaspersky. A recent article about Ousaban can be found <a href="https://seguranca-informatica.pt/latin-american-javali-trojan-weaponizing-avira-antivirus-legitimate-injector-to-implant-malware/" target="_blank" rel="noopener">here</a>. ESET has also been able to attribute Ousaban to the campaigns described in <a href="https://www.cybereason.com/blog/brazilian-financial-malware-dll-hijacking" target="_blank" rel="noopener">this blogpost</a> from 2018. Even though some sources claim Ousaban is active in Europe, ESET has never observed any campaign spreading this banking trojan outside of Brazil.</p>
<p>Ousaban protects its executables with either Themida or Enigma binary obfuscators. Additionally, most EXEs are enlarged, using binary padding, to approximately 400 MB, likely in order to evade detection and automated processing.</p>
<p>Most recent Ousaban variants contain a string table to hold their strings, storing this table in their <span style="font-family: courier new, courier, monospace;">.rsrc</span> sections. One of the resources contains a zlib-compressed list of strings delimited by newline characters.</p>
<p>Its backdoor capabilities are very similar to a typical Latin American banking trojan – simulating mouse and keyboard actions and logging keystrokes. The latest variants communicate with C&amp;C servers using <a href="https://rtc.teppi.net/" target="_blank" rel="noopener">RealThinClient</a> – a protocol also used by <a href="https://www.welivesecurity.com/2020/04/28/grandoreiro-how-engorged-can-exe-get/" target="_blank" rel="noopener">Grandoreiro</a>.</p>
<p>The typical Latin American banking trojan attacks users of financial institutions using overlay windows crafted specifically for its targets and Ousaban is no exception. Interestingly though, its targets include several email services that it has overlay windows ready for as well, as illustrated in Figure 2.</p>
<div id="attachment_150315" style="width: 638px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_02_UolMail.png"><img class="wp-image-150315 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_02_UolMail.png" alt="" width="628" height="399" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_02_UolMail.png 628w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_02_UolMail-300x191.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_02_UolMail-65x42.png 65w" sizes="(max-width: 628px) 100vw, 628px" /></a><p class="wp-caption-text"><em>Figure 2. Overlay window design for the UOL email service</em></p></div>
<p>To achieve persistence, Ousaban either creates a LNK file or a simple VBS loader in the startup folder, or it modifies the Windows registry Run key.</p>
<h2>Distribution and execution</h2>
<p>Ousaban is distributed mainly through phishing emails (such as the one in Figure 3). The threat actor behind Ousaban cycles through multiple distribution chains. These chains share some common characteristics, mainly:</p>
<ul>
<li>DLL side-loading is used to execute a binary payload</li>
<li>CAB archives are sometimes used instead of ZIP</li>
<li>A configuration file distributed inside an archive with one stage is required by the next stage</li>
<li>An injector, unique to Ousaban, may be used</li>
</ul>
<div id="attachment_150316" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_03_Email.png"><img class="wp-image-150316" src="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_03_Email-300x160.png" alt="" width="700" height="374" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_03_Email-300x160.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_03_Email-768x410.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_03_Email-1024x547.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_03_Email.png 1600w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 3. Recent spam email distributing Ousaban (a rough translation is provided on the right)</em></p></div>
<h3>MSI with JavaScript</h3>
<p>This distribution chain, illustrated in Figure 4, is quite straightforward. The victim is misled into executing an MSI attached to the phishing email. When executed, the MSI launches an embedded JavaScript downloader that downloads a ZIP archive and extracts its contents. It then executes the legitimate application, which side-loads the Ousaban banking trojan.</p>
<div id="attachment_150317" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_04_Chain1.png"><img class="wp-image-150317" src="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_04_Chain1-300x131.png" alt="" width="700" height="306" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_04_Chain1-300x131.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_04_Chain1-768x335.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_04_Chain1-1024x447.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_04_Chain1.png 1500w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 4. Simple Ousaban distribution chain</em></p></div>
<h3>Multistage MSI</h3>
<p>Recently, ESET has observed a <a href="https://twitter.com/ESETresearch/status/1376490532445294594" target="_blank" rel="noopener">new distribution chain</a> spreading Ousaban massively. It is much more complicated than the one described above. The whole process is illustrated in Figure 5.</p>
<p>The first two stages are almost identical. In both, the core of the stage is contained in an archive (ZIP or CAB) and contains:</p>
<ul>
<li>A legitimate application</li>
<li>An encrypted injector</li>
<li>An encrypted downloader</li>
<li>An encrypted configuration file</li>
<li>Legitimate files</li>
</ul>
<p>The legitimate application, when executed, side-loads the injector. The injector locates, decrypts and executes the downloader. The downloader decrypts the configuration file to obtain a URL leading to a remote configuration. The remote configuration contains a URL leading to the next stage archive. The downloader downloads the next stage archive, extracts its contents and executes the legitimate application.</p>
<p>The final stage is slightly different, as it decrypts and executes the actual Ousaban banking trojan instead of a downloader. The third configuration file leads to a remote configuration with C&amp;C server IP address and port. The archive with the last stage contains one more malware-related file – a support module that alters various settings of the victim’s machine. Finally, the archives for all three stages include additional files – a single legitimate executable in the first-stage archive, 14 legitimate files in the second-stage archive, and 13 legitimate files in the third-stage archive plus an embedded archive containing a further 102 legitimate files.</p>
<div id="attachment_150318" style="width: 705px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_05_Chain2.png"><img class="wp-image-150318 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_05_Chain2.png" alt="" width="695" height="1500" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_05_Chain2.png 695w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_05_Chain2-139x300.png 139w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_05_Chain2-474x1024.png 474w" sizes="(max-width: 695px) 100vw, 695px" /></a><p class="wp-caption-text"><em>Figure 5. Ousaban&#8217;s complex distribution chain</em></p></div>
<h4><strong>Support module</strong></h4>
<p>Ousaban loads this module to make it easier for the threat actor to connect to the victim’s machine. It mainly:</p>
<ul>
<li>Modifies the RDP settings to use <a href="https://github.com/stascorp/rdpwrap" target="_blank" rel="noopener">RDPWrap</a>, a utility to allow multiple RDP connections to Home editions of the Windows OS</li>
<li>Modifies firewall settings to allow all RDP connections</li>
<li>Creates a new account with administrative privileges</li>
</ul>
<p>The module contains the RDPWrap binaries stored in its <span style="font-family: courier new, courier, monospace;">.rsrc</span> section. It then changes the RDP settings directly in the Windows registry at:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">HKLM\SYSTEM\CurrentControlSet\Services\TermService\</span></li>
<li><span style="font-family: courier new, courier, monospace;">HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\</span></li>
</ul>
<p>The module then uses <span style="font-family: courier new, courier, monospace;">netsh.exe</span> to modify the Windows firewall to allow all TCP and UDP traffic directed to port 3389, the standard port for RDP. Finally, it creates a new account <span style="font-family: courier new, courier, monospace;">Administrat0r</span> with administrative privileges. We hypothesize that the threat actor wants to have a second way to access the victim’s machine; the threat actor is then not limited by the capabilities of the Ousaban banking trojan and can perform any malicious activity.</p>
<h2>Cryptography</h2>
<p>Ousaban utilizes three cryptographic schemes overall. Its strings are encrypted with an algorithm used by the vast majority of Latin American banking trojans we have analyzed (we have previously described it in detail <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">here</a>). All communications between Ousaban and its C&amp;C server are encrypted using the standard AES cipher with a hardcoded key.</p>
<p>The final algorithm is used in the previously mentioned injector specific to this family. We provide a Python implementation in Figure 6.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-60926a8e51c85143004627" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-mac print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
def decrypt(data, key):
	data_dec = str()
	key_len = len(key)
	for i, c in enumerate(data):
		if i % 2 != 0:
			data_dec += chr(key[i % key_len ^ c ^ ((key_len - (i &amp; key_len)) &amp; 0xFF)])
		else
			data_dec += chr(key[i % key_len] ^ c ^ (i &amp; 0xFF))

	return data_dec</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-60926a8e51c85143004627-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-60926a8e51c85143004627-2">2</div><div class="crayon-num" data-line="crayon-60926a8e51c85143004627-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-60926a8e51c85143004627-4">4</div><div class="crayon-num" data-line="crayon-60926a8e51c85143004627-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-60926a8e51c85143004627-6">6</div><div class="crayon-num" data-line="crayon-60926a8e51c85143004627-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-60926a8e51c85143004627-8">8</div><div class="crayon-num" data-line="crayon-60926a8e51c85143004627-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-60926a8e51c85143004627-10">10</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-60926a8e51c85143004627-1"><span class="crayon-r">def</span><span class="crayon-h"> </span><span class="crayon-e">decrypt</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60926a8e51c85143004627-2"><span class="crayon-h">	</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">str</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60926a8e51c85143004627-3"><span class="crayon-h">	</span><span class="crayon-v">key_len</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-60926a8e51c85143004627-4"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-60926a8e51c85143004627-5"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-h"> </span><span class="crayon-o">!=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-60926a8e51c85143004627-6"><span class="crayon-h">			</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-k ">chr</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">key_len</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">(</span><span class="crayon-v">key_len</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-v">key_len</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-sy">)</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60926a8e51c85143004627-7"><span class="crayon-h">		</span><span class="crayon-st">else</span></div><div class="crayon-line crayon-striped-line" id="crayon-60926a8e51c85143004627-8"><span class="crayon-h">			</span><span class="crayon-v">data_dec</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-k ">chr</span><span class="crayon-sy">(</span><span class="crayon-v">key</span><span class="crayon-sy">[</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">%</span><span class="crayon-h"> </span><span class="crayon-v">key_len</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-v">c</span><span class="crayon-h"> </span><span class="crayon-o">^</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-60926a8e51c85143004627-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-60926a8e51c85143004627-10"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">data_dec</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0005 seconds] -->
<p><em>Figure 6. Algorithm used by Ousaban’s injector to decrypt its payloads</em></p>
<h2>Remote configuration</h2>
<p>Ousaban relies on remote configuration to obtain its next stage URLs and the C&amp;C address and port to use. Ousaban used to store its remote configuration on YouTube, similar to Casbaneiro, but lately it has started using Google Docs instead.</p>
<p>The remote configuration is in JSON format with the values being encrypted by the same algorithm used for strings, but with a different key. The fields have the following meaning:</p>
<ul>
<li>host = C&amp;C domain</li>
<li>link = next stage URL</li>
<li>porta = C&amp;C port or 0 (the default HTTP port 80 is then used)</li>
<li>vers = Ousaban version</li>
</ul>
<p>Examples of the remote configuration are provided in Figure 7 and Figure 8.</p>
<div id="attachment_150319" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_07_ConfigYouTube.png"><img class="wp-image-150319" src="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_07_ConfigYouTube-300x92.png" alt="" width="700" height="216" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_07_ConfigYouTube-300x92.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_07_ConfigYouTube-768x237.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_07_ConfigYouTube-1024x316.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_07_ConfigYouTube-522x160.png 522w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_07_ConfigYouTube.png 1077w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 7. Ousaban remote configuration on YouTube</em></p></div>
<div id="attachment_150320" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_08_ConfigGdocs.png"><img class="wp-image-150320" src="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_08_ConfigGdocs-300x50.png" alt="" width="700" height="116" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_08_ConfigGdocs-300x50.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_08_ConfigGdocs-768x128.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_08_ConfigGdocs-1024x170.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/05/Figure_08_ConfigGdocs.png 1204w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 8. Ousaban remote configuration on Google Docs</em></p></div>
<h2>Similarities with other LATAM banking trojans</h2>
<p>We have already mentioned some similarities between Ousaban and other Latin American banking trojans previously analyzed in this series (like the same string decryption algorithm). During our analysis, we discovered additional links to the other families, mainly:</p>
<ul>
<li>Some Ousaban downloaders contain the same string obfuscation code as <a href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" target="_blank" rel="noopener">Amavaldo</a></li>
<li>Ousaban has been distributed by the same malicious advertisements as <a href="https://www.welivesecurity.com/2019/11/19/mispadu-advertisement-discounted-unhappy-meal/" target="_blank" rel="noopener">Mispadu</a> in the past</li>
<li>The JavaScript files it uses are similar to <a href="https://www.welivesecurity.com/2021/01/21/vadokrist-wolf-sheeps-clothing/" target="_blank" rel="noopener">Vadokrist</a>, <a href="https://www.welivesecurity.com/2020/08/13/mekotio-these-arent-the-security-updates-youre-looking-for/" target="_blank" rel="noopener">Mekotio</a>, <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">Casbaneiro</a> and <a href="https://www.welivesecurity.com/2020/03/05/guildma-devil-drives-electric/" target="_blank" rel="noopener">Guildma</a></li>
<li>The PowerShell files it occasionally uses for distribution (aside from the recent methods described in this blogpost) are similar to <a href="https://www.welivesecurity.com/2019/08/01/banking-trojans-amavaldo/" target="_blank" rel="noopener">Amavaldo</a>, <a href="https://www.welivesecurity.com/2019/10/03/casbaneiro-trojan-dangerous-cooking/" target="_blank" rel="noopener">Casbaneiro</a> and <a href="https://www.welivesecurity.com/2020/08/13/mekotio-these-arent-the-security-updates-youre-looking-for/" target="_blank" rel="noopener">Mekotio</a></li>
</ul>
<p>We analyzed the interestingly close cooperation between these malware families in depth in our <a href="https://www.welivesecurity.com/2020/10/01/latam-financial-cybercrime-competitors-crime-sharing-ttps/" target="_blank" rel="noopener">white paper</a> presented at the Virus Bulletin 2020 conference.</p>
<h2>Conclusion</h2>
<p>In this installment of our series, we looked at Ousaban, a Latin American banking trojan targeting only Brazil. This malware family has been active since at least 2018 and shares typical characteristics of this type of threat – it is written in Delphi, contains backdoor functionality and attacks using overlay windows.</p>
<p>We have covered its most typical features, distribution and execution methods and the structure of its remote configuration. We also discovered several leads that suggest Ousaban is linked to some other Latin American banking trojans.</p>
<p><em>For any inquiries, contact us at threatintel@eset.com. Indicators of Compromise can also be found in <a href="https://github.com/eset/malware-ioc/tree/master/ousaban" target="_blank" rel="noopener">our GitHub repository</a></em><em>.</em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>Hashes</h3>

<table id="tablepress-933" class="tablepress tablepress-id-933">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">C52BC5B0BDFC7D4C60DF60E88835E3145F7FB34F</span></td><td class="column-2">Ousaban banking trojan</td><td class="column-3">Win32/Spy.Ousaban.G</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">D04ACFAF74861DDC3B12E75658863DA65C03013F</span></td><td class="column-2">Ousaban JS downloader</td><td class="column-3">JS/TrojanDownloader.Banload.AAP</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">9A6A4BF3B6E974E367982E5395702AFF8684D500</span></td><td class="column-2">Ousaban JS downloader</td><td class="column-3">JS/TrojanDownloader.Banload.AAP</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">3E8A0B6400F2D02B6B8CD917C279EA1388494182</span></td><td class="column-2">Ousaban MSI downloader</td><td class="column-3">Win32/Spy.Ousaban.W</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">6946BFB8A519FED8EC8C30D9A56619F4E2525BEA</span></td><td class="column-2">Ousaban injector</td><td class="column-3">Win32/Spy.Ousaban.W</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">E5DD2355E85B90D2D648B96C90676604A5C3AE48</span></td><td class="column-2">Ousaban support module</td><td class="column-3">Win32/Spy.Ousaban.AB</td>
</tr>
</tbody>
</table>
<!-- #tablepress-933 from cache -->
<h4>Abused legitimate applications</h4>

<table id="tablepress-934" class="tablepress tablepress-id-934">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Example SHA-1</th><th class="column-2">EXE name</th><th class="column-3">DLL name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">BA5493B08354AEE85151B7BBD15150A1C3F03D1D</span></td><td class="column-2">Avira.SystrayStartTrigger.exe</td><td class="column-3">Avira.OE.NativeCore.dll</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">7F6C820B00FC8C628E2420C388BBB9096A547DAA</span></td><td class="column-2">AudioGrabber.exe</td><td class="column-3">StarBurn.dll</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">C5D5CF1B591C40344B20370C5EE5275356D312EC</span></td><td class="column-2">PlGen.exe</td><td class="column-3">bass_fx.dll</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">53045B8047CED049BBC7EBCB3D3299D2C465E8B9</span></td><td class="column-2">BlazeDVD.exe</td><td class="column-3">SkinScrollBar.dll</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">A6118D354D512DC29965E368F6C78AA3A42A27AD</span></td><td class="column-2">ImageGrabber.exe</td><td class="column-3">StarBurn.dll</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">F9C71277CF05738275261D60A9E938CBA7232E0D</span></td><td class="column-2">nvsmartmaxapp.exe</td><td class="column-3">nvsmartmax.dll</td>
</tr>
</tbody>
</table>
<!-- #tablepress-934 from cache -->
<h3>Recent configuration file URLs</h3>
<p>https://docs.google[.]com/document/d/1o9MlOhxIJq9tMOuUHJiw2eprQ-BGCA_ERnbF54dZ25w/edit<br />
https://docs.google[.]com/document/d/1nQqifeYFsCcI7m-L1Y1oErkp50c-y670nfk7NTKOztg/edit<br />
https://docs.google[.]com/document/d/13A6EBLMOOdvSL3u6IfyrPWbYREXNRVdDTiKzC6ZQx7U/edit<br />
https://docs.google[.]com/document/d/1UiuqrzI_rrtsJQHqeSkp0sexhwU_VSje8AwS-U6KBPk/edit<br />
https://docs.google[.]com/document/d/1VKxF3yKbwQZive-ZPCA4dAU1zOnZutJxY2XZA0YHa3M/edit<br />
https://docs.google[.]com/document/d/19bXTaiFdY5iUqUWXl92Js7i9RoZSLJqcECgpp_4Kda4/edit<br />
https://docs.google[.]com/document/d/1DDDmJzBVcNWhuj8JMRUVb7JlrVZ5kYBugR_INSS96No/edit<br />
https://docs.google[.]com/document/d/1UbfOcHm-T9GCPiitqDRh5TNwZRNJ8_miEpLW-2ypU-I/edit<br />
https://docs.google[.]com/document/d/1d1903AvDBYgOo0Pt9xBBnpCHwSerOpIi4l1b6M4mbT4/edit<br />
https://docs.google[.]com/document/d/1JLuJKoxcd0vRqut8UeBjFJXzMDQ9OiY2ItoVIRq6Gw8/edit<br />
https://docs.google[.]com/document/d/1EOwVDlYPV3gE7PSnLZvuTgUQXvOSN9alyN5aMw7bGeI/edit<br />
https://docs.google[.]com/document/d/18sc6rZjk529iYF2iBTsmuNXvqDqTBSH45DhSZpuLv_U/edit</p>
<h2>MITRE ATT&amp;CK techniques</h2>
<p><em>Note: This table was built using </em><a href="https://attack.mitre.org/resources/versions/"><em>version 8</em></a><em> of the MITRE ATT&amp;CK framework.</em></p>

<table id="tablepress-935" class="tablepress tablepress-id-935">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="2" class="column-1">Resource Development</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1583/001/" rel="noopener" target="_blank">T1583.001</a></td><td class="column-3">Acquire Infrastructure: Domains</td><td class="column-4">Ousaban operators register domains to be used as C&amp;C servers.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1587/001/" rel="noopener" target="_blank">T1587.001</a></td><td class="column-3">Develop Capabilities: Malware</td><td class="column-4">Ousaban is operated by the same group that develops it.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1566/001/" rel="noopener" target="_blank">T1566.001</a></td><td class="column-3">Phishing: Spearphishing Attachment</td><td class="column-4">Ousaban’s initial downloader is most commonly distributed as a spam attachment.</td>
</tr>
<tr class="row-5 odd">
	<td rowspan="4" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1059/001/" rel="noopener" target="_blank">T1059.001</a></td><td class="column-3">Command and Scripting Interpreter: PowerShell</td><td class="column-4">Ousaban uses PowerShell in some distribution chains.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1059/003/" rel="noopener" target="_blank">T1059.003</a></td><td class="column-3">Command and Scripting Interpreter: Windows Command Shell</td><td class="column-4">Ousaban uses the <span style="font-family: courier new, courier, monospace;">cmd.exe</span> to execute the legitimate applications that side-load the main Ousaban payload.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1059/007/" rel="noopener" target="_blank">T1059.007</a></td><td class="column-3">Command and Scripting Interpreter: JavaScript/JScript</td><td class="column-4">Ousaban uses JavaScript in some distribution chains.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1204/002/" rel="noopener" target="_blank">T1204.002</a></td><td class="column-3">User Execution: Malicious File</td><td class="column-4">Ousaban relies on the victim to execute the distributed MSI file.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="2" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1098/" rel="noopener" target="_blank">T1098</a></td><td class="column-3">Account Manipulation</td><td class="column-4">Ousaban registers a new local administrator account on the victim’s machine.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1547/001/" rel="noopener" target="_blank">T1547.001</a></td><td class="column-3">Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</td><td class="column-4">Ousaban achieves persistence using the Run key or startup folder.</td>
</tr>
<tr class="row-11 odd">
	<td rowspan="7" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Ousaban payloads and strings are encrypted.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1574/002/" rel="noopener" target="_blank">T1574.002</a></td><td class="column-3">Hijack Execution Flow: DLL Side-Loading</td><td class="column-4">Ousaban is often executed by this technique.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1562/001/" rel="noopener" target="_blank">T1562.001</a></td><td class="column-3">Impair Defenses: Disable or Modify Tools</td><td class="column-4">Ousaban modifies the RDP settings of the victim’s machine.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1562/004/" rel="noopener" target="_blank">T1562.004</a></td><td class="column-3">Impair Defenses: Disable or Modify System Firewall</td><td class="column-4">Ousaban modifies Windows firewall settings.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1027/001/" rel="noopener" target="_blank">T1027.001</a></td><td class="column-3">Obfuscated Files or Information: Binary Padding</td><td class="column-4">Ousaban frequently uses binary padding.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1027/002/" rel="noopener" target="_blank">T1027.002</a></td><td class="column-3">Obfuscated Files or Information: Software Packing</td><td class="column-4">Ousaban binaries are protected by Themida or Enigma packers.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1218/007/" rel="noopener" target="_blank">T1218.007</a></td><td class="column-3">Signed Binary Proxy Execution: Msiexec</td><td class="column-4">Ousaban uses the MSI format for execution.</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1056/001/" rel="noopener" target="_blank">T1056.001</a></td><td class="column-3">Input Capture: Keylogging</td><td class="column-4">Ousaban can capture keystrokes.</td>
</tr>
<tr class="row-19 odd">
	<td rowspan="4" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1010/" rel="noopener" target="_blank">T1010</a></td><td class="column-3">Application Window Discovery</td><td class="column-4">Ousaban looks for bank- and email-related windows based on their window names and titles.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1518/001/" rel="noopener" target="_blank">T1518.001</a></td><td class="column-3">Software Discovery: Security Software Discovery</td><td class="column-4">Ousaban collects information about the security software installed on the victim’s machine.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">Ousaban collects basic information about the victim’s machine, such as computer name and Windows version.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Ousaban can take screenshots.</td>
</tr>
<tr class="row-23 odd">
	<td rowspan="2" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1132/002/" rel="noopener" target="_blank">T1132.002</a></td><td class="column-3">Data Encoding: Non-Standard Encoding</td><td class="column-4">Ousaban uses RealThinClient that provides non-standard encryption.</td>
</tr>
<tr class="row-24 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1219/" rel="noopener" target="_blank">T1219</a></td><td class="column-3">Remote Access Software</td><td class="column-4">Ousaban installs RDPWrap on the victim’s machine.</td>
</tr>
<tr class="row-25 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v8/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2 Channel</td><td class="column-4">Ousaban exfiltrates data via C&amp;C server.</td>
</tr>
</tbody>
</table>
<!-- #tablepress-935 from cache -->

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/esetresearch/" title="ESET Research">
                    ESET Research                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-05-05 11:30:55">5 May 2021 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    			
		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="//liondigital.us3.list-manage.com/subscribe/post?u=b76f82b1cc198ab1d80665c99&amp;id=102b0810e2" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
					<input type="text" name="email" value="" placeholder="Email...">
					<button>
						Submit					</button>
				</div>
			</form>		
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/04/14/fbi-removes-malware-compromised-exchange-servers/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/fbi-removing-malware-exchange-server-623x415.jpg"
                                                         alt="Ousaban: Private photo collection hidden in a CABinet">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/14/fbi-removes-malware-compromised-exchange-servers/">
                                                    FBI removes web shells from compromised Exchange servers                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/04/08/are-you-afreight-dark-watch-out-vyveva-new-lazarus-backdoor/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/lazarus-vyveva-backdoor-south-africa-623x432.jpg"
                                                         alt="Ousaban: Private photo collection hidden in a CABinet">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/08/are-you-afreight-dark-watch-out-vyveva-new-lazarus-backdoor/">
                                                    (Are you) afreight of the dark? Watch out for Vyveva, new Lazarus backdoor                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybersecurity/" class="category-tag-btn">Cybersecurity</a>                                                <a href="https://www.welivesecurity.com/2021/04/07/supply-chain-attacks-when-trust-goes-wrong-try-hope/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/software-supply-chain-attacks-trust-1-623x432.jpg"
                                                         alt="Ousaban: Private photo collection hidden in a CABinet">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/07/supply-chain-attacks-when-trust-goes-wrong-try-hope/">
                                                    Supply-chain attacks: When trust goes wrong, try hope?                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/04/06/janeleiro-time-traveler-new-old-banking-trojan-brazil/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/04/janeleiro-brazil-malware-banking-trojan-brazil-623x432.jpg"
                                                         alt="Ousaban: Private photo collection hidden in a CABinet">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/04/06/janeleiro-time-traveler-new-old-banking-trojan-brazil/">
                                                    Janeleiro, the time traveler: A new old banking trojan in Brazil                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F05%2F05%2Fousaban-private-photo-collection-hidden-cabinet%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F05%2F05%2Fousaban-private-photo-collection-hidden-cabinet%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F05%2F05%2Fousaban-private-photo-collection-hidden-cabinet%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.1.76.32619db9.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"150190 https:\/\/backend.welivesecurity.com\/?p=150190","disqusShortname":"welivesecurity","disqusTitle":"Ousaban: Private photo collection hidden in a CABinet","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/05\/05\/ousaban-private-photo-collection-hidden-cabinet\/","postId":"150190"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/tablepress/js/jquery.datatables.min.js?ver=1.9.1'></script>
<script type="text/javascript">
jQuery(document).ready(function($){
$('#tablepress-935').dataTable({"order":[],"orderClasses":false,"stripeClasses":["even","odd"],"pagingType":"simple"});
});
</script>    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>