<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/css/main-8633bd3c28.css" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Fernando Tavella',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Bandidos at large: A spying campaign in Latin America | WeLiveSecurity</title>
<meta name="description" content="ESET researchers uncover an active malicious campaign in Latin America that uses new versions of old malware, Bandook, to spy on its victims."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/07/07/bandidos-at-large-spying-campaign-latin-america/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="pt_BR" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Bandidos at large: A spying campaign in Latin America | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers uncover an active malicious campaign in Latin America that uses new versions of old malware, Bandook, to spy on its victims." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/07/07/bandidos-at-large-spying-campaign-latin-america/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2021-07-07T09:30:56+00:00" />
<meta property="article:modified_time" content="2021-07-07T15:32:25+00:00" />
<meta property="og:updated_time" content="2021-07-07T15:32:25+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-malware-latin-america.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-malware-latin-america.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="415" />
<meta property="og:image:alt" content="bandook-bandidos-malware-latin-america" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers uncover an active malicious campaign in Latin America that uses new versions of old malware, Bandook, to spy on its victims." />
<meta name="twitter:title" content="Bandidos at large: A spying campaign in Latin America | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-malware-latin-america.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/br/2021/07/07/bandidos-campanha-de-espionagem-na-america-latina-que-utiliza-o-malware-bandook/" hreflang="pt" />
<link rel="alternate" href="https://www.welivesecurity.com/2021/07/07/bandidos-at-large-spying-campaign-latin-america/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2021/07/07/campana-espionaje-america-latina-utiliza-malware-bandook/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2021/07/07/bandidos-spionagekampagne-in-lateinamerika/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/2021/07/07/bandidos-campanha-de-espionagem-na-america-latina-que-utiliza-o-malware-bandook/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2021/07/07/campana-espionaje-america-latina-utiliza-malware-bandook/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2021/07/07/bandidos-spionagekampagne-in-lateinamerika/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/2021/07/07/bandidos-campanha-de-espionagem-na-america-latina-que-utiliza-o-malware-bandook/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2021/07/07/campana-espionaje-america-latina-utiliza-malware-bandook/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2021/07/07/bandidos-spionagekampagne-in-lateinamerika/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/07/bandidos-latin-america-bandook-malware.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Bandidos at large: A spying campaign in Latin America</h1>
<div class="excerpt">ESET Research uncovers an active malicious campaign that uses new versions of old malware, Bandook, to spy on its victims</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/fernando-tavella/" title="Fernando Tavella">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/07/fernando.jpg" alt="Fernando Tavella">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/fernando-tavella/" title="Fernando Tavella">
                    Fernando Tavella                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mporolli/" title="Matías Porolli">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2015/01/matias_porolli_eset-222x179.jpg" alt="Matías Porolli">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mporolli/" title="Matías Porolli">
                    Matías Porolli                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-07-07 11:30:56">7 Jul 2021 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F07%2F07%2Fbandidos-at-large-spying-campaign-latin-america%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F07%2F07%2Fbandidos-at-large-spying-campaign-latin-america%2F&text=Bandidos at large: A spying campaign in Latin America%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F07%2F07%2Fbandidos-at-large-spying-campaign-latin-america%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET Research uncovers an active malicious campaign that uses new versions of old malware, Bandook, to spy on its victims</p>
                            </div>

                            <p>In 2021 we detected an ongoing campaign targeting corporate networks in Spanish-speaking countries, with 90% of the detections in Venezuela. When comparing the malware used in this campaign with what was previously documented, we found new functionality and changes to this malware, known as Bandook. We also found that this campaign targeting Venezuela, despite being active since at least 2015, has somehow remained undocumented. Given the malware used and the targeted locale, we chose to name this campaign Bandidos.</p>
<p>Bandook is an old remote access trojan: there are references to it being available online as early as 2005, though its use by organized groups was not documented until 2016. The report published that year by EFF, <a href="https://www.eff.org/files/2018/01/29/operation-manul.pdf" target="_blank" rel="noopener">Operation Manul</a>, describes the use of Bandook to target journalists and dissidents in Europe. Then in 2018, Lookout published its research uncovering other espionage campaigns that had different targets but used the same infrastructumre. They gave the name <a href="https://info.lookout.com/rs/051-ESQ-475/images/Lookout_Dark-Caracal_srr_20180118_us_v.1.0.pdf" target="_blank" rel="noopener">Dark Caracal</a> to the group responsible for the attacks. Finally, <a href="https://research.checkpoint.com/2020/bandook-signed-delivered/" target="_blank" rel="noopener">Check Point’s report</a> in 2020 showed that the attackers started to use signed executables to target many verticals in various countries.</p>
<p>Previous reports have mentioned that the developers of Bandook might be developers for hire (also known as “malware as a service”), which makes sense given the various campaigns with different targets seen through the years. We must note, however, that in 2021 we have seen only one active campaign: the one targeting Spanish-speaking countries that we document here.</p>
<p>Although we have seen more than 200 detections for the malware droppers in Venezuela in 2021, we have not identified a specific vertical targeted by this malicious campaign. According to our telemetry data, the main interests of the attackers are corporate networks in Venezuela; some in manufacturing companies, others in construction, healthcare, software services, and even retail. Given the capabilities of the malware and the kind of information that is exfiltrated, it seems like the main purpose of these Bandidos is to spy on their victims. Their targets and their method of approaching them is more similar to cybercrime operations than to APT activities such as Operation Manul.</p>
<h2>Attack overview</h2>
<p>Malicious emails with a PDF attachment are sent to targets. The PDF file contains a link to download a compressed archive and the password to extract it. Inside the archive there is an executable file: a dropper that injects Bandook into an Internet Explorer process. Figure 1 provides an overview of this attack chain.</p>
<div id="attachment_152440" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-1.-Overview-of-a-typical-attack.png"><img class="wp-image-152440" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-1.-Overview-of-a-typical-attack-1024x511.png" alt="Figure 1. Overview of a typical attack" width="800" height="399" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-1.-Overview-of-a-typical-attack-1024x511.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-1.-Overview-of-a-typical-attack-300x150.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-1.-Overview-of-a-typical-attack-768x383.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-1.-Overview-of-a-typical-attack.png 1373w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 1. Overview of a typical attack</em></p></div>
<p>Emails that contain these attachments are usually short; one example is shown in Figure 2. The phone number at the bottom of the message is a mobile number in Venezuela, though it is unlikely to be related to the attackers.</p>
<div id="attachment_152441" style="width: 572px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-2.-Example-of-a-malicious-email.png"><img class="wp-image-152441 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-2.-Example-of-a-malicious-email.png" alt="Figure 2. Example of a malicious email" width="562" height="585" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-2.-Example-of-a-malicious-email.png 562w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-2.-Example-of-a-malicious-email-288x300.png 288w" sizes="(max-width: 562px) 100vw, 562px" /></a><p class="wp-caption-text"><em>Figure 2. Example of a malicious email</em></p></div>
<p>The attackers use URL shorteners such as <a href="https://www.rebrandly.com/" target="_blank" rel="noopener">Rebrandly</a> or <a href="https://bitly.com/" target="_blank" rel="noopener">Bitly</a> in their PDF attachments. The shortened URLs redirect to cloud storage services such as <a href="https://cloud.google.com/storage" target="_blank" rel="noopener">Google Cloud Storage</a>, <a href="https://spideroak.com/one/" target="_blank" rel="noopener">SpiderOak</a>, or <a href="https://www.pcloud.com/" target="_blank" rel="noopener">pCloud</a>, from where the malware is downloaded.</p>
<p>Figure 3 and Figure 4 are examples of PDFs used in this campaign. The images used in the PDFs are stock images available online.</p>
<div id="attachment_152442" style="width: 484px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-3.-Example-of-a-malicious-PDF-file.png"><img class="wp-image-152442" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-3.-Example-of-a-malicious-PDF-file.png" alt="" width="474" height="786" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-3.-Example-of-a-malicious-PDF-file.png 588w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-3.-Example-of-a-malicious-PDF-file-181x300.png 181w" sizes="(max-width: 474px) 100vw, 474px" /></a><p class="wp-caption-text"><em>Figure 3. Example of a malicious PDF file</em></p></div>
<div id="attachment_152443" style="width: 484px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-4.-Another-PDF-file-used-for-social-engineering.png"><img class="wp-image-152443 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-4.-Another-PDF-file-used-for-social-engineering.png" alt="" width="474" height="666" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-4.-Another-PDF-file-used-for-social-engineering.png 474w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-4.-Another-PDF-file-used-for-social-engineering-214x300.png 214w" sizes="(max-width: 474px) 100vw, 474px" /></a><p class="wp-caption-text"><em>Figure 4. Another PDF file used for social engineering</em></p></div>
<p>The content of the PDF files is generic and has been used with various filenames that change between targets. The password for the downloaded archive is <span style="font-family: courier new, courier, monospace;">123456</span>.</p>
<p>For a list of URLs used to download the malware please refer to the section <em>Indicators of Compromise (IoCs)</em>.</p>
<h2>Dropper</h2>
<p>Bandook is hybrid Delphi/C++ malware. The dropper is coded in Delphi and is easily recognizable because it stores the payload encrypted and base64 encoded in the resource section of the file. The main purpose of the dropper is to decode, decrypt and run the payload and to make sure that the malware persists in a compromised system. The encryption algorithm was <a href="https://datatracker.ietf.org/doc/html/rfc2612" target="_blank" rel="noopener">CAST-256</a> in samples from previous years of this campaign, but changed to <a href="https://datatracker.ietf.org/doc/html/rfc5830" target="_blank" rel="noopener">GOST</a> in 2021.</p>
<p>When the dropper is executed, it creates four instances of <span style="font-family: courier new, courier, monospace;">iexplore.exe</span>, where the payload will be injected via process hollowing. Then four entries are created in the Windows registry in <span style="font-family: courier new, courier, monospace;">HKCU\Software\Microsoft\Windows\CurrentVersion</span>. The names of the registry keys are based on the process ID (PID) of each of these newly created processes and the values are base64 encoded and contain the path to the dropper, a number to identify different actions, which will be explained later, and another value that isn’t used in the samples that we analyzed. The created keys are shown in Figure 5, along with an example of a decoded value.</p>
<div id="attachment_152510" style="width: 859px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-5.-Registry-keys-created-by-the-dropper-with-an-example-of-a-stored-value-decoded.png"><img class="wp-image-152510" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-5.-Registry-keys-created-by-the-dropper-with-an-example-of-a-stored-value-decoded.png" alt="" width="849" height="284" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-5.-Registry-keys-created-by-the-dropper-with-an-example-of-a-stored-value-decoded.png 900w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-5.-Registry-keys-created-by-the-dropper-with-an-example-of-a-stored-value-decoded-300x100.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-5.-Registry-keys-created-by-the-dropper-with-an-example-of-a-stored-value-decoded-768x257.png 768w" sizes="(max-width: 849px) 100vw, 849px" /></a><p class="wp-caption-text"><em>Figure 5. Registry keys created by the dropper with an example of a stored value (decoded)</em></p></div>
<p>Samples from other campaigns follow the same logic, but they use other encryption algorithms.</p>
<h2>Payload</h2>
<p>When the payload is injected inside the <span style="font-family: courier new, courier, monospace;">iexplore.exe</span> processes, it will start loading global variables used for various purposes:</p>
<ul>
<li>Names for mutexes</li>
<li>Names for Windows registry keys</li>
<li>URLs used for:
<ul>
<li>C&amp;C communication</li>
<li>Downloading malicious DLLs</li>
<li>Parameters to some DLL functions</li>
</ul>
</li>
<li>Filenames, for example for persistence</li>
<li>Variables used as parameters for some DLL functions</li>
<li>Paths for downloaded files</li>
<li>Payload execution date</li>
</ul>
<p>Once the payload has finished loading the global variables, it will continue its execution obtaining its injected process’s PID. This PID is used to obtain the base64-encoded data created by the dropper, mentioned above. Once the data is retrieved, the payload will decode it and get the <span style="font-family: courier new, courier, monospace;">action identifier</span> (see Figure 5) value from it. This value indicates the action it must perform.</p>
<p>Depending on the obtained value, the payload is capable of performing four different actions.</p>
<p>If the value is <span style="font-family: courier new, courier, monospace;">0</span>:</p>
<ul>
<li>Creates a Windows registry key with the name <span style="font-family: courier new, courier, monospace;">mep</span></li>
<li>Tries to download two DLLs from a URL in the global variables</li>
<li>Tries to load these DLLs into memory</li>
<li>Creates different threads to invoke some of these DLLs’ functions</li>
<li>Starts active communication with the C&amp;C server</li>
</ul>
<p>If the value is <span style="font-family: courier new, courier, monospace;">1</span>:</p>
<ul>
<li>Establishes persistence on the victim’s machine; this will be explained in the <em>Registry and persistence </em>section<em>.<br />
</em></li>
</ul>
<p>If the value is <span style="font-family: courier new, courier, monospace;">2</span>:</p>
<ul>
<li>Creates a Windows registry key with the name <span style="font-family: courier new, courier, monospace;">api</span></li>
<li>Searches for one of the downloaded DLLs, named <span style="font-family: courier new, courier, monospace;">dec.dll</span>; if it exists, loads it into memory and calls the export method <span style="font-family: courier new, courier, monospace;">Init</span>, which creates five folders used for different purposes – for example, save encrypted logs on the Bandook persisted folder mentioned in the <em>Registry and persistence</em> section.</li>
</ul>
<p>If the value is <span style="font-family: courier new, courier, monospace;">3</span>:</p>
<ul>
<li>Creates a registry key with the name <span style="font-family: courier new, courier, monospace;">pim</span></li>
<li>Checks whether persistence succeeded; if not, will establish persistence in the folder mentioned in the <em>Registry and persistence </em>section<em>.<br />
</em></li>
</ul>
<p>Figure 6 depicts a decompilation of this payload-handling code.</p>
<div id="attachment_152475" style="width: 858px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-6.-Payload-logic-to-execute-different-actions-regarding-the-value-obtained-from-the-registry-2.png"><img class="wp-image-152475 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-6.-Payload-logic-to-execute-different-actions-regarding-the-value-obtained-from-the-registry-2.png" alt="" width="848" height="743" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-6.-Payload-logic-to-execute-different-actions-regarding-the-value-obtained-from-the-registry-2.png 848w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-6.-Payload-logic-to-execute-different-actions-regarding-the-value-obtained-from-the-registry-2-300x263.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-6.-Payload-logic-to-execute-different-actions-regarding-the-value-obtained-from-the-registry-2-768x673.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-6.-Payload-logic-to-execute-different-actions-regarding-the-value-obtained-from-the-registry-2-87x77.png 87w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-6.-Payload-logic-to-execute-different-actions-regarding-the-value-obtained-from-the-registry-2-60x53.png 60w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-6.-Payload-logic-to-execute-different-actions-regarding-the-value-obtained-from-the-registry-2-85x75.png 85w" sizes="(max-width: 848px) 100vw, 848px" /></a><p class="wp-caption-text"><em>Figure 6. Payload logic to execute different actions regarding the value obtained from the registry</em></p></div>
<p>Two DLLs can be downloaded from the first action mentioned above or during communication with the C&amp;C server, and they are named <span style="font-family: courier new, courier, monospace;">dec.dll</span> and <span style="font-family: courier new, courier, monospace;">dep.dll</span> (the internal name for the first one is <span style="font-family: courier new, courier, monospace;">capmodule.dll</span>).</p>
<p><span style="font-family: courier new, courier, monospace;">dec.dll</span> has a set of functions that enable spying on the victim’s machine. Some of these functions are capable of dropping a malicious Google Chrome extension, and of stealing information from a USB Drive. Meanwhile, <span style="font-family: courier new, courier, monospace;">dep.dll</span>, which we weren’t able to obtain, has a set of functions that seem to be related to handling files in various formats:</p>
<ul>
<li>MP1</li>
<li>MP3</li>
<li>MP4</li>
<li>MP5</li>
<li>MP6</li>
</ul>
<p>Figure 7 shows part of the decompiled code that loads <span style="font-family: courier new, courier, monospace;">dec.dll</span> into memory. Figure 8 shows the code related to <span style="font-family: courier new, courier, monospace;">dep.dll</span>.</p>
<div id="attachment_152476" style="width: 859px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-7.-Dynamic-load-of-dec.dll-into-memory-2.png"><img class="wp-image-152476 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-7.-Dynamic-load-of-dec.dll-into-memory-2.png" alt="" width="849" height="747" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-7.-Dynamic-load-of-dec.dll-into-memory-2.png 849w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-7.-Dynamic-load-of-dec.dll-into-memory-2-300x264.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-7.-Dynamic-load-of-dec.dll-into-memory-2-768x676.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-7.-Dynamic-load-of-dec.dll-into-memory-2-87x77.png 87w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-7.-Dynamic-load-of-dec.dll-into-memory-2-60x53.png 60w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-7.-Dynamic-load-of-dec.dll-into-memory-2-85x75.png 85w" sizes="(max-width: 849px) 100vw, 849px" /></a><p class="wp-caption-text"><em>Figure 7. Dynamic load of <span style="font-family: courier new, courier, monospace;">dec.dll</span> into memory</em></p></div>
<div id="attachment_152477" style="width: 860px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-8.-Dynamic-load-of-dep.dll-into-memory-2.png"><img class="wp-image-152477 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-8.-Dynamic-load-of-dep.dll-into-memory-2.png" alt="" width="850" height="477" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-8.-Dynamic-load-of-dep.dll-into-memory-2.png 850w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-8.-Dynamic-load-of-dep.dll-into-memory-2-300x168.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-8.-Dynamic-load-of-dep.dll-into-memory-2-768x431.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-8.-Dynamic-load-of-dep.dll-into-memory-2-143x79.png 143w" sizes="(max-width: 850px) 100vw, 850px" /></a><p class="wp-caption-text"><em>Figure 8. Dynamic load of <span style="font-family: courier new, courier, monospace;">dep.dll</span> into memory</em></p></div>
<h3>Registry and persistence</h3>
<p>The payload achieves persistence on the victim’s machine by copying the dropper into a new folder, created by the payload at a path of the form:</p>
<p style="margin-left: 3%; margin-right: 3%;"><span style="font-family: courier new, courier, monospace;"><span style="font-family: courier new, courier, monospace;">%APPDATA%\&lt;RANDOM_STRING&gt;\&lt;RANDOM_STRING&gt;.exe</span></span></p>
<p>Both the persisted dropper and the folder use the same name, which is a random string generated by the payload. The screenshot in Figure 9 shows the registry value created by the payload to maintain persistence.</p>
<div id="attachment_152448" style="width: 977px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-9.-Malware-persistence-in-the-registry.png"><img class="wp-image-152448 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-9.-Malware-persistence-in-the-registry.png" alt="" width="967" height="200" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-9.-Malware-persistence-in-the-registry.png 967w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-9.-Malware-persistence-in-the-registry-300x62.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-9.-Malware-persistence-in-the-registry-768x159.png 768w" sizes="(max-width: 967px) 100vw, 967px" /></a><p class="wp-caption-text"><em>Figure 9. Malware persistence in the registry</em></p></div>
<p>We have also detected other values created by the payload in the Windows registry keys related with its behavior, like: the name used for persistence, a random number used as an ID to identify the victim’s machine, possible filenames (these files can be downloaded by the payload or created by itself), and infection date, among other things.</p>
<p>Table 1 contains the registry entries created by the payload during our analysis, with a brief description of them.</p>
<p><em>Table 1. Registry entries created by one of the analyzed Bandook samples</em></p>

<table id="tablepress-944" class="tablepress tablepress-id-944">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Registry path</th><th class="column-2">Key</th><th class="column-3">Value</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="3" class="column-1"><nobr><span style="font-family: courier new, courier, monospace;">HKCU\Software\</span></nobr></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">der333f</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">Ixaakiiumcicbcpspmof</span></td><td class="column-4">Random string used for persistence</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">FDFfda</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">5/5/2021</span></td><td class="column-4">Compromise date</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">NVhfhfjs</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">&lt;RANDOM_NUMBER&gt;</span></td><td class="column-4">Used to identify the victim’s machine</td>
</tr>
<tr class="row-5 odd">
	<td rowspan="9" class="column-1"><nobr><span style="font-family: courier new, courier, monospace;">HKCU\Software\VBffhdfhf</span></nobr></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">AMMY132</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">&lt;RANDOM_NUMBER&gt;.exe</span></td><td class="column-4">Related to the export method  <span style="font-family: courier new, courier, monospace;">ExecuteAMMMY</span> from  <span style="font-family: courier new, courier, monospace;">dec.dll</span></td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">gn</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">&lt;RANDOM_NUMBER&gt;.exe</span></td><td class="column-4">Related to a new file downloaded during the download of the DLLs, before the connection to the C&amp;C server</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">idate</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">05.05.2021</span></td><td class="column-4">Compromise date</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">mep</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">2608</span></td><td class="column-4">Process ID from the payload used for the communication with the C&amp;C server</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">rno1</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">&lt;RANDOM_NUMBER&gt;.exe</span></td><td class="column-4">Can be used to rename a downloaded file through the C&amp;C communication</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">tvn</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">&lt;RANDOM_NUMBER&gt;.dce</span></td><td class="column-4">Related with the export method  <span style="font-family: courier new, courier, monospace;">ExecuteTVNew</span> from  <span style="font-family: courier new, courier, monospace;">dec.dll</span></td>
</tr>
<tr class="row-11 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">api</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">2716</span></td><td class="column-4">ProcessID from one of the payloads used to install the external DLLs</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">pim</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">2732</span></td><td class="column-4">ProcessID from one of the payloads that checks the malware persistence</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><span style="font-family: courier new, courier, monospace;">DRT3</span></td><td class="column-3"><span style="font-family: courier new, courier, monospace;">1</span></td><td class="column-4">Related with the export name  <span style="font-family: courier new, courier, monospace;">ChromeInject</span>  from  <span style="font-family: courier new, courier, monospace;">dec.dll</span></td>
</tr>
</tbody>
</table>
<!-- #tablepress-944 from cache -->
<p>Other registry locations that can be used to achieve persistence on the victim’s machine are:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">HKCU\Software\Microsoft\Windows NT\CurrentVersion\Windows</span></li>
<li><span style="font-family: courier new, courier, monospace;">HKCU\Software\Microsoft\Windows NT\CurrentVersion\Winlogon</span></li>
</ul>
<h3>Network communication</h3>
<p>The communication begins by obtaining the IP address from a domain (<span style="font-family: courier new, courier, monospace;">d2.ngobmc[.]com</span>) located in the global variables and then establishing a TCP connection to that address with a four-digit port number that changes according to the campaign. Once the payload establishes this connection, it sends basic information from the victim’s machine, like computer name, username, OS version, infection date, and malware version.</p>
<p>After that, the payload will maintain active communication with the C&amp;C server, waiting for commands to execute.</p>
<p>In many cases the information sent to the C&amp;C server is going to be encrypted using the algorithm AES in CFB mode with the key <span style="font-family: courier new, courier, monospace;">HuZ82K83ad392jVBhr2Au383Pud82AuF</span>, but in other cases the information is sent as cleartext.</p>
<p>The following is an example of the basic information to be exfiltrated to the C&amp;C server, before it is encrypted:</p>
<p><nobr></p>
<p style="margin-left: 3%; margin-right: 3%;"><span style="font-family: courier new, courier, monospace;">!O12HYV~!2870~!0.0.0.0~!Computer~!Administrator~!Ten~!0d 14h 2m~!0~!5.2~!FB2021~!0~!0~!0~!0~!~!0~!0&#8211;~!None~!0~!5/5/2021~!</span></p>
<p></nobr></p>
<p>Of particular interest are the fields:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">!O12HYV</span>: Hardcoded value</li>
<li><span style="font-family: courier new, courier, monospace;">2870</span>: Victim’s ID generated by the malware</li>
<li><span style="font-family: courier new, courier, monospace;">0.0.0.0</span>: Victim’s IP address (fake value for privacy reasons)</li>
<li><span style="font-family: courier new, courier, monospace;">Computer</span>: Computer name</li>
<li><span style="font-family: courier new, courier, monospace;">Administrator</span>: Username</li>
<li><span style="font-family: courier new, courier, monospace;">Ten</span>: OS version</li>
<li><span style="font-family: courier new, courier, monospace;">5.2</span>: Malware version</li>
<li><span style="font-family: courier new, courier, monospace;">FB2021</span>: Campaign ID</li>
<li><span style="font-family: courier new, courier, monospace;">5/5/2021</span>: Date of compromise</li>
</ul>
<p>Figure 10 and Figure 11 are Wireshark screenshots displaying two different examples of encrypted and cleartext transmission of information sent to the C&amp;C server.</p>
<div id="attachment_152449" style="width: 696px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-10.-Traffic-capture-with-encrypted-information-sent-to-the-CC-server.png"><img class="wp-image-152449 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-10.-Traffic-capture-with-encrypted-information-sent-to-the-CC-server.png" alt="" width="686" height="402" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-10.-Traffic-capture-with-encrypted-information-sent-to-the-CC-server.png 686w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-10.-Traffic-capture-with-encrypted-information-sent-to-the-CC-server-300x176.png 300w" sizes="(max-width: 686px) 100vw, 686px" /></a><p class="wp-caption-text"><em>Figure 10. Traffic capture with encrypted information sent to the C&amp;C server</em></p></div>
<div id="attachment_152450" style="width: 702px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-11.-Traffic-capture-with-cleartext-information-sent-to-the-CC-server.png"><img class="wp-image-152450 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-11.-Traffic-capture-with-cleartext-information-sent-to-the-CC-server.png" alt="" width="692" height="446" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-11.-Traffic-capture-with-cleartext-information-sent-to-the-CC-server.png 692w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-11.-Traffic-capture-with-cleartext-information-sent-to-the-CC-server-300x193.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-11.-Traffic-capture-with-cleartext-information-sent-to-the-CC-server-65x42.png 65w" sizes="(max-width: 692px) 100vw, 692px" /></a><p class="wp-caption-text"><em>Figure 11. Traffic capture with cleartext information sent to the C&amp;C server</em></p></div>
<p>Regarding the commands that the payload is capable of processing, we found that this sample has 132 commands, although some of these have very similar behaviors. These commands use the following pattern: <span style="font-family: courier new, courier, monospace;">@&lt;ID&gt;</span> – for example, <span style="font-family: courier new, courier, monospace;">@0001</span> – except for the <span style="font-family: courier new, courier, monospace;">*DJDSR^</span> command. Depending on the received command, the payload is capable of performing the following actions:</p>
<ul>
<li>Obtain information from the victim’s drive units:
<ul>
<li>HDD</li>
<li>CD-ROM</li>
<li>USB</li>
</ul>
</li>
<li>Lists the content of a specific directory:
<ul>
<li>Folders</li>
<li>Files</li>
</ul>
</li>
<li>File manipulation:
<ul>
<li>Read</li>
<li>Move</li>
<li>Delete</li>
<li>Rename</li>
</ul>
</li>
<li>Take screenshots</li>
<li>Control the cursor on the victim’s machine:
<ul>
<li>Move it to a specific position</li>
<li>Perform left or right clicks</li>
</ul>
</li>
<li>Install or uninstall the malicious DLLs (<span style="font-family: courier new, courier, monospace;">dec.dll</span> or <span style="font-family: courier new, courier, monospace;">dep.dll</span>)</li>
<li>Close some connections previously opened by the payload</li>
<li>Kill running processes or threads</li>
<li>Pop up a message using <span style="font-family: courier new, courier, monospace;">MessageBoxA</span></li>
<li>Send files to the C&amp;C server</li>
<li>Invoke DLL functions (<span style="font-family: courier new, courier, monospace;">dec.dll</span> or <span style="font-family: courier new, courier, monospace;">dep.dll</span>)</li>
<li>Windows registry manipulation:
<ul>
<li>Check the existence of a registry key or value</li>
<li>Create a registry key or value</li>
<li>Delete a registry key or value</li>
</ul>
</li>
<li>Uninstall the malware</li>
<li>Download a file from a URL</li>
<li>Execute downloaded files using the function <span style="font-family: courier new, courier, monospace;">ShellExecuteW</span></li>
<li>Obtain the victim’s public IP address</li>
<li>Skype program manipulation:
<ul>
<li>Stop the process</li>
<li>Check the existence of the <span style="font-family: courier new, courier, monospace;">main.db</span> file</li>
</ul>
</li>
<li>Stops the <span style="font-family: courier new, courier, monospace;">Teamviewer</span> process and invokes a function from the <span style="font-family: courier new, courier, monospace;">dec.dll</span> named <span style="font-family: courier new, courier, monospace;">ExecuteTVNew</span></li>
<li>Check for <span style="font-family: courier new, courier, monospace;">Java</span> being installed on the victim’s machine</li>
<li>Execute files with extension <span style="font-family: courier new, courier, monospace;">.pyc</span> or <span style="font-family: courier new, courier, monospace;">.jar</span> using Python or Java.</li>
</ul>
<p>Here is a list of what <span style="font-family: courier new, courier, monospace;">dec.dll</span> is capable of doing on the victim’s machine:</p>
<ul>
<li>Chrome browser manipulation</li>
<li>File manipulation:
<ul>
<li>Compress a file</li>
<li>Split a file</li>
<li>Search for a file</li>
<li>Upload a file</li>
</ul>
</li>
<li>Send files to the C&amp;C server</li>
<li>USB manipulation</li>
<li>Get Wi-Fi connections</li>
<li>Start a shell</li>
<li>DDoS</li>
<li>Sign out from Skype</li>
<li>Manipulate the victim’s screen</li>
<li>Manipulate the victim’s webcam</li>
<li>Record sound</li>
<li>Execute malicious programs</li>
</ul>
<h3>DLL analysis – ChromeInject functionality</h3>
<p>When the communication with the C&amp;C server is established, as we mentioned above, the payload downloads <span style="font-family: courier new, courier, monospace;">dec.dll</span>. We conducted an analysis of one of the most interesting exported methods, named <span style="font-family: courier new, courier, monospace;">ChromeInject</span>.</p>
<p>This method creates a malicious Chrome extension, by:</p>
<ul>
<li>Terminating the <span style="font-family: courier new, courier, monospace;">chrome.exe</span> process if it is running</li>
<li>Creating a folder under <span style="font-family: courier new, courier, monospace;">%APPDATA%\OPR\</span></li>
<li>Creating two files:
<ul>
<li><span style="font-family: courier new, courier, monospace;">%APPDATA%\OPR\Main.js</span></li>
<li><span style="font-family: courier new, courier, monospace;">%APPDATA%\OPR\Manifest.json</span></li>
</ul>
</li>
<li>Enabling developer mode of Google Chrome by manipulating the preference file located at:
<ul>
<li><span style="font-family: courier new, courier, monospace;">%LOCALAPPDATA%\Google\Chrome\User Data\Default</span></li>
</ul>
</li>
<li>Obtaining the Google Chrome executable path by accessing the registry, in this case it accesses:
<ul>
<li><span style="font-family: courier new, courier, monospace;">SOFTWARE\Microsoft\Windows\CurrentVersion\App Paths\chrome.exe</span></li>
</ul>
</li>
<li>Launching Google Chrome</li>
<li>Invoking Windows APIs such as <span style="font-family: courier new, courier, monospace;">GetForegroundWindow</span>, <span style="font-family: courier new, courier, monospace;">SetClipboardData</span>, and <span style="font-family: courier new, courier, monospace;">keybd_event</span>, to load a malicious Chrome extension by simulating a user installation, it:
<ul>
<li>Loads <span style="font-family: courier new, courier, monospace;">chrome://extensions</span> into the clipboard and pastes it by sending Ctrl+V keystrokes</li>
<li>Sends Tab keystrokes to select the <span style="font-family: courier new, courier, monospace;">Load unpacked</span> option</li>
<li>Loads the path to the <span style="font-family: courier new, courier, monospace;">OPR</span> folder into the clipboard and pastes it by sending Ctrl+V keystrokes</li>
</ul>
</li>
</ul>
<p>This malicious extension tries to retrieve any credentials that the victim submits to a URL by reading the values inside the <span style="font-family: courier new, courier, monospace;">form</span> tag before they are sent. These credentials are stored in Chrome’s local storage with the key <span style="font-family: courier new, courier, monospace;">batata13</span> and their corresponding URL, where the credentials are sent, with the key <span style="font-family: courier new, courier, monospace;">batata14</span>. This information is exfiltrated to a different URL located in the global variables of the payload. In our sample this URL was:</p>
<p style="margin-left: 3%; margin-right: 3%;"><span style="font-family: courier new, courier, monospace;">https://pronews[.]icu/gtwwfggg/get.php?action=gc1</span></p>
<p>Figure 12 shows the installed malicious Chrome extension.</p>
<div id="attachment_152451" style="width: 665px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-12.-Malicious-extension-created-by-the-malware.png"><img class="wp-image-152451" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-12.-Malicious-extension-created-by-the-malware.png" alt="" width="655" height="461" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-12.-Malicious-extension-created-by-the-malware.png 713w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-12.-Malicious-extension-created-by-the-malware-300x211.png 300w" sizes="(max-width: 655px) 100vw, 655px" /></a><p class="wp-caption-text"><em>Figure 12. Malicious extension created by the malware</em></p></div>
<p>Figure 13 and Figure 14 are screenshots respectively displaying the <span style="font-family: courier new, courier, monospace;">Manifest.json</span> and the <span style="font-family: courier new, courier, monospace;">Main.js</span> (deobfuscated) source code.</p>
<div id="attachment_152452" style="width: 665px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-13.-Manifest-file-of-the-malicious-extension.png"><img class="wp-image-152452 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-13.-Manifest-file-of-the-malicious-extension.png" alt="" width="655" height="272" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-13.-Manifest-file-of-the-malicious-extension.png 655w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-13.-Manifest-file-of-the-malicious-extension-300x125.png 300w" sizes="(max-width: 655px) 100vw, 655px" /></a><p class="wp-caption-text"><em>Figure 13. Manifest file of the malicious extension</em></p></div>
<div id="attachment_152478" style="width: 858px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-14.-Main.js-file-with-malicious-code-deobfuscated-2.jpg"><img class="wp-image-152478 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-14.-Main.js-file-with-malicious-code-deobfuscated-2.jpg" alt="" width="848" height="833" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-14.-Main.js-file-with-malicious-code-deobfuscated-2.jpg 848w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-14.-Main.js-file-with-malicious-code-deobfuscated-2-300x295.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/Figure-14.-Main.js-file-with-malicious-code-deobfuscated-2-768x754.jpg 768w" sizes="(max-width: 848px) 100vw, 848px" /></a><p class="wp-caption-text"><em>Figure 14. <span style="font-family: courier new, courier, monospace;">Main.js</span> file with malicious code deobfuscated</em></p></div>
<h3>Overlaps and differences with other campaigns</h3>
<p>We compared the behavior of our analyzed sample against other posts and documented campaigns like Operation Manul and Dark Caracal and there are some similarities, like:</p>
<ul>
<li>The payloads use the same encryption algorithm for communication with the C&amp;C server, AES in CFB mode.</li>
<li>The encrypted information sent to the C&amp;C server uses the string suffix <span style="font-family: courier new, courier, monospace;">&amp;&amp;&amp;</span> at the end of it.</li>
<li>The payloads use the <span style="font-family: courier new, courier, monospace;">~!</span> suffix string as a delimiter for the information sent or received.</li>
<li>Two samples included in the Operation Manul report (SHA-1: <span style="font-family: courier new, courier, monospace;">ADB7FC1CC9DD76725C1A81C5F17D03DE64F73296</span> and <span style="font-family: courier new, courier, monospace;">916DF5B73B75F03E86C78FC3D19EF5D2DC1B7B92</span>) seem to be connected to the Bandidos campaign, according to our telemetry data. The campaign ID for these samples (<span style="font-family: courier new, courier, monospace;">January 2015 v3</span> and <span style="font-family: courier new, courier, monospace;">JUNE 2015 TEAM</span>) show how far back in time the campaigns go.</li>
<li>All the samples included in Check Point’s report as “Full Version” in fact target Venezuela and are part of the Bandidos campaign.</li>
<li>The dropper uses the process hollowing technique to inject the payloads.</li>
</ul>
<p>We also found some differences, showing changes to the malware over the years, like:</p>
<ul>
<li>The dropper, for this campaign, changed its encryption algorithm from <a href="https://datatracker.ietf.org/doc/html/rfc2612" target="_blank" rel="noopener">CAST-256</a> to <a href="https://datatracker.ietf.org/doc/html/rfc5830" target="_blank" rel="noopener">GOST</a>.</li>
<li>It seems that the malware now has only two DLLs for all its extra functionality instead of the five DLLs mentioned in the Operation Manul report.</li>
<li>Two new export methods have been added to the <span style="font-family: courier new, courier, monospace;">dec.dll</span>, named <span style="font-family: courier new, courier, monospace;">GenerateOfflineDB</span> and <span style="font-family: courier new, courier, monospace;">RECSCREEN</span>.</li>
<li>This latest sample contains 132 commands, instead of the 120 commands mentioned in <a href="https://research.checkpoint.com/2020/bandook-signed-delivered/" target="_blank" rel="noopener">Check Point’s report</a>.</li>
<li>Unlike the smaller executables described in Check Point’s report, which are signed and seem to be part of a different campaign, these samples are unsigned executables.</li>
<li>There is a command with the string <span style="font-family: courier new, courier, monospace;">AVE_MARIA</span>, which could be related to the <a href="https://any.run/malware-trends/avemaria" target="_blank" rel="noopener">AVE MARIA</a> (aka Warzone) RAT.</li>
</ul>
<h2>Conclusion</h2>
<p>Bandook is a RAT active since 2005. Its involvement in different espionage campaigns, already documented, shows us that it is still a relevant tool for cybercriminals. Also, if we consider the modifications made to the malware over the years, it shows us the interest of cybercriminals to keep using this piece of malware in malicious campaigns, making it more sophisticated and more difficult to detect.</p>
<p>Although there are few documented campaigns in Latin America, such as <a href="https://www.welivesecurity.com/2019/08/05/sharpening-machete-cyberespionage/" target="_blank" rel="noopener">Machete</a> or <a href="https://www.welivesecurity.com/2021/01/12/operation-spalax-targeted-malware-attacks-colombia/" target="_blank" rel="noopener">Operation Spalax</a>, Venezuela is a country that, due to its geopolitical situation, is a likely target for cyberespionage.</p>
<p>A full and comprehensive list of Indicators of Compromise (IoCs) and samples can be found in <a href="https://github.com/eset/malware-ioc/tree/master/bandook" target="_blank" rel="noopener">our GitHub repository</a>.</p>
<p><em>For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com.</em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>C&amp;C servers</h3>
<p><span style="font-family: courier new, courier, monospace;">d1.ngobmc[.]com:7891 &#8211; 194.5.250[.]103</span><br />
<span style="font-family: courier new, courier, monospace;">d2.ngobmc[.]com:7892 &#8211; 194.5.250[.]103</span><br />
<span style="font-family: courier new, courier, monospace;">r2.panjo[.]club:7892 &#8211; 45.142.214[.]31</span><br />
<span style="font-family: courier new, courier, monospace;">pronews[.]icu &#8211; 194.36.190[.]73</span><br />
<span style="font-family: courier new, courier, monospace;">ladvsa[.]club &#8211; 45.142.213[.]108</span></p>
<h3>Samples</h3>

<table id="tablepress-945" class="tablepress tablepress-id-945">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">ESET detection name</th><th class="column-3">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">4B8364271848A9B677F2B4C3AF4FE042991D93DF</span></td><td class="column-2">PDF/TrojanDownloader.Agent.AMF</td><td class="column-3">Malicious email</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">F384BDD63D3541C45FAD9D82EF7F36F6C380D4DD</span></td><td class="column-2">PDF/TrojanDownloader.Agent.AMF</td><td class="column-3">Malicious PDF</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">A06665748DF3D4DEF63A4DCBD50917C087F57A27</span></td><td class="column-2">PDF/Phishing.F.Gen</td><td class="column-3">Malicious PDF</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">89F1E932CC37E4515433696E3963BB3163CC4927</span></td><td class="column-2">Win32/Bandok.NAT</td><td class="column-3">Dropper</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">124ABF42098E644D172D9EA69B05AF8EC45D6E49</span></td><td class="column-2">Win32/Bandok.NAT</td><td class="column-3">Dropper</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">AF1F08A0D2E0D40E99FCABA6C1C090B093AC0756</span></td><td class="column-2">Win32/Bandok.NAT</td><td class="column-3">Dropper</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0CB9641A9BF076DBD3BA38369C1C16FCDB104FC2</span></td><td class="column-2">Win32/Bandok.NAT</td><td class="column-3">Payload</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">D32E7178127CE9B217E1335D23FAC3963EA73626</span></td><td class="column-2">Win32/Bandok.NAT</td><td class="column-3">Payload</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">5F58FCED5B53D427B29C1796638808D5D0AE39BE</span></td><td class="column-2">Win32/Bandok.NAT</td><td class="column-3">Payload</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">1F94A8C5F63C0CA3FCCC1235C5ECBD8504343437</span></td><td class="column-2">-</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">dec.dll</span> (encrypted)</td>
</tr>
<tr class="row-12 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">8D2B48D37B2B56C5045BCEE20904BCE991F99272</span></td><td class="column-2">JS/Kryptik.ALB</td><td class="column-3"><span style="font-family: courier new, courier, monospace;">Main.js</span></td>
</tr>
</tbody>
</table>
<!-- #tablepress-945 from cache -->
<h3>Download URLs</h3>
<p><span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/lista-de-precios-2021</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/lista-de-precios-01</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/Lista-de-Precios</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/lista-de-precios-actualizada</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/Lista-de-precio-1-actualizada</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/Lista-de-precios-2-actualizada</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/Precios-Actualizados</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/recibo-de-pago-mes-03</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/Factura-001561493</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/Comunicado_Enero</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/Comunicado-23943983</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/Cotizacion-de-productos</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/informacion_bonos_productividad</span><br />
<span style="font-family: courier new, courier, monospace;">https://rebrand[.]ly/aviso-de-cobro</span><br />
<span style="font-family: courier new, courier, monospace;">https://bit[.]ly/lista-de-precios2</span><br />
<span style="font-family: courier new, courier, monospace;">http://bit[.]ly/2yftKk3</span><br />
<span style="font-family: courier new, courier, monospace;">https://bitly[.]com/v-coti_cion03</span><br />
<nobr><span style="font-family: courier new, courier, monospace;">https://spideroak[.]com/storage/OVPXG4DJMRSXE33BNNPWC5LUN5PTMMZXG4ZTM/shared/1759328-1-1050/Cotizacion nuevas.rar?ad16ce86ca4bb1ff6ff0a7172faf2e05</span></nobr><br />
<nobr><span style="font-family: courier new, courier, monospace;">https://spideroak[.]com/storage/OVPXG4DJMRSXE33BNNPWC5LUN5PTMMRSHA4DA/shared/1744230-1-1028/Lista%20de%20Precios.rar?cd05638af8e76da97e66f1bb77d353eb</span></nobr><br />
<span style="font-family: courier new, courier, monospace;">https://filedn[.]com/lpBkXnHaBUPzXwEpUriDSr4/Lista_de_precios.rar</span><br />
<span style="font-family: courier new, courier, monospace;">https://filedn[.]com/l9nI3nYhBEH5QqSeMUzzhMb/Facturas/Lista_de_Precios.rar</span></p>
<h3>Older C&amp;C servers</h3>
<p><span style="font-family: courier new, courier, monospace;">d1.p2020[.]club:5670</span><br />
<span style="font-family: courier new, courier, monospace;">d2.p2020[.]club:5671</span><br />
<span style="font-family: courier new, courier, monospace;">s1.fikofiko[.]top:5672</span><br />
<span style="font-family: courier new, courier, monospace;">s2.fikofiko[.]top:5673</span><br />
<span style="font-family: courier new, courier, monospace;">s3.fikofiko[.]top:5674</span><br />
<span style="font-family: courier new, courier, monospace;">s1.megawoc[.]com:7891</span><br />
<span style="font-family: courier new, courier, monospace;">s2.megawoc[.]com:7892</span><br />
<span style="font-family: courier new, courier, monospace;">s3.megawoc[.]com:7893</span><br />
<span style="font-family: courier new, courier, monospace;">hellofromtheotherside[.]club:6792</span><br />
<span style="font-family: courier new, courier, monospace;">medialog[.]top:3806</span><br />
<span style="font-family: courier new, courier, monospace;">nahlabahla.hopto[.]org:9005</span><br />
<span style="font-family: courier new, courier, monospace;">dianaojeil.hopto[.]org:8021</span><br />
<span style="font-family: courier new, courier, monospace;">nathashadarin.hopto[.]org:8022</span><br />
<span style="font-family: courier new, courier, monospace;">laraasaker.hopto[.]org:5553</span><br />
<span style="font-family: courier new, courier, monospace;">mayataboush.hopto[.]org:5552</span><br />
<span style="font-family: courier new, courier, monospace;">jhonny1.hopto[.]org:7401</span><br />
<span style="font-family: courier new, courier, monospace;">j2.premiumdns[.]top:7402</span><br />
<span style="font-family: courier new, courier, monospace;">j3.newoneok[.]top:9903</span><br />
<span style="font-family: courier new, courier, monospace;">p2020[.]xyz</span><br />
<span style="font-family: courier new, courier, monospace;">vdsm[.]xyz</span><br />
<span style="font-family: courier new, courier, monospace;">www.blueberry2017[.]com</span><br />
<span style="font-family: courier new, courier, monospace;">www.watermelon2017[.]com</span><br />
<span style="font-family: courier new, courier, monospace;">www.orange2017[.]com</span><br />
<span style="font-family: courier new, courier, monospace;">dbclave[.]info</span><br />
<span style="font-family: courier new, courier, monospace;">panel.newoneok[.]top</span></p>
<h2>MITRE ATT&amp;CK techniques</h2>
<p><em>Note: This table was built using </em><a href="https://attack.mitre.org/resources/versions/" target="_blank" rel="noopener"><em>version 9</em></a><em> of the MITRE ATT&amp;CK framework.</em></p>

<table id="tablepress-947" class="tablepress tablepress-id-947">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1566/001/" rel="noopener" target="_blank">T1566.001</a></td><td class="column-3">Phishing: Spearphishing attachment</td><td class="column-4">Bandook operators have used emails with PDF files attached that contain links to download malware.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="2" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1204/001/" rel="noopener" target="_blank">T1204.001</a></td><td class="column-3">User Execution: Malicious Link</td><td class="column-4">Bandook operators have used malicious links to download malware.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1204/002/" rel="noopener" target="_blank">T1204.002</a></td><td class="column-3">User Execution: Malicious File</td><td class="column-4">Bandook operators have attempted to get victims to execute malicious files.</td>
</tr>
<tr class="row-5 odd">
	<td rowspan="4" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or information</td><td class="column-4">Bandook operators encrypt the payload hidden in the dropper.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1055/012/" rel="noopener" target="_blank">T1055.012</a></td><td class="column-3">Process Injection: Process Hollowing</td><td class="column-4">Bandook operators use process hollowing to inject the payload into legitimate processes.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1112/" rel="noopener" target="_blank">T1112</a></td><td class="column-3">Modify Registry</td><td class="column-4">Bandook operators have attempted to modify registry entries to hide information.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1547/001/" rel="noopener" target="_blank">T1547.001</a></td><td class="column-3">Boot or Logon Autostart Execution: Registry Run keys / Startup Folder</td><td class="column-4">Bandook operators have attempted to create a Run registry key.</td>
</tr>
<tr class="row-9 odd">
	<td rowspan="2" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">Bandook uses Windows API functions to discover running processes on victim’s machines.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">Bandook operators try to discover files or folders from a specific path.</td>
</tr>
<tr class="row-11 odd">
	<td rowspan="5" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1025/" rel="noopener" target="_blank">T1025</a></td><td class="column-3">Data from Removable Media</td><td class="column-4">Bandook operators try to read data from removable media.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1056/001/" rel="noopener" target="_blank">T0156.001</a></td><td class="column-3">Input Capture: Keylogging</td><td class="column-4">Bandook operators may try to capture user keystrokes to obtain credentials.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">Bandook can take screenshots from the victim’s machine.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1123/" rel="noopener" target="_blank">T1123</a></td><td class="column-3">Audio Capture</td><td class="column-4">Bandook can record audio from the victim’s machine.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1125/" rel="noopener" target="_blank">T1125</a></td><td class="column-3">Video Capture</td><td class="column-4">Bandook can record video from the webcam.</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">Command And Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1573/001/" rel="noopener" target="_blank">T1573.001</a></td><td class="column-3">Encrypted Channel: Symmetric Cryptography</td><td class="column-4">Bandook uses AES for encrypting C&amp;C communications.</td>
</tr>
<tr class="row-17 odd">
	<td rowspan="2" class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2 channel</td><td class="column-4">Bandook exfiltrates information over the same channel used for C&amp;C.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1048/002/" rel="noopener" target="_blank">T1048.002</a></td><td class="column-3">Exfiltration Over Alternative Protocol: Exfiltration Over Asymmetric Encrypted Non-C2 Protocol</td><td class="column-4">Bandook exfiltrates information using a malicious URL via HTTPS.</td>
</tr>
</tbody>
</table>
<!-- #tablepress-947 from cache -->
<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=bandidos-at-large-spying-campaign-latin-america" target="_blank" rel="noopener"><img class="aligncenter wp-image-152551" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png" alt="" width="899" height="290" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png 918w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-300x97.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-768x248.png 768w" sizes="(max-width: 899px) 100vw, 899px" /></a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/fernando-tavella/" title="Fernando Tavella">
                    Fernando Tavella                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mporolli/" title="Matías Porolli">
                    Matías Porolli                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-07-07 11:30:56">7 Jul 2021 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/06/eset-research-apt-backdoordiplomacy-quarian-turian-623x415.jpg"
                                                         alt="Bandidos at large: A spying campaign in Latin America">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/">
                                                    BackdoorDiplomacy: Upgrading from Quarian to Turian                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/06/09/gelsemium-when-threat-actors-go-gardening/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/06/gelsemium-apt-eset-research-623x415.jpg"
                                                         alt="Bandidos at large: A spying campaign in Latin America">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/06/09/gelsemium-when-threat-actors-go-gardening/">
                                                    Gelsemium: When threat actors go gardening                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/cybersecurity/" class="category-tag-btn">Cybersecurity</a>                                                <a href="https://www.welivesecurity.com/2021/05/12/eset-research-rsa-conference-2021-presentations/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/05/eset-research-rsa2021-conference-preview-623x415.jpg"
                                                         alt="Bandidos at large: A spying campaign in Latin America">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/05/12/eset-research-rsa-conference-2021-presentations/">
                                                    ESET Research goes to RSA Conference 2021 with two presentations                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/05/ousaban-banking-trojan-brazil-eset-research-623x415.jpg"
                                                         alt="Bandidos at large: A spying campaign in Latin America">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/05/05/ousaban-private-photo-collection-hidden-cabinet/">
                                                    Ousaban: Private photo collection hidden in a CABinet                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F07%2F07%2Fbandidos-at-large-spying-campaign-latin-america%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F07%2F07%2Fbandidos-at-large-spying-campaign-latin-america%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F07%2F07%2Fbandidos-at-large-spying-campaign-latin-america%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/build/js/main-0ba0c3843d.js"></script>
    <!-- Version: v1.2.1.e4f6dcff.pro-azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"152308 https:\/\/backend.welivesecurity.com\/?p=152308","disqusShortname":"welivesecurity","disqusTitle":"Bandidos at large: A spying campaign in Latin America","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/07\/07\/bandidos-at-large-spying-campaign-latin-america\/","postId":"152308"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>