<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=09d01dd87b618f2315ce" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Zuzana Hromcová',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Anatomy of native IIS malware | WeLiveSecurity</title>
<meta name="description" content="ESET researchers publish a white paper and a series of articles putting IIS web server threats targeting governement and e-commerce under the microscope."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Anatomy of native IIS malware | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers publish a white paper and a series of articles putting IIS web server threats targeting governement and e-commerce under the microscope." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2021-08-06T12:59:27+00:00" />
<meta property="article:modified_time" content="2021-08-06T12:54:55+00:00" />
<meta property="og:updated_time" content="2021-08-06T12:54:55+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/07/wls_anatomy-iis-malware-2021_1770540524_1000x667.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/07/wls_anatomy-iis-malware-2021_1770540524_1000x667.jpg" />
<meta property="og:image:width" content="1000" />
<meta property="og:image:height" content="667" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers publish a white paper and a series of articles putting IIS web server threats targeting governement and e-commerce under the microscope." />
<meta name="twitter:title" content="Anatomy of native IIS malware | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/07/wls_anatomy-iis-malware-2021_1770540524_1000x667.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/07/wls_anatomy-iis-malware-2021_1770540524_fhd.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Anatomy of native IIS malware</h1>
<div class="excerpt">ESET researchers publish a white paper putting IIS web server threats under the microscope</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2018/06/zuzana.hromcova@eset.sk_-222x179.jpg" alt="Zuzana Hromcová">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                    Zuzana Hromcová                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/acherepanov/" title="Anton Cherepanov">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/03/Anton_Cherepanov-222x179.jpg" alt="Anton Cherepanov">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/acherepanov/" title="Anton Cherepanov">
                    Anton Cherepanov                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-08-06 14:59:27">6 Aug 2021 - 02:59PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fanatomy-native-iis-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fanatomy-native-iis-malware%2F&text=Anatomy of native IIS malware%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fanatomy-native-iis-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET researchers publish a white paper putting IIS web server threats under the microscope</p>
                            </div>

                            <p>ESET researchers have discovered a set of previously undocumented malware families, implemented as malicious extensions for <em>Internet Information Services</em> (IIS) web server software. Targeting both government mailboxes and e-commerce transactions, as well as aiding in malware distribution, this diverse class of threats operates by eavesdropping on and tampering with the server’s communications.</p>
<p>Along with a complete breakdown of the newly discovered families, our new paper, <em>Anatomy of native IIS malware</em>, provides a comprehensive guide to help fellow security researchers and defenders detect, dissect and mitigate this class of server-side threats. In this blogpost, we summarize the findings of the white paper.</p>
<p>Today, we are also launching a series of blogposts where we introduce the most notable of the newly discovered IIS malware families, as case studies of how this type of malware is used for cybercrime, cyberespionage and SEO fraud. As well as this overview piece, you can read the first of the three installments, <a href="https://www.welivesecurity.com/2021/08/06/iistealer-server-side-threat-ecommerce-transactions/" target="_blank" rel="noopener"><em>IIStealer: A server-side threat to e-commerce transactions</em></a>.</p>
<p>The findings of our IIS malware research were first presented at <a href="https://www.blackhat.com/us-21/briefings/schedule/#anatomy-of-native-iis-malware-23395">Black Hat USA 2021</a> and will also be shared with the community at the <a href="https://vblocalhost.com/presentations/anatomy-of-native-iis-malware/" target="_blank" rel="noopener">Virus Bulletin 2021</a> conference on October 8<sup>th</sup>.</p>
<div class="nwg-promo document clearfix">
            <div class="text">
                <p>
                     <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf" target="_blank">Anatomy of native IIS malware</a>
                </p>
                <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf" class="my-btn document" target="_blank">
                    Download Research Paper
                </a>
            </div>
            <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf" target="_blank" class="no-fancy download">
                <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/pdf-document-big.png" alt="" class="document">
            </a>
        </div>
<p>IIS is Microsoft Windows web server software with an extensible, modular architecture that, since v7.0, supports two types of extensions – <em>native</em> (C++ DLL) and <em>managed</em> (.NET assembly) modules. Focusing on <em>malicious native</em> IIS modules, we have found over 80 unique samples used in the wild and categorized them into 14 malware families – 10 of which were previously undocumented. ESET security solutions detect these families as Win{32,64}/BadIIS and Win{32,64}/Spy.IISniff.</p>
<h2>How IIS malware operates</h2>
<p>IIS malware is a diverse class of threats used for cybercrime, cyberespionage, and SEO fraud – but in all cases, its main purpose is to intercept HTTP requests incoming to the compromised IIS server and affect how the server responds to (some of) these requests.</p>
<p>With the default installation, IIS itself is persistent, so there is no need for extension-based IIS malware to implement additional persistence mechanisms. Once configured as an IIS extension, the malicious IIS module is loaded by the IIS Worker Process (<span style="font-family: 'courier new', courier, monospace;">w3wp.exe</span>), which handles requests sent to the server – this is where IIS malware can interfere with the request processing.</p>
<p>We identified five main modes in which IIS malware operates, as illustrated in Figure 1:</p>
<ul>
<li><em>IIS backdoors</em> allow their operators to remotely control the compromised computer with IIS installed</li>
<li><em>IIS infostealers </em>allow their operators to intercept regular traffic between the compromised server and its legitimate visitors, to steal information such as login credentials and payment information. Using HTTPS doesn’t prevent this attack, as IIS malware can access all data handled by the server – which is where the data is processed in its unencrypted state.</li>
<li><em>IIS injectors</em> modify HTTP responses sent to legitimate visitors to serve malicious content</li>
<li><em>IIS proxies</em> turn the compromised server into an unwitting part of the C&amp;C infrastructure for another malware family, and misuse the IIS server to relay communication between victims of that malware and the real C&amp;C server</li>
<li><em>SEO fraud IIS malware</em> modifies the content served to search engines to manipulate SERP algorithms and boost the ranking for other websites of interest to the attackers</li>
</ul>
<div id="attachment_153431" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Overview-of-IIS-malware-mechanisms.png"><img class="wp-image-153431" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Overview-of-IIS-malware-mechanisms-1024x610.png" alt="Figure 1. Overview of IIS malware mechanisms" width="800" height="476" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Overview-of-IIS-malware-mechanisms-1024x610.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Overview-of-IIS-malware-mechanisms-300x179.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Overview-of-IIS-malware-mechanisms-768x457.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Overview-of-IIS-malware-mechanisms.png 1428w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 1. Overview of IIS malware mechanisms</em></p></div>
<p>All of these malware types are discussed at length in the paper.</p>
<h2>How (and where) it spreads</h2>
<p>Native IIS modules have unrestricted access to any resource available to the server worker process – thus, administrative rights are required to install native IIS malware. This considerably narrows down the options for the initial attack vector. We have seen evidence for two scenarios:</p>
<ul>
<li>IIS malware spreading as a trojanized version of a legitimate IIS module</li>
<li>IIS malware spreading through server exploitation</li>
</ul>
<p>For example, between March and June 2021, we detected a wave of IIS backdoors spread via the Microsoft Exchange pre-authentication RCE vulnerability chain (<a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26855" target="_blank" rel="noopener">CVE-2021-26855</a>, <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26857" target="_blank" rel="noopener">CVE-2021-26857</a>, <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-26858" target="_blank" rel="noopener">CVE-2021-26858</a>, and <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-27065" target="_blank" rel="noopener">CVE-2021-27065</a>), aka ProxyLogon. Targeted specifically were Exchange servers that have <em>Outlook on the web</em> (aka OWA) enabled – as IIS is used to implement OWA, these were a particularly interesting target for espionage.</p>
<p>After our colleagues <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/" target="_blank" rel="noopener">reported</a> the first such case in March 2021, we have detected four more campaigns of various IIS backdoors spreading to Microsoft Exchange servers through the same vulnerability. To complement our telemetry, we have performed internet-wide scans to detect the presence of these backdoors, which allowed us to identify and notify other victims of the malware.</p>
<p>Figure 2 shows the geographical locations of servers affected by these five campaigns, using data from our telemetry and internet-wide scans.</p>
<div id="attachment_153433" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-Victims-of-native-IIS-backdoors-spread-via-the-ProxyLogon-vulnerability-chain.png"><img class="wp-image-153433" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-Victims-of-native-IIS-backdoors-spread-via-the-ProxyLogon-vulnerability-chain-1024x563.png" alt="Figure 2. Victims of native IIS backdoors spread via the ProxyLogon vulnerability chain" width="800" height="439" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-Victims-of-native-IIS-backdoors-spread-via-the-ProxyLogon-vulnerability-chain-1024x563.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-Victims-of-native-IIS-backdoors-spread-via-the-ProxyLogon-vulnerability-chain-300x165.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-Victims-of-native-IIS-backdoors-spread-via-the-ProxyLogon-vulnerability-chain-768x422.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-Victims-of-native-IIS-backdoors-spread-via-the-ProxyLogon-vulnerability-chain-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-Victims-of-native-IIS-backdoors-spread-via-the-ProxyLogon-vulnerability-chain-298x165.png 298w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-Victims-of-native-IIS-backdoors-spread-via-the-ProxyLogon-vulnerability-chain.png 1256w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 2. Victims of native IIS backdoors spread via the ProxyLogon vulnerability chain</em></p></div>
<p>The following entities were among the victims:</p>
<ul>
<li>Government institutions in three countries in Southeast Asia</li>
<li>A major telecommunications company in Cambodia</li>
<li>A research institution in Vietnam</li>
<li>Dozens of private companies in a range of industries, located mostly in Canada, Vietnam and India, and others in the USA, New Zealand, South Korea, and other countries</li>
</ul>
<p>Note that while IIS backdoors may be well-suited for spying on high-profile mailboxes, victims of IIS malware are not limited to compromised servers – all legitimate visitors of the websites hosted by these servers are potential targets, as the malware can be used to steal sensitive data from the visitors (IIS infostealers) or serve malicious content (IIS injectors). Please refer to the full <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf" target="_blank" rel="noopener">white paper</a> for the details on the targets of the other analyzed IIS families.</p>
<h2>The insides of native IIS malware</h2>
<p>From the technical perspective, all types of native IIS malware are implemented as dynamic-link libraries (DLLs), written using the <a href="https://docs.microsoft.com/en-us/iis/web-development-reference/native-code-api-reference/native-code-api-reference" target="_blank" rel="noopener">IIS C++ API</a>. Any such DLL must:</p>
<ul>
<li>Implement a class inherited from either the <a href="https://docs.microsoft.com/en-us/iis/web-development-reference/native-code-api-reference/chttpmodule-class" target="_blank" rel="noopener">CHttpModule</a> or <a href="https://docs.microsoft.com/en-us/iis/web-development-reference/native-code-api-reference/cglobalmodule-class" target="_blank" rel="noopener">CGlobalModule</a> class (or both), and override a number of that class’s methods (<em>event handlers</em>)</li>
<li>Export the <a href="https://docs.microsoft.com/en-us/iis/web-development-reference/native-code-api-reference/pfn-registermodule-function" target="_blank" rel="noopener">RegisterModule</a> function, which is the library entry point, responsible for creating the instances of these classes and registering the implemented handlers for <em>server events</em>, as illustrated in Figure 3.</li>
</ul>
<div id="attachment_153434" style="width: 749px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-A-typical-RegisterModule-function-of-native-IIS-malware.png"><img class="wp-image-153434 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-A-typical-RegisterModule-function-of-native-IIS-malware.png" alt="Figure 3. A typical RegisterModule function of native IIS malware" width="739" height="403" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-A-typical-RegisterModule-function-of-native-IIS-malware.png 739w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-A-typical-RegisterModule-function-of-native-IIS-malware-300x164.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-A-typical-RegisterModule-function-of-native-IIS-malware-143x79.png 143w" sizes="(max-width: 739px) 100vw, 739px" /></a><p class="wp-caption-text"><em>Figure 3. A typical RegisterModule function of native IIS malware</em></p></div>
<p><em>Server events</em> refer to the steps that the IIS server takes during request processing (see Figure 4), but also to other actions taken by the server (for example, sending an HTTP response). These events generate <em>event notifications</em>, which are handled by <em>event handlers</em> implemented in the server’s modules (see Figure 5).</p>
<div id="attachment_153435" style="width: 749px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-HTTP-request-processing-pipeline-in-IIS.png"><img class="wp-image-153435" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-HTTP-request-processing-pipeline-in-IIS-1024x624.png" alt="Figure 4. HTTP request-processing pipeline in IIS" width="739" height="450" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-HTTP-request-processing-pipeline-in-IIS-1024x624.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-HTTP-request-processing-pipeline-in-IIS-300x183.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-HTTP-request-processing-pipeline-in-IIS-768x468.png 768w" sizes="(max-width: 739px) 100vw, 739px" /></a><p class="wp-caption-text"><em>Figure 4. HTTP request-processing pipeline in IIS</em></p></div>
<p>In short, the event handlers (or the methods of IIS module core classes) are where the IIS malware functionality is implemented and where any reverse engineers should focus their analysis. For a deep dive into IIS malware essentials and how to analyze such binaries, refer to the <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf#page=13" target="_blank" rel="noopener"><em>Anatomy of native IIS malware </em></a>section of our white paper.</p>
<div id="attachment_153430" style="width: 749px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-5.-Event-handlers-methods-of-the-module-classes-CHttpModule-and-CGlobalModule.png"><img class="wp-image-153430" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-5.-Event-handlers-methods-of-the-module-classes-CHttpModule-and-CGlobalModule-1024x561.png" alt="" width="739" height="405" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-5.-Event-handlers-methods-of-the-module-classes-CHttpModule-and-CGlobalModule-1024x561.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-5.-Event-handlers-methods-of-the-module-classes-CHttpModule-and-CGlobalModule-300x164.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-5.-Event-handlers-methods-of-the-module-classes-CHttpModule-and-CGlobalModule-768x420.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-5.-Event-handlers-methods-of-the-module-classes-CHttpModule-and-CGlobalModule-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-5.-Event-handlers-methods-of-the-module-classes-CHttpModule-and-CGlobalModule.png 1043w" sizes="(max-width: 739px) 100vw, 739px" /></a><p class="wp-caption-text"><em>Figure 5. Event handlers: methods of the module classes, <span style="font-family: courier new, courier, monospace;">CHttpModule</span> and <span style="font-family: courier new, courier, monospace;">CGlobalModule</span></em></p></div>
<h2>Network communication</h2>
<p>A notable feature of IIS malware is how it communicates with its operators. Malicious IIS modules, especially IIS backdoors, don’t usually create new connections to their C&amp;C servers. They work as <em>passive implants</em>, allowing the attackers to control them by providing some “secret” in an HTTP request sent to the compromised IIS web server. That’s why IIS backdoors usually have a mechanism to recognize <em>attacker requests</em> that are used to control the server and have a predefined structure, such as:</p>
<ul>
<li>URL or request body matching a specific regex</li>
<li>A specific custom HTTP header present</li>
<li>An embedded token (in the URL, request body or one of the headers) matching a hardcoded password</li>
<li>A hash value of an embedded token matching a hardcoded value</li>
<li>A more complex condition – for example, a relationship between all of the above</li>
</ul>
<div id="attachment_153436" style="width: 749px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-6.-Passive-CC-communication-channel-IIS-backdoors.png"><img class="wp-image-153436" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-6.-Passive-CC-communication-channel-IIS-backdoors.png" alt="Figure 6. Passive C&amp;C communication channel (IIS backdoors)" width="739" height="265" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-6.-Passive-CC-communication-channel-IIS-backdoors.png 898w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-6.-Passive-CC-communication-channel-IIS-backdoors-300x108.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-6.-Passive-CC-communication-channel-IIS-backdoors-768x275.png 768w" sizes="(max-width: 739px) 100vw, 739px" /></a><p class="wp-caption-text"><em>Figure 6. Passive C&amp;C communication channel (IIS backdoors)</em></p></div>
<p>On the other hand, some IIS malware categories <em>do</em> implement an alternative C&amp;C channel – using protocols such as HTTP or DNS – to obtain the current configuration on the fly. For example, an IIS injector contacts its C&amp;C server every time there is a new request from a legitimate visitor of the compromised website, and uses the server response to modify the content served to that visitor (such as malicious code or adware).</p>
<div id="attachment_153437" style="width: 749px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-Alternative-CC-communication-mechanism-IIS-injectors.png"><img class="wp-image-153437" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-Alternative-CC-communication-mechanism-IIS-injectors-1024x279.png" alt="Figure 7. Alternative C&amp;C communication mechanism (IIS injectors)" width="739" height="201" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-Alternative-CC-communication-mechanism-IIS-injectors-1024x279.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-Alternative-CC-communication-mechanism-IIS-injectors-300x82.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-Alternative-CC-communication-mechanism-IIS-injectors-768x209.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-Alternative-CC-communication-mechanism-IIS-injectors.png 1566w" sizes="(max-width: 739px) 100vw, 739px" /></a><p class="wp-caption-text"><em>Figure 7. Alternative C&amp;C communication mechanism (IIS injectors)</em></p></div>
<p>Table 1 summarizes how the C&amp;C channels, as well as other notable techniques, are implemented by the 14 analyzed IIS malware families.</p>
<p><em>Table 1. Summary of obfuscations implemented, and functionalities supported by analyzed IIS malware families</em></p>

<table id="tablepress-976" class="tablepress tablepress-id-976">
<tbody class="row-hover">
<tr class="row-1 odd">
	<td rowspan="2" class="column-1"><b>Group&nbsp;#</b></td><td colspan="5" class="column-2"><center><b>Functionality</b></center></td><td colspan="3" class="column-7"><center><b>C&amp;C channel</b></center></td><td rowspan="2" class="column-10"><b>Detection evasion and obfuscation techniques</b></td>
</tr>
<tr class="row-2 even">
	<td class="column-2"><small><b>Backdoor</b></small></td><td class="column-3"><small><b>Infostealer</b></small></td><td class="column-4"><small><b>Proxy</b></small></td><td class="column-5"><small><b>SEO fraud</b></small></td><td class="column-6"><small><b>Injector</b></small></td><td class="column-7"><small><b>Attacker&nbsp;request verification (e.g.&nbsp;specific header present, specific URI, query string parameter)</b></small></td><td class="column-8"><small><b>Encryption/<br>encoding</b></small></td><td class="column-9"><small><b>Alternative channel protocol</b></small></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Group&nbsp;1</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>✅</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>❌</small></td><td class="column-6"><small>❌</small></td><td class="column-7">HTTP header with hardcoded password</td><td class="column-8">base64</td><td class="column-9"><small>❌</small></td><td class="column-10"><small>❌</small></td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Group&nbsp;2</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>❌</small></td><td class="column-6"><small>❌</small></td><td class="column-7">HTTP header with hardcoded password</td><td class="column-8">RSA + AES-CBC</td><td class="column-9"><small>❌</small></td><td class="column-10"><small>❌</small></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Group&nbsp;3</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>❌</small></td><td class="column-6"><small>❌</small></td><td class="column-7">HTTP header present</td><td class="column-8">base64</td><td class="column-9"><small>❌</small></td><td class="column-10"><small>❌</small></td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Group&nbsp;4</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>❌</small></td><td class="column-6"><small>❌</small></td><td class="column-7">HTTP header with hardcoded password</td><td class="column-8">XOR + base64</td><td class="column-9"><small>❌</small></td><td class="column-10">Anti-logging</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Group&nbsp;5</td><td class="column-2"><small>❌</small></td><td class="column-3"><small>✅</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>❌</small></td><td class="column-6"><small>❌</small></td><td class="column-7">URI and HTTP header with hardcoded password</td><td class="column-8"><small>❌</small></td><td class="column-9"><small>❌</small></td><td class="column-10">String stacking</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Group&nbsp;6</td><td class="column-2"><small>❌</small></td><td class="column-3"><small>✅</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>❌</small></td><td class="column-6"><small>❌</small></td><td class="column-7">Query string parameter</td><td class="column-8"><small>❌</small></td><td class="column-9"><small>❌</small></td><td class="column-10"><small>❌</small></td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">Group&nbsp;7</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>❌</small></td><td class="column-6"><small>❌</small></td><td class="column-7">Relationship between HTTP headers, HTTP body format</td><td class="column-8">AES-CBC</td><td class="column-9"><small>❌</small></td><td class="column-10">Anti-logging</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">Group&nbsp;8</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>❌</small></td><td class="column-6"><small>❌</small></td><td class="column-7">HTTP header with hardcoded password</td><td class="column-8"><small>❌</small></td><td class="column-9"><small>❌</small></td><td class="column-10"><small>❌</small></td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">Group&nbsp;9</td><td class="column-2"><small>❌</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>✅</small></td><td class="column-5"><small>✅</small></td><td class="column-6"><small>❌</small></td><td class="column-7">No support for attacker requests</td><td class="column-8"><small>❌</small></td><td class="column-9">HTTP</td><td class="column-10">Encrypted strings (XOR&nbsp;0x56)</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">Group&nbsp;10</td><td class="column-2"><small>❌</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>✅</small></td><td class="column-6"><small>❌</small></td><td class="column-7">No support for attacker requests</td><td class="column-8"><small>❌</small></td><td class="column-9">HTTP to obtain JavaScript config</td><td class="column-10"><small>❌</small></td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">Group&nbsp;11</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>✅</small></td><td class="column-5"><small>✅</small></td><td class="column-6"><small>✅</small></td><td class="column-7">HTTP header with hardcoded password</td><td class="column-8"><small>❌</small></td><td class="column-9">DNS TXT to obtain config, HTTP for C&amp;C</td><td class="column-10">String encryption (ADD 0x02)</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">Group&nbsp;12, variant A</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>✅</small></td><td class="column-5"><small>✅</small></td><td class="column-6"><small>✅</small></td><td rowspan="2" class="column-7">HTTP header with password whose MD5 hash is hardcoded</td><td class="column-8"><small>❌</small></td><td class="column-9">HTTP</td><td class="column-10">String encryption (ADD 0x01)</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">Group&nbsp;12, variant B</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>✅</small></td><td class="column-6"><small>✅</small></td><td class="column-8"><small>❌</small></td><td class="column-9">HTTP</td><td class="column-10">UPX packing</td>
</tr>
<tr class="row-16 even">
	<td class="column-1">Group&nbsp;12, variant C</td><td class="column-2"><small>❌</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>✅</small></td><td class="column-6"><small>❌</small></td><td class="column-7">No support for attacker requests</td><td class="column-8"><small>❌</small></td><td class="column-9">HTTP</td><td class="column-10">String encryption (XOR 0x0C)</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1">Group&nbsp;13</td><td class="column-2"><small>✅</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>✅</small></td><td class="column-6"><small>❌</small></td><td class="column-7">Query string parameter</td><td class="column-8"><small>❌</small></td><td class="column-9">HTTP</td><td class="column-10"><small>❌</small></td>
</tr>
<tr class="row-18 even">
	<td class="column-1">Group&nbsp;14</td><td class="column-2"><small>❌</small></td><td class="column-3"><small>❌</small></td><td class="column-4"><small>❌</small></td><td class="column-5"><small>✅</small></td><td class="column-6"><small>✅</small></td><td class="column-7">No support for attacker requests</td><td class="column-8"><small>❌</small></td><td class="column-9">HTTP</td><td class="column-10"><small>❌</small></td>
</tr>
</tbody>
</table>

<h2>Mitigation</h2>
<p>Since native IIS modules can only be installed with administrative privileges, the attackers first need to obtain elevated access to the IIS server. The following recommendations could help make their work harder:</p>
<ul>
<li>Use dedicated accounts with strong, unique passwords for the administration of the IIS server. Require multifactor authentication (MFA) for these accounts. Monitor the usage of these accounts.</li>
<li>Regularly patch your OS, and carefully consider which services are exposed to the internet, to reduce the risk of server exploitation.</li>
<li>Consider using a web application firewall, and/or endpoint security solution on your IIS server.</li>
<li>Native IIS modules have unrestricted access to any resource available to the server worker process; you should only install native IIS modules from trusted sources to avoid downloading their trojanized versions. Be especially aware of modules promising too-good-to-be-true features such as magically improving SEO.</li>
<li>Regularly check the IIS server configuration to verify that all the installed native modules are legitimate (signed by a trusted provider, or installed on purpose).</li>
</ul>
<p>For details on how to detect and remove IIS malware, refer to the <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf#page=32" target="_blank" rel="noopener">Mitigation</a> section of the white paper. We are also publishing a set of <a href="https://github.com/eset/malware-ioc/tree/master/badiis" target="_blank" rel="noopener">YARA rules</a> that you can leverage to detect all the 14 analyzed IIS malware families.</p>
<h2>Conclusion</h2>
<p>Internet Information Services web servers have been targeted by various malicious actors, for cybercrime and cyberespionage alike. The software’s modular architecture, designed to provide extensibility for web developers, can be a useful tool for attackers to become a part of the IIS server, and intercept or modify its traffic.</p>
<p>It is still quite rare for endpoint (and other) security software to run on IIS servers, which makes it easy for attackers to operate unnoticed for long periods of time. This should be disturbing for all serious web portals that want to protect their visitors’ data, including authentication and payment information. Organizations that use OWA should also pay attention, as it depends on IIS and could be an interesting target for espionage.</p>
<p>While IIS server threats are not limited to native IIS malware, we believe this paper will be a helpful starting point for defenders for understanding, identifying, and removing IIS threats, and a guide to our fellow researchers to reverse engineer this class of threats and understand their common tactics, techniques and procedures.</p>
<p><em>Additional technical details on the malware and Indicators of Compromise can be found in our comprehensive white paper, and on </em><a href="https://github.com/eset/malware-ioc/tree/master/badiis" target="_blank" rel="noopener"><em>GitHub</em></a><em>. For any inquiries, or to make sample submissions related to the subject, contact us at: </em><a href="mailto:threatintel@eset.com"><em>threatintel@eset.com</em></a><em>.</em></p>
<p><em>Acknowledgements to fellow ESET malware researchers <a href="https://www.welivesecurity.com/author/marc-etienne/" target="_blank" rel="noopener">Marc-Étienne Léveillé</a> and <a href="https://www.welivesecurity.com/author/mtartare/" target="_blank" rel="noopener">Mathieu Tartare</a> for their work on this investigation.</em></p>
<div class="update-block"> <strong><em>Read next:</em></strong><br />
<em><a href="https://www.welivesecurity.com/2021/08/06/iistealer-server-side-threat-ecommerce-transactions/" target="_blank" rel="noopener">IIStealer: A server‑side threat to e‑commerce transactions</a></em> </div>
<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=anatomy-native-iis-malware" target="_blank" rel="noopener"><img class="aligncenter wp-image-152551" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png" alt="" width="899" height="290" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png 918w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-300x97.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-768x248.png 768w" sizes="(max-width: 899px) 100vw, 899px" /></a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                    Zuzana Hromcová                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/acherepanov/" title="Anton Cherepanov">
                    Anton Cherepanov                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-08-06 14:59:27">6 Aug 2021 - 02:59PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/07/20/url-shortener-services-android-malware-banking-sms-trojans/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Android-URL-shortener-1-623x432.jpg"
                                                         alt="Anatomy of native IIS malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/07/20/url-shortener-services-android-malware-banking-sms-trojans/">
                                                    Some URL shortener services distribute Android malware, including banking or SMS trojans                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/07/07/bandidos-at-large-spying-campaign-latin-america/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-malware-latin-america-623x415.jpg"
                                                         alt="Anatomy of native IIS malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/07/07/bandidos-at-large-spying-campaign-latin-america/">
                                                    Bandidos at large: A spying campaign in Latin America                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/06/eset-research-apt-backdoordiplomacy-quarian-turian-623x415.jpg"
                                                         alt="Anatomy of native IIS malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/">
                                                    BackdoorDiplomacy: Upgrading from Quarian to Turian                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/06/09/gelsemium-when-threat-actors-go-gardening/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/06/gelsemium-apt-eset-research-623x415.jpg"
                                                         alt="Anatomy of native IIS malware">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/06/09/gelsemium-when-threat-actors-go-gardening/">
                                                    Gelsemium: When threat actors go gardening                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fanatomy-native-iis-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fanatomy-native-iis-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fanatomy-native-iis-malware%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.4.1.0bbcde.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"151867 https:\/\/backend.welivesecurity.com\/?p=151867","disqusShortname":"welivesecurity","disqusTitle":"Anatomy of native IIS malware","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/08\/06\/anatomy-native-iis-malware\/","postId":"151867"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/tablepress/js/jquery.datatables.min.js?ver=1.9.1'></script>
<script type="text/javascript">
jQuery(document).ready(function($){
$('#tablepress-975').dataTable({"order":[],"orderClasses":false,"stripeClasses":["even","odd"],"pagingType":"simple"});
});
</script>    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
