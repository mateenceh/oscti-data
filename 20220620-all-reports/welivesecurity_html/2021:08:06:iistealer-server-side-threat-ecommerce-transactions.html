<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=09d01dd87b618f2315ce" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Zuzana Hromcová',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>IIStealer: A server&#8209;side threat to e&#8209;commerce transactions | WeLiveSecurity</title>
<meta name="description" content="ESET research looks at IIStealer, a previously undocumented IIS web server threat that intercepts server transactions to steal credit card information."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/08/06/iistealer-server-side-threat-ecommerce-transactions/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="IIStealer: A server&#8209;side threat to e&#8209;commerce transactions | WeLiveSecurity" />
<meta property="og:description" content="ESET research looks at IIStealer, a previously undocumented IIS web server threat that intercepts server transactions to steal credit card information." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/08/06/iistealer-server-side-threat-ecommerce-transactions/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2021-08-06T13:00:23+00:00" />
<meta property="article:modified_time" content="2021-08-06T12:56:35+00:00" />
<meta property="og:updated_time" content="2021-08-06T12:56:35+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/08/iistealer-iis-malware-credit-card-information-theft-1.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/08/iistealer-iis-malware-credit-card-information-theft-1.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="415" />
<meta property="og:image:alt" content="iistealer-iis-malware-credit-card-information-theft" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET research looks at IIStealer, a previously undocumented IIS web server threat that intercepts server transactions to steal credit card information." />
<meta name="twitter:title" content="IIStealer: A server&#8209;side threat to e&#8209;commerce transactions | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/08/iistealer-iis-malware-credit-card-information-theft-1.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/08/iistealer-iis-malware-credit-card-information-theft.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>IIStealer: A server&#8209;side threat to e&#8209;commerce transactions</h1>
<div class="excerpt">The first in our series on IIS threats looks at a malicious IIS extension that intercepts server transactions to steal credit card information</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2018/06/zuzana.hromcova@eset.sk_-222x179.jpg" alt="Zuzana Hromcová">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                    Zuzana Hromcová                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-08-06 15:00:23">6 Aug 2021 - 03:00PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fiistealer-server-side-threat-ecommerce-transactions%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fiistealer-server-side-threat-ecommerce-transactions%2F&text=IIStealer: A server&#8209;side threat to e&#8209;commerce transactions%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fiistealer-server-side-threat-ecommerce-transactions%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>The first in our series on IIS threats looks at a malicious IIS extension that intercepts server transactions to steal credit card information</p>
                            </div>

                            <p>ESET researchers have discovered and analyzed a previously undocumented trojan that steals payment information from e-commerce websites&#8217; customers. The trojan, which we named IIStealer, is detected by ESET security solutions as Win64/BadIIS.</p>
<p><em>This blogpost is the first installment in our series where ESET researchers put IIS web server threats under the microscope. For a comprehensive guide to how to detect, analyze and remove IIS malware, refer to our white paper Anatomy of native IIS malware, where IIStealer is featured as one of the studied families (Group 5).</em></p>
<div class="nwg-promo document clearfix">
            <div class="text">
                <p>
                     <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf" target="_blank">Anatomy of native IIS malware</a>
                </p>
                <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf" class="my-btn document" target="_blank">
                    Download Research Paper
                </a>
            </div>
            <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf" target="_blank" class="no-fancy download">
                <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/pdf-document-big.png" alt="" class="document">
            </a>
        </div>
<h2>Attack overview</h2>
<p>IIStealer is implemented as a malicious extension for <em>Internet Information Services</em> (IIS), Microsoft web server software. Being a part of the server, IIStealer is able to access all the network communication flowing through the server and steal data of interest to the attackers – in this case, payment information from e-commerce transactions.</p>
<p>As illustrated in Figure 1, IIStealer operates by intercepting regular traffic between the compromised server and its clients (the seller and the buyers), targeting HTTP POST requests made to specific URI paths: <nobr><span style="font-family: courier new, courier, monospace;">/checkout/checkout.aspx</span></nobr> or <nobr><span style="font-family: courier new, courier, monospace;">/checkout/Payment.aspx</span></nobr>.</p>
<p>Whenever a legitimate website visitor makes a request to these checkout pages (1), IIStealer logs the HTTP request body into a log file (2), without, in any way, interfering with the HTTP reply generated by the components of the legitimate website (3).</p>
<p>Adversaries can then exfiltrate the collected data by making a special HTTP request to the compromised IIS server: once IIStealer detects a request made to a specific URI (<span style="font-family: courier new, courier, monospace;">/privacy.aspx</span>) with an attacker password included in the <span style="font-family: courier new, courier, monospace;">X-IIS-Data</span> header (4), it embeds the collected data in the HTTP response for that request (5,6).</p>
<div id="attachment_153480" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-IIStealer-collection-and-exfiltration-mechanisms.png"><img class="wp-image-153480" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-IIStealer-collection-and-exfiltration-mechanisms-1024x479.png" alt="Figure 1. IIStealer collection and exfiltration mechanisms" width="800" height="374" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-IIStealer-collection-and-exfiltration-mechanisms-1024x479.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-IIStealer-collection-and-exfiltration-mechanisms-300x140.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-IIStealer-collection-and-exfiltration-mechanisms-768x359.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-IIStealer-collection-and-exfiltration-mechanisms.png 1465w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 1. IIStealer: collection and exfiltration mechanisms</em></p></div>
<p>With these capabilities, IIStealer is able to steal credit card information sent to e-commerce websites that don’t use third-party <a href="https://en.wikipedia.org/wiki/Payment_gateway" target="_blank" rel="noopener">payment gateways</a>. Note that SSL/TLS and encrypted communication channels don’t secure these transactions against IIStealer, as the malware can access all data handled by the server – which is where the credit card information is processed in its unencrypted state.</p>
<p>The samples of this malware that we analyzed seem to be tailored for specific e-commerce websites (with hardcoded checkout page URIs). According to our telemetry, targeted were a small number of IIS servers in the USA, between September 2020 and January 2021, but this is likely affected by our limited visibility into IIS servers – it is still common for administrators to not use any security software on these servers.</p>
<h2>Technical analysis</h2>
<p>IIStealer is implemented as a malicious, native IIS module – a C++ DLL dropped in the <nobr><span style="font-family: courier new, courier, monospace;">%windir%\system32\inetsrv\</span></nobr> folder on the compromised IIS server and configured in the <nobr><span style="font-family: courier new, courier, monospace;">%windir%\system32\inetsrv\config\ApplicationHost.config</span></nobr> file. In some cases, IIStealer is deployed under the name <span style="font-family: courier new, courier, monospace;">dir.dll</span> and, as seen in Figure 2, uses a forged VERSIONINFO resource to mimic a legitimate Windows IIS module called <span style="font-family: courier new, courier, monospace;">dirlist.dll.</span></p>
<div id="attachment_153481" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-IIStealer’s-VERSIONINFO-resource-left-mimics-legitimate-dirlist.dll-module-right.png"><img class="wp-image-153481" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-IIStealer’s-VERSIONINFO-resource-left-mimics-legitimate-dirlist.dll-module-right-1024x306.png" alt="Figure 2. IIStealer’s VERSIONINFO resource (left) mimics legitimate dirlist.dll module (right)" width="800" height="239" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-IIStealer’s-VERSIONINFO-resource-left-mimics-legitimate-dirlist.dll-module-right-1024x306.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-IIStealer’s-VERSIONINFO-resource-left-mimics-legitimate-dirlist.dll-module-right-300x90.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-IIStealer’s-VERSIONINFO-resource-left-mimics-legitimate-dirlist.dll-module-right-768x229.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-IIStealer’s-VERSIONINFO-resource-left-mimics-legitimate-dirlist.dll-module-right.png 1322w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 2. IIStealer’s VERSIONINFO resource (left) mimics legitimate dirlist.dll module (right)</em></p></div>
<p>Because it is an IIS module, IIStealer is loaded automatically by the IIS Worker Process (<span style="font-family: courier new, courier, monospace;">w3wp.exe</span>), which handles the requests sent to the IIS web server – this is how IIStealer achieves persistence, and how it can affect the processing of incoming requests.</p>
<p>We don’t have any information about how the malware is spread, but we know that <a href="https://docs.microsoft.com/en-us/iis/get-started/introduction-to-iis/iis-modules-overview" target="_blank" rel="noopener">administrative privileges are required</a> to install it as a native IIS module, which narrows down the candidates for the initial compromise. A configuration weakness or vulnerability in a web application, or the server itself, are likely culprits.</p>
<p>As for its technical characteristics, IIStealer implements a core class inherited from <a href="https://docs.microsoft.com/en-us/iis/web-development-reference/native-code-api-reference/chttpmodule-class" target="_blank" rel="noopener">CHttpModule</a> (module class) and overrides the <span style="font-family: courier new, courier, monospace;">CHttpModule::OnPostBeginRequest</span> method with its malicious code. As with all native IIS modules, IIStealer exports a function named <a href="https://docs.microsoft.com/en-us/iis/web-development-reference/native-code-api-reference/pfn-registermodule-function" target="_blank" rel="noopener">RegisterModule</a> (see Figure 3), where it instantiates the module class and registers its methods for server events – more specifically, it registers for the<span style="font-family: courier new, courier, monospace;"> RQ_BEGIN_REQUEST</span> <a href="https://docs.microsoft.com/en-us/iis/web-development-reference/native-code-api-reference/request-processing-constants" target="_blank" rel="noopener">post-event notification</a> that is generated every time the server starts processing an inbound HTTP request. As a result, the <span style="font-family: courier new, courier, monospace;">OnPostBeginRequest</span> method is called with each new request, which allows IIStealer to affect the request processing.</p>
<div id="attachment_153482" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-IIStealer’s-RegisterModule-entry-point.png"><img class="wp-image-153482" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-IIStealer’s-RegisterModule-entry-point-1024x550.png" alt="Figure 3. IIStealer’s RegisterModule entry point" width="800" height="430" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-IIStealer’s-RegisterModule-entry-point-1024x550.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-IIStealer’s-RegisterModule-entry-point-300x161.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-IIStealer’s-RegisterModule-entry-point-768x413.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-IIStealer’s-RegisterModule-entry-point.png 1083w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 3. IIStealer’s RegisterModule entry point</em></p></div>
<p>In the <span style="font-family: courier new, courier, monospace;">OnPostBeginRequest</span> handler, IIStealer filters incoming HTTP requests by request URIs. All POST requests made to <span style="font-family: courier new, courier, monospace;">/checkout/checkout.aspx</span> or <span style="font-family: courier new, courier, monospace;">/checkout/Payment.aspx</span> are logged – along with their full HTTP bodies – into a file named <span style="font-family: courier new, courier, monospace;">C:\Windows\Temp\cache.txt</span>. These requests are made by legitimate visitors of the compromised e-commerce websites and can contain sensitive information such as personal details and credit card numbers.</p>
<p>The collected data can be exfiltrated via a specifically crafted HTTP request from the attacker. This request must have an <span style="font-family: courier new, courier, monospace;">X-IIS-Data</span> HTTP header set to a hardcoded, 32-byte alphanumeric password (that we have chosen not to disclose), and must be sent to a URL path specified in the malware sample:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">/privacy.aspx</span></li>
<li><span style="font-family: courier new, courier, monospace;">/checkout/Payment.aspx</span></li>
</ul>
<p>Once the malicious module detects such a request, it uses the <span style="font-family: courier new, courier, monospace;">IHttpResponse::Clear</span> method to delete any HTTP response prepared by the IIS server, and copies the unencrypted contents of the log file into the HTTP response body using the <span style="font-family: courier new, courier, monospace;">IHttpResponse::WriteEntityChunks</span> API function, as seen in Figure 4.</p>
<div id="attachment_153483" style="width: 729px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-IIStealer-replaces-the-HTTP-response-body-with-its-own-data.png"><img class="wp-image-153483 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-IIStealer-replaces-the-HTTP-response-body-with-its-own-data.png" alt="Figure 4. IIStealer replaces the HTTP response body with its own data" width="719" height="773" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-IIStealer-replaces-the-HTTP-response-body-with-its-own-data.png 719w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-IIStealer-replaces-the-HTTP-response-body-with-its-own-data-279x300.png 279w" sizes="(max-width: 719px) 100vw, 719px" /></a><p class="wp-caption-text"><em>Figure 4. IIStealer replaces the HTTP response body with its own data</em></p></div>
<p>This allows the operators of IIStealer to access and exfiltrate the collected data by simply sending a special request to the compromised IIS server – there is no need for the malware to implement additional C&amp;C channels, or embed any C&amp;C server domains in its configuration.</p>
<h2>Mitigation</h2>
<p>IIStealer is a server-side threat that eavesdrops on the communications between a compromised e-commerce website and its customers, with the goal of stealing sensitive payment information – but of course, malicious IIS modules can also target credentials and other information. Even though SSL/TLS is vital in securing the transmission of the data between the client and the server, it doesn’t prevent this attack scenario as IIStealer is a part of the server. This should be disturbing for all serious web portals that want to protect their visitors’ data, including authentication and payment information.</p>
<p>The best way to harden an IIS server against IIStealer and other threats is to:</p>
<ul>
<li>Use dedicated accounts with strong, unique passwords for the administration of the IIS server.</li>
<li>Regularly patch your OS, and carefully consider which services are exposed to the internet, to reduce the risk of server exploitation.</li>
<li>Only install native IIS modules from trusted sources.</li>
<li>Consider using a web application firewall, and/or endpoint security solution on your IIS server.</li>
<li>Regularly check the configuration file <span style="font-family: courier new, courier, monospace;">%windir%\system32\inetsrv\config\ApplicationHost.config</span>, as well as the <span style="font-family: courier new, courier, monospace;">%windir%\system32\inetsrv\</span> and <span style="font-family: courier new, courier, monospace;">%windir%\SysWOW64\inetsrv</span> folders to verify that all the installed native modules are legitimate (signed by a trusted provider, or installed on purpose).</li>
</ul>
<p>For web developers: Even if you don’t have control over the IIS server where your web service is hosted, you can still take steps to reduce the impact on users of your web service in the case of a compromise, especially:</p>
<ul>
<li>Do not send the password itself to the server (not even over SSL/TLS); use a protocol such as <a href="https://en.wikipedia.org/wiki/Secure_Remote_Password_protocol" target="_blank" rel="noopener">Secure Remote Password (SRP)</a> to authenticate users without the need for the unencrypted password to be transmitted to the server, nor data that could be used to reauthenticate. IIS infostealers are a good example of why server-side hashing is not good enough.</li>
<li>Avoid unnecessarily sending sensitive information from the web application; use payment gateways.</li>
<li>If you identify a successful compromise: notify all parties involved in any security breach so they can take quick action.</li>
</ul>
<p>For consumers: from the visitor’s perspective, it is impossible to know whether an IIS server is compromised, but these tips will help you reduce the risk:</p>
<ul>
<li>Be careful about where you enter your credit card number. Consider using payment gateways by trusted third-party providers on e-commerce websites whose reputation is unknown to you: with payment gateways, such websites won’t handle the sensitive payment information.</li>
<li>Keep an eye on your credit statement for small or unusual payments: often small amounts are processed to test whether the cards are valid.</li>
<li>If you spot something unusual, notify your bank immediately.</li>
</ul>
<p><em>Additional technical details on the malware, Indicators of Compromise and YARA rules can be found in our comprehensive <a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/eset_anatomy_native_iis_malware.pdf" target="_blank" rel="noopener">white paper</a>, and on </em><a href="https://github.com/eset/malware-ioc/tree/master/badiis" target="_blank" rel="noopener"><em>GitHub</em></a><em>. For any inquiries, or to make sample submissions related to the subject, contact us at: </em><a href="mailto:threatintel@eset.com"><em>threatintel@eset.com</em></a><em>.</em></p>
<p><em>Stay tuned for the next installments of this series where we cover malicious IIS extensions used for cyberespionage and SEO fraud.</em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>ESET detection names</h3>
<p>Win64/BadIIS.F<br />
Win64/BadIIS.O</p>
<h3>SHA-1</h3>
<p><span style="font-family: courier new, courier, monospace;">706EAB59C20FCC9FBC82C41BF955B5C49C644B38</span><br />
<span style="font-family: courier new, courier, monospace;">7A2FA07A7DC05D50FE8E201A750A3DC7F22D6549</span><br />
<span style="font-family: courier new, courier, monospace;">A1C5E7424E7C4C4C9902A5A1D97F708C6BB2F53A</span></p>
<h3>Filenames and paths</h3>
<p><span style="font-family: courier new, courier, monospace;">dir.dll</span><br />
<span style="font-family: courier new, courier, monospace;">isapicache___.dll</span><br />
<span style="font-family: courier new, courier, monospace;">isapicache_.dll_</span><br />
<span style="font-family: courier new, courier, monospace;">C:\Windows\Temp\cache.txt</span></p>
<h2>Network indicators</h2>
<h3>Targeted URIs</h3>
<p><span style="font-family: courier new, courier, monospace;">/checkout/checkout.aspx</span><br />
<span style="font-family: courier new, courier, monospace;">/checkout/Payment.aspx</span><br />
<span style="font-family: courier new, courier, monospace;">/privacy.aspx</span></p>
<h3>HTTP header</h3>
<p><span style="font-family: courier new, courier, monospace;">X-IIS-Data</span></p>
<h2>MITRE ATT&amp;CK techniques</h2>
<p><em>Note: This table was built using </em><a href="https://attack.mitre.org/resources/versions/"><em>version 9</em></a><em> of the MITRE ATT&amp;CK framework.</em></p>

<table id="tablepress-978" class="tablepress tablepress-id-978">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Resource Development</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1587/001/" rel="noopener" target="_blank">T1587.001</a></td><td class="column-3">Develop Capabilities: Malware</td><td class="column-4">IIStealer is a custom-made malware family.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1569/002/" rel="noopener" target="_blank">T1569.002</a></td><td class="column-3">System Services: Service Execution</td><td class="column-4">IIS server (and by extension, IIStealer) persists as a Windows service.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1546/" rel="noopener" target="_blank">T1546</a></td><td class="column-3">Event Triggered Execution</td><td class="column-4">IIStealer is loaded by IIS Worker Process (<span style="font-family: courier new, courier, monospace;">w3wp.exe</span>) when the IIS server receives an inbound HTTP request.</td>
</tr>
<tr class="row-5 odd">
	<td rowspan="2" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1036/005/" rel="noopener" target="_blank">T1036.005</a></td><td class="column-3">Masquerading: Match Legitimate Name or Location</td><td class="column-4">IIStealer has been deployed under the name <span style="font-family: courier new, courier, monospace;">dir.dll</span>, in an attempt to mimic a legitimate Microsoft IIS module called <span style="font-family: courier new, courier, monospace;">dirlist.dll</span>.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1027/" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">IIStealer uses string stacking in an attempt to avoid some string-based detection.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1056/" rel="noopener" target="_blank">T1056</a></td><td class="column-3">Input Capture</td><td class="column-4">IIStealer intercepts network traffic between the IIS server and its clients to collect sensitive information such as credit card details.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="2" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1119/" rel="noopener" target="_blank">T1119</a></td><td class="column-3">Automated Collection</td><td class="column-4">IIStealer automatically collects information from inbound HTTP requests, such as credit card details.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1074/001/" rel="noopener" target="_blank">T1074.001</a></td><td class="column-3">Data Staged: Local Data Staging</td><td class="column-4">IIStealer uses a local file to stage collected information.</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1071/001/" rel="noopener" target="_blank">T1071.001</a></td><td class="column-3">Application Layer Protocol: Web Protocols</td><td class="column-4">Adversaries send HTTP requests to the compromised IIS server to control IIStealer.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2 Channel</td><td class="column-4">IIStealer uses its C&amp;C channel to exfiltrate collected data: HTTP requests are sent by the adversary to the compromised IIS server.</td>
</tr>
</tbody>
</table>

<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=iistealer-server-side-threat-ecommerce-transactions" target="_blank" rel="noopener"><img class="aligncenter wp-image-152551" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png" alt="" width="899" height="290" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png 918w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-300x97.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-768x248.png 768w" sizes="(max-width: 899px) 100vw, 899px" /></a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/zhromcova/" title="Zuzana Hromcová">
                    Zuzana Hromcová                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-08-06 15:00:23">6 Aug 2021 - 03:00PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/07/wls_anatomy-iis-malware-2021_1770540524_1000x667-623x432.jpg"
                                                         alt="IIStealer: A server&#8209;side threat to e&#8209;commerce transactions">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/">
                                                    Anatomy of native IIS malware                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/07/20/url-shortener-services-android-malware-banking-sms-trojans/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Android-URL-shortener-1-623x432.jpg"
                                                         alt="IIStealer: A server&#8209;side threat to e&#8209;commerce transactions">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/07/20/url-shortener-services-android-malware-banking-sms-trojans/">
                                                    Some URL shortener services distribute Android malware, including banking or SMS trojans                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/07/07/bandidos-at-large-spying-campaign-latin-america/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-malware-latin-america-623x415.jpg"
                                                         alt="IIStealer: A server&#8209;side threat to e&#8209;commerce transactions">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/07/07/bandidos-at-large-spying-campaign-latin-america/">
                                                    Bandidos at large: A spying campaign in Latin America                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/06/eset-research-apt-backdoordiplomacy-quarian-turian-623x415.jpg"
                                                         alt="IIStealer: A server&#8209;side threat to e&#8209;commerce transactions">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/06/10/backdoordiplomacy-upgrading-quarian-turian/">
                                                    BackdoorDiplomacy: Upgrading from Quarian to Turian                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fiistealer-server-side-threat-ecommerce-transactions%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fiistealer-server-side-threat-ecommerce-transactions%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F06%2Fiistealer-server-side-threat-ecommerce-transactions%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.4.1.0bbcde.pro.awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"153413 https:\/\/backend.welivesecurity.com\/?p=153413","disqusShortname":"welivesecurity","disqusTitle":"IIStealer: A server\u2011side threat to e\u2011commerce transactions","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/08\/06\/iistealer-server-side-threat-ecommerce-transactions\/","postId":"153413"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
