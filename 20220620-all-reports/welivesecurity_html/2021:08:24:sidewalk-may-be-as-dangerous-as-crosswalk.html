<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=09d01dd87b618f2315ce" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Thibaut Passilly',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>The SideWalk may be as dangerous as the CROSSWALK | WeLiveSecurity</title>
<meta name="description" content="ESET researchers uncover a new modular backdoor, SideWalk, that an APT group named SparklingGoblin has deployed against a US-based computer retail company."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/08/24/sidewalk-may-be-as-dangerous-as-crosswalk/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="The SideWalk may be as dangerous as the CROSSWALK | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers uncover a new modular backdoor, SideWalk, that an APT group named SparklingGoblin has deployed against a US-based computer retail company." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/08/24/sidewalk-may-be-as-dangerous-as-crosswalk/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2021-08-24T17:59:01+00:00" />
<meta property="article:modified_time" content="2021-08-24T20:08:59+00:00" />
<meta property="og:updated_time" content="2021-08-24T20:08:59+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/08/winnti-group-sidewalk-backdoor-crosswalk-sparklinggoblin.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/08/winnti-group-sidewalk-backdoor-crosswalk-sparklinggoblin.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="415" />
<meta property="og:image:alt" content="winnti-group-sidewalk-backdoor-crosswalk-sparklinggoblin" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers uncover a new modular backdoor, SideWalk, that an APT group named SparklingGoblin has deployed against a US-based computer retail company." />
<meta name="twitter:title" content="The SideWalk may be as dangerous as the CROSSWALK | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/08/winnti-group-sidewalk-backdoor-crosswalk-sparklinggoblin.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-courier-new-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/courier-new.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/08/sidewalk-backdoor-crosswalk-sparklinggoblin-winnti-group.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>The SideWalk may be as dangerous as the CROSSWALK</h1>
<div class="excerpt">Meet SparklingGoblin, a member of the Winnti family</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/tpassilly/" title="Thibaut Passilly">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Thibaut-Passilly-222x179.jpeg" alt="Thibaut Passilly">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/tpassilly/" title="Thibaut Passilly">
                    Thibaut Passilly                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mtartare/" title="Mathieu Tartare">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2019/10/mathieu_t-1-222x179.jpg" alt="Mathieu Tartare">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mtartare/" title="Mathieu Tartare">
                    Mathieu Tartare                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-08-24 19:59:01">24 Aug 2021 - 07:59PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F24%2Fsidewalk-may-be-as-dangerous-as-crosswalk%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F24%2Fsidewalk-may-be-as-dangerous-as-crosswalk%2F&text=The SideWalk may be as dangerous as the CROSSWALK%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F24%2Fsidewalk-may-be-as-dangerous-as-crosswalk%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Meet SparklingGoblin, a member of the Winnti family</p>
                            </div>

                            <p>ESET researchers have recently discovered a new undocumented modular backdoor, SideWalk, being used by an APT group we&#8217;ve named SparklingGoblin; this backdoor was used during one of SparklingGoblin&#8217;s recent campaigns that targeted a computer retail company based in the USA. This backdoor shares multiple similarities with another backdoor used by the group: <a href="https://blogs.vmware.com/security/2019/09/cb-threat-analysis-unit-technical-analysis-of-crosswalk.html" target="_blank" rel="noopener">CROSSWALK</a>.</p>
<p>SideWalk is a modular backdoor that can dynamically load additional modules sent from its C&amp;C server, makes use of Google Docs as a dead drop resolver, and Cloudflare workers as a C&amp;C server. It can also properly handle communication behind a proxy.</p>
<h2>SparklingGoblin, a member of the Winnti family</h2>
<p>In November 2019, we discovered a Winnti Group campaign targeting several Hong Kong universities that had started at the end of October 2019, and we published a <a href="https://www.welivesecurity.com/2020/01/31/winnti-group-targeting-universities-hong-kong/" target="_blank" rel="noopener"><em>blogpost about it</em></a>. During that campaign the attackers mostly made use of the <a href="https://securelist.com/shadowpad-in-corporate-networks/81432/" target="_blank" rel="noopener"><em>ShadowPad backdoor</em></a> and <a href="https://securelist.com/winnti-more-than-just-a-game/37029/" target="_blank" rel="noopener"><em>the Winnti malware</em></a>, but also the <a href="https://st.drweb.com/static/new-www/news/2021/march/BackDoor.Spyder.1_en.pdf" target="_blank" rel="noopener"><em>Spyder backdoor</em></a> and a backdoor based on DarkShell (<a href="http://read.pudn.com/downloads667/sourcecode/hack/trojan/2702901/DarkShell/DarkDll/ReadMe.txt__.htm" target="_blank" rel="noopener"><em>an open source RAT</em></a><em><u>)</u></em> that we named Doraemon.</p>
<p>Subsequent to that campaign, in May 2020 (as documented in <a href="https://www.welivesecurity.com/2020/07/29/eset-threat-report-q22020/" target="_blank" rel="noopener"><em>our Q2 2020 Threat Report</em></a>) we observed a new campaign targeting one of the universities that was previously compromised by Winnti Group in October 2019, where the attackers used the CROSSWALK backdoor and a PlugX variant using Google Docs as a dead drop resolver. Even though that campaign exhibited links to Winnti Group, the modus operandi was quite different, and we started tracking it as a separate threat actor.</p>
<p>Following the Hong Kong university compromise, we observed multiple compromises against organizations around the world using similar toolsets and TTPs. Considering those particular TTPs and to avoid adding to the general confusion around the “Winnti Group” label, we decided to document this cluster of activity as a new group, which we have named SparklingGoblin, and that we believe is connected to Winnti Group while exhibiting some differences.</p>
<h2>Victimology</h2>
<p>Since mid 2020, according to our telemetry, SparklingGoblin has been very active and remains so in 2021. Even though the group targets mostly East and Southeast Asia, we have seen SparklingGoblin targeting a broad range of organizations and verticals around the world, with a particular focus on the academic sector, but including:</p>
<ul>
<li>Academic sectors in Macao, Hong Kong and Taiwan</li>
<li>A religious organization in Taiwan</li>
<li>A computer and electronics manufacturer in Taiwan</li>
<li>Government organizations in Southeast Asia</li>
<li>An e-commerce platform in South Korea</li>
<li>The education sector in Canada</li>
<li>Media companies in India, Bahrain, and the USA</li>
<li>A computer retail company based in the USA</li>
<li>Local government in the country of Georgia</li>
<li>Unidentified organizations in South Korea and Singapore</li>
</ul>
<div id="attachment_154193" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Geographic-distribution-of-SparklingGoblin-targets.png"><img class="wp-image-154193" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Geographic-distribution-of-SparklingGoblin-targets-300x233.png" alt="" width="700" height="543" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Geographic-distribution-of-SparklingGoblin-targets-300x233.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Geographic-distribution-of-SparklingGoblin-targets-768x596.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Geographic-distribution-of-SparklingGoblin-targets-1024x794.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-1.-Geographic-distribution-of-SparklingGoblin-targets.png 1252w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 1. Geographic distribution of SparklingGoblin targets</em></p></div>
<h2>SideWalk</h2>
<p>SideWalk staging is summarized in Figure 2. The SideWalk backdoor is ChaCha20-encrypted shellcode that is loaded from disk by SparklingGoblin’s InstallUtil-based .NET loaders.</p>
<div id="attachment_154195" style="width: 510px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-SideWalk-staging-mechanism.png"><img class="wp-image-154195" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-SideWalk-staging-mechanism-159x300.png" alt="" width="500" height="943" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-SideWalk-staging-mechanism-159x300.png 159w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-SideWalk-staging-mechanism-768x1449.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-SideWalk-staging-mechanism-543x1024.png 543w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-2.-SideWalk-staging-mechanism.png 795w" sizes="(max-width: 500px) 100vw, 500px" /></a><p class="wp-caption-text"><em>Figure 2. SideWalk staging mechanism</em></p></div>
<p>Also, as we will show below, the SideWalk backdoor shares multiple similiarities with CROSSWALK, which is a modular backdoor attributed to <a href="https://content.fireeye.com/apt-41/rpt-apt41/" target="_blank" rel="noopener">APT41 by FireEye</a> and <a href="https://blogs.vmware.com/security/2019/09/cb-threat-analysis-unit-technical-analysis-of-crosswalk.html" target="_blank" rel="noopener">publicly documented by Carbon Black</a>.</p>
<h3>First stage</h3>
<p>SideWalk’s shellcode is deployed encrypted on disk under the name <span style="font-family: courier new, courier, monospace;">Microsoft.WebService.targets</span> and loaded using SparklingGoblin’s InstallUtil-based .NET loader obfuscated with a modified <a href="https://github.com/yck1509/ConfuserEx" target="_blank" rel="noopener">ConfuserEx</a>, an open source protector for .NET applications that is frequently used by the group.</p>
<p>SparklingGoblin’s .NET loaders persist via a scheduled task using one of the following filenames:</p>
<ul>
<li>RasTaskStart</li>
<li>RasTaskManager</li>
<li>WebService</li>
</ul>
<p>It executes the loader using the <a href="https://docs.microsoft.com/en-us/dotnet/framework/tools/installutil-exe-installer-tool" target="_blank" rel="noopener"><em>InstallUtil.exe utility</em></a> using the following command:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-612565b3c5e04999551424" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallUtil.exe /logfile= /LogToConsole=false /ParentProc=none /U C:\Windows\Microsoft.NET\Framework64\v4.0.30319\InstallWebService.sql</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-612565b3c5e04999551424-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-612565b3c5e04999551424-1"><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">.</span><span class="crayon-v">NET</span><span class="crayon-sy">\</span><span class="crayon-v">Framework64</span><span class="crayon-sy">\</span><span class="crayon-v">v4</span><span class="crayon-sy">.</span><span class="crayon-cn">0.30319</span><span class="crayon-sy">\</span><span class="crayon-v">InstallUtil</span><span class="crayon-sy">.</span><span class="crayon-v">exe</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">logfile</span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">LogToConsole</span><span class="crayon-o">=</span><span class="crayon-t">false</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">ParentProc</span><span class="crayon-o">=</span><span class="crayon-v">none</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-i">U</span><span class="crayon-h"> </span><span class="crayon-v">C</span><span class="crayon-o">:</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">.</span><span class="crayon-v">NET</span><span class="crayon-sy">\</span><span class="crayon-v">Framework64</span><span class="crayon-sy">\</span><span class="crayon-v">v4</span><span class="crayon-sy">.</span><span class="crayon-cn">0.30319</span><span class="crayon-sy">\</span><span class="crayon-v">InstallWebService</span><span class="crayon-sy">.</span><span class="crayon-v">sql</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>where <span style="font-family: courier new, courier, monospace;">InstallWebService.sql</span> is the malicious .NET loader. When started with the <span style="font-family: courier new, courier, monospace;">/U</span> flag, as here, the <span style="font-family: courier new, courier, monospace;">Uninstall</span> method from the <span style="font-family: courier new, courier, monospace;">USCInstaller</span> class in the <span style="font-family: courier new, courier, monospace;">UPrivate</span> namespace method of the .NET loader is called (see Figure 3).</p>
<div id="attachment_154196" style="width: 410px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-Hierarchy-of-an-InstallUtil-based-loader.png"><img class="wp-image-154196" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-Hierarchy-of-an-InstallUtil-based-loader.png" alt="Figure 3. Hierarchy of an InstallUtil-based loader" width="400" height="455" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-Hierarchy-of-an-InstallUtil-based-loader.png 329w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-3.-Hierarchy-of-an-InstallUtil-based-loader-264x300.png 264w" sizes="(max-width: 400px) 100vw, 400px" /></a><p class="wp-caption-text"><em>Figure 3. Hierarchy of an InstallUtil-based loader</em></p></div>
<p>A deobfuscated version of the <span style="font-family: courier new, courier, monospace;">RunShellcode</span> method called by the Uninstall method is shown in Figure 4.</p>
<div id="attachment_154197" style="width: 716px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-.NET-loader-method-called-by-the-Uninstall-method-and-that-decrypts-and-injects-the-shellcode..png"><img class="wp-image-154197 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-.NET-loader-method-called-by-the-Uninstall-method-and-that-decrypts-and-injects-the-shellcode..png" alt="" width="706" height="283" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-.NET-loader-method-called-by-the-Uninstall-method-and-that-decrypts-and-injects-the-shellcode..png 706w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-.NET-loader-method-called-by-the-Uninstall-method-and-that-decrypts-and-injects-the-shellcode.-300x120.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-4.-.NET-loader-method-called-by-the-Uninstall-method-and-that-decrypts-and-injects-the-shellcode.-340x137.png 340w" sizes="(max-width: 706px) 100vw, 706px" /></a><p class="wp-caption-text"><em>Figure 4. .NET loader method called by the Uninstall method and that decrypts and injects the shellcode.</em></p></div>
<p>As we can see, the loader is responsible for reading the encrypted shellcode from disk, decrypting it and injecting it into a legitimate process using the <a href="https://attack.mitre.org/techniques/T1055/012/" target="_blank" rel="noopener"><em>process hollowing technique</em></a>. Note that the decryption algorithm used varies across samples.</p>
<p>Additionally, note that SparklingGoblin uses a variety of different shellcode loaders such as the Motnug loader and ChaCha20-based loaders. Motnug is a pretty simple shellcode loader that is frequently used to load the CROSSWALK backdoor, while the ChaCha20-based loaders, as their names suggest, are used to decrypt and load shellcode encrypted with the <a href="https://en.wikipedia.org/wiki/Salsa20#ChaCha_variant" target="_blank" rel="noopener"><em>ChaCha20 algorithm</em></a>. The ChaCha20 implementation used in this loader is the same one used in the SideWalk backdoor described below. This implementation is counter based (CTR mode), using a 12-byte nonce and 32-byte key with a counter value of 11, leading to the following initial state:</p>

<table id="tablepress-991" class="tablepress tablepress-id-991">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Offset</th><th class="column-2">0x00</th><th class="column-3">0x04</th><th class="column-4">0x08</th><th class="column-5">0x12</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">0x00</td><td class="column-2">"expa"</td><td class="column-3">"nd 3"</td><td class="column-4">"2-by"</td><td class="column-5">"te k"</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">0x16</td><td class="column-2">Key </td><td class="column-3">Key </td><td class="column-4">Key </td><td class="column-5">Key </td>
</tr>
<tr class="row-4 even">
	<td class="column-1">0x32</td><td class="column-2">Key </td><td class="column-3">Key </td><td class="column-4">Key </td><td class="column-5">Key </td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">0x48</td><td class="column-2">0x0000000B</td><td class="column-3">Nonce </td><td class="column-4">Nonce </td><td class="column-5">Nonce</td>
</tr>
</tbody>
</table>

<p>The 0x0000000B counter value differs from the usual ChaCha20 implementation, where it’s usually set to 0.</p>
<p>Note that these ChaCha20-based loaders were previously documented in a <a href="https://www.ptsecurity.com/ww-en/analytics/pt-esc-threat-intelligence/higaisa-or-winnti-apt-41-backdoors-old-and-new/" target="_blank" rel="noopener">blogpost from Positive Technologies</a>.</p>
<h3>Initialization</h3>
<p>Similar to CROSSWALK, the SideWalk shellcode uses a main structure to store strings, variables, the Import Address Table (IAT), and its configuration data. This structure is then passed as an argument to all functions that need it. During SideWalk’s initialization, first the strings are decrypted and added to the structure, then the part of the structure responsible for storing the IAT is populated, and finally SideWalk’s configuration is decrypted.</p>
<h3>Data and string pool decryption</h3>
<p>At the very beginning of its execution, the data section at the end of the shellcode is decrypted using an XOR loop and this 16-byte key: <span style="font-family: courier new, courier, monospace;">B0 1D 1E 4B 68 76 FF 2E 49 16 EB 2B 74 4C BB 3A</span>. This section, once decrypted, contains the strings that will be used by SideWalk, including:</p>
<ul>
<li>registry keys</li>
<li>decryption keys</li>
<li>path to write files received from the C&amp;C server</li>
<li>HTTP method to be used</li>
<li>HTTP request parameters</li>
<li>URLs used to retrieve the local proxy configuration</li>
<li>delimiters used to retrieve the encrypted IP address from the Google Docs document</li>
</ul>
<p>The decrypted string pool is listed in Figure 5 below.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-612565b3c5e0d464371051" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
SOFTWARE\Microsoft\Cryptography
Software\Microsoft\Windows\CurrentVersion\Internet Settings
ProxyServer
kT7fDpaQy9UhMz3
ZFYP0BV7SJ2LUH1Q9WEC8RTMXAKG6D3NO5I4LAHXN1EDRVC
PBKW0X8MEOUSCA6LQJYH4R97VNI5T31FD2ZG697NYYGB81W
o71UwSfKrH0NkRhjOmXqFGMAWDplz4s
0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ
Kernel32.dll
GetTickCount64
GetTickCount
texplorer.exe
%AllUsersProfile%\UTXP\nat\
%02X
GET
POST
Mozilla/5.0 Chrome/72.0.3626.109 Safari/537.36
gtsid: 
gtuvid: 
https://msdn.microsoft.com
https://www.google.com
https://www.twitter.com
https://www.facebook.com
0B93ACF2
PublicKey:AE6849916EB80C28FE99FC0F3EFF
CC1F99653E93305D
httpss
Global\JanzYQtWDWFejAFR</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-2">2</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-4">4</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-6">6</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-8">8</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-10">10</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-12">12</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-14">14</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-16">16</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-18">18</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-20">20</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-22">22</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-24">24</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-26">26</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-28">28</div><div class="crayon-num" data-line="crayon-612565b3c5e0d464371051-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e0d464371051-30">30</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-612565b3c5e0d464371051-1"><span class="crayon-v">SOFTWARE</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-e">Cryptography</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-2"><span class="crayon-v">Software</span><span class="crayon-sy">\</span><span class="crayon-v">Microsoft</span><span class="crayon-sy">\</span><span class="crayon-v">Windows</span><span class="crayon-sy">\</span><span class="crayon-v">CurrentVersion</span><span class="crayon-sy">\</span><span class="crayon-e">Internet </span><span class="crayon-e">Settings</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-3"><span class="crayon-e">ProxyServer</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-4"><span class="crayon-e">kT7fDpaQy9UhMz3</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-5"><span class="crayon-e">ZFYP0BV7SJ2LUH1Q9WEC8RTMXAKG6D3NO5I4LAHXN1EDRVC</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-6"><span class="crayon-e">PBKW0X8MEOUSCA6LQJYH4R97VNI5T31FD2ZG697NYYGB81W</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-7"><span class="crayon-i">o71UwSfKrH0NkRhjOmXqFGMAWDplz4s</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-8"><span class="crayon-cn">0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-9"><span class="crayon-v">Kernel32</span><span class="crayon-sy">.</span><span class="crayon-e">dll</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-10"><span class="crayon-e">GetTickCount64</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-11"><span class="crayon-e">GetTickCount</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-12"><span class="crayon-v">texplorer</span><span class="crayon-sy">.</span><span class="crayon-i">exe</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-13"><span class="crayon-ta">%</span><span class="crayon-v">AllUsersProfile</span><span class="crayon-o">%</span><span class="crayon-sy">\</span><span class="crayon-v">UTXP</span><span class="crayon-sy">\</span><span class="crayon-v">nat</span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-14">&nbsp;</div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-15"><span class="crayon-ta">%</span><span class="crayon-cn">02X</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-16">&nbsp;</div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-17"><span class="crayon-e">GET</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-18"><span class="crayon-e">POST</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-19"><span class="crayon-v">Mozilla</span><span class="crayon-o">/</span><span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-v">Chrome</span><span class="crayon-o">/</span><span class="crayon-cn">72.0.3626.109</span><span class="crayon-h"> </span><span class="crayon-v">Safari</span><span class="crayon-o">/</span><span class="crayon-cn">537.36</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-20"><span class="crayon-v">gtsid</span><span class="crayon-o">:</span><span class="crayon-h"> </span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-21"><span class="crayon-v">gtuvid</span><span class="crayon-o">:</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-22"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//msdn.microsoft.com</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-23"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//www.google.com</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-24"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//www.twitter.com</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-25"><span class="crayon-v">https</span><span class="crayon-o">:</span><span class="crayon-c">//www.facebook.com</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-26"><span class="crayon-cn">0B93ACF2</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-27"><span class="crayon-v">PublicKey</span><span class="crayon-o">:</span><span class="crayon-e">AE6849916EB80C28FE99FC0F3EFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-28"><span class="crayon-e">CC1F99653E93305D</span></div><div class="crayon-line" id="crayon-612565b3c5e0d464371051-29"><span class="crayon-e">httpss</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e0d464371051-30"><span class="crayon-m">Global</span><span class="crayon-sy">\</span><span class="crayon-v">JanzYQtWDWFejAFR</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><em>Figure 5. Decrypted configuration strings from SideWalk</em></p>
<p>Note that similar to SideWalk, CROSSWALK also starts its execution by decrypting a string pool using an XOR loop and a 16-byte key.</p>
<h4><strong>Instruction decryption</strong></h4>
<p>After decrypting the data section at the end of the shellcode, SideWalk then proceeds to decrypt the rest of its instructions (starting at offset 0x528) by using the same XOR loop with a different 16-byte key: <span style="font-family: courier new, courier, monospace;">26 74 94 78 36 60 C1 0C 41 56 0E 60 B1 54 D7 31</span>.</p>
<h4><strong>Anti-tampering</strong></h4>
<p>Once it has decrypted its data and code, SideWalk proceeds to verify its integrity by computing a 32-bit checksum, rotating the result to the right by 13 bits at every 32-bit word and comparing the hash value with a reference one corresponding to the untampered shellcode. If the hash is different from the reference value, it exits. This allows the shellcode to detect breakpoints or patches to its code and to avoid execution in such cases. The corresponding decompiled code is shown in Figure 6.</p>
<div id="attachment_154198" style="width: 410px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-6.-Decompiled-code-of-SideWalk’s-anti-tampering-procedure.png"><img class="wp-image-154198" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-6.-Decompiled-code-of-SideWalk’s-anti-tampering-procedure.png" alt="Figure 6. Decompiled code of SideWalk’s anti-tampering procedure" width="400" height="236" /></a><p class="wp-caption-text"><em>Figure 6. Decompiled code of SideWalk’s anti-tampering procedure</em></p></div>
<h4><strong>IAT</strong></h4>
<p>In addition to the string pool, the decoded data also contains the names of the DLLs, as well as the hashes of the names of the functions, to be loaded. Contrary to CROSSWALK, where the string representation of the hashes is used, the hashes are stored directly in their raw binary representation. The corresponding part of the main structure, after having resolved import addresses, is shown in Figure 7. The names of the DLLs to be loaded are highlighted in grey, the hash of the Windows API function names to be imported are in purple and the addresses of the imported functions are in green.</p>
<div id="attachment_154199" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-SideWalks-IAT-structure.png"><img class="wp-image-154199" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-SideWalks-IAT-structure.png" alt="" width="700" height="398" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-SideWalks-IAT-structure.png 564w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-7.-SideWalks-IAT-structure-300x171.png 300w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 7. SideWalk&#8217;s IAT structure</em></p></div>
<p>SideWalk iterates over the exports of each of the DLLs listed in the decoded data and hashes them with a custom hashing algorithm and then compares them to the hashes of the function names to be imported. Once a match is found, the address of the matching function is added to the main structure.</p>
<h4><strong>Configuration</strong></h4>
<p>Once the IAT is populated, SideWalk proceeds to decrypt its configuration. The configuration is encrypted using the ChaCha20 algorithm and the decryption key is part of the string pool mentioned above. The ChaCha20 implementation is the same one used for the ChaCha20-based loader. The decrypted configuration contains values used by SideWalk for proper operation, as well as the<span style="font-family: courier new, courier, monospace;"> update.facebookint.workers[.]dev</span> C&amp;C server, and the URL of the Google Docs document that is later used as a dead-drop resolver.</p>
<p>Note that the <span style="font-family: courier new, courier, monospace;">update.facebookint.workers[.]dev</span> domain is a <a href="https://blog.cloudflare.com/announcing-workers-dev/" target="_blank" rel="noopener"><em>Cloudflare worker</em></a> that lets the malware operators customize the server, running on a widely used, public web service. During that campaign, SparklingGoblin also used a Cloudflare worker domain with Cobalt Strike: cdn.cloudfiare.workers[.]dev.</p>
<h3>Network Activity</h3>
<p>One feature of SideWalk is to check whether a proxy configuration is present before starting to communicate with the C&amp;C server. To do so, it tries two techniques:</p>
<ul>
<li>A call to the API function <span style="font-family: courier new, courier, monospace;">WinHttpGetIEProxyConfigForCurrentUser</span>, with predefined URLs contained in its configuration:
<ul>
<li><a href="https://msdn.microsoft.com" target="_blank" rel="noopener">https://msdn.microsoft.com</a></li>
<li><a href="https://www.google.com" target="_blank" rel="noopener">https://www.google.com</a></li>
<li><a href="https://www.twitter.com" target="_blank" rel="noopener">https://www.twitter.com</a></li>
<li><a href="https://www.facebook.com" target="_blank" rel="noopener">https://www.facebook.com</a></li>
</ul>
</li>
<li>If SideWalk is able to adjust its privileges to <span style="font-family: courier new, courier, monospace;">SeDebugPrivilege</span>, it tries to retrieve the proxy configuration from <span style="font-family: courier new, courier, monospace;">HKU\&lt;user SID&gt;\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyServer</span>. Otherwise, it tries to fetch it from <span style="font-family: courier new, courier, monospace;">HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings\ProxyServer</span>.</li>
</ul>
<p>If a proxy is found, SideWalk will use it to communicate with the C&amp;C server. This behavior is very similar to the way proxies are handled by CROSSWALK.</p>
<p>SideWalk attempts to obtain the proxy configuration of the current user session by stealing the user token from <span style="font-family: courier new, courier, monospace;">explorer.exe</span> (the process name to search for is in the configuration) and calling the Windows API <span style="font-family: courier new, courier, monospace;">WinHttpGetIEProxyConfigForCurrentUser</span>.</p>
<p>Note that SideWalk has the necessary permissions to impersonate logged-on users because it is loaded by the InstallUtil-based .NET loader, which persists as a scheduled task, and so runs under the <span style="font-family: courier new, courier, monospace;">SYSTEM</span> account. Interestingly, the same procedure to get the explorer.exe token is described on this <a href="https://www.cnblogs.com/priarieNew/p/9755655.html" target="_blank" rel="noopener"><em>Chinese language blog</em></a>. The decompiled procedure is shown in Figure 8.</p>
<div id="attachment_154200" style="width: 565px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-8.-Decompiled-code-responsible-for-user-impersonation-before-retrieving-the-proxy-configuration.png"><img class="wp-image-154200 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-8.-Decompiled-code-responsible-for-user-impersonation-before-retrieving-the-proxy-configuration.png" alt="Figure 8. Decompiled code responsible for user impersonation before retrieving the proxy configuration" width="555" height="774" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-8.-Decompiled-code-responsible-for-user-impersonation-before-retrieving-the-proxy-configuration.png 555w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-8.-Decompiled-code-responsible-for-user-impersonation-before-retrieving-the-proxy-configuration-215x300.png 215w" sizes="(max-width: 555px) 100vw, 555px" /></a><p class="wp-caption-text"><em>Figure 8. Decompiled code responsible for user impersonation before retrieving the proxy configuration</em></p></div>
<h4><strong>Requests formats</strong></h4>
<p>The Google Docs page used by SideWalk as a dead-drop resolver is shown in the following screenshot (Figure 9), and at the time of writing, it is still up. Note that anyone can edit this page.</p>
<div id="attachment_154262" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-9.-Google-Docs-document-used-by-SideWalk-as-dead-drop-resolver-1.png"><img class="wp-image-154262" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-9.-Google-Docs-document-used-by-SideWalk-as-dead-drop-resolver-1-300x109.png" alt="Figure 9. Google Docs document used by SideWalk as dead-drop resolver" width="750" height="274" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-9.-Google-Docs-document-used-by-SideWalk-as-dead-drop-resolver-1-300x109.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-9.-Google-Docs-document-used-by-SideWalk-as-dead-drop-resolver-1-768x280.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-9.-Google-Docs-document-used-by-SideWalk-as-dead-drop-resolver-1-1024x374.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-9.-Google-Docs-document-used-by-SideWalk-as-dead-drop-resolver-1.png 1373w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><em>Figure 9. Google Docs document used by SideWalk as dead-drop resolver</em></p></div>
<p>The string present in this page has the format depicted in Figure 10.</p>
<div id="attachment_154260" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-10.-Format-of-the-string-hosted-on-the-Google-Docs-document.jpg"><img class="wp-image-154260" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-10.-Format-of-the-string-hosted-on-the-Google-Docs-document-300x56.jpg" alt="Figure 10. Format of the string hosted on the Google Docs document" width="750" height="140" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-10.-Format-of-the-string-hosted-on-the-Google-Docs-document-300x56.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-10.-Format-of-the-string-hosted-on-the-Google-Docs-document-768x143.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-10.-Format-of-the-string-hosted-on-the-Google-Docs-document-1024x191.jpg 1024w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><em>Figure 10. Format of the string hosted on the Google Docs document</em></p></div>
<p>This string is composed of:</p>
<ul>
<li>Delimiters used for proper parsing.</li>
<li>A payload and its size, which consists of a ChaCha20-encrypted IP address, the key to decrypt it, and, for an integrity check, the hash of the decryption key.</li>
<li>Additional strings that are currently unused.</li>
</ul>
<p>To facilitate the potential future usage of that formatting, we have provided a script in <a href="https://github.com/eset/malware-ioc/tree/master/sparklinggoblin" target="_blank" rel="noopener">our GitHub repository</a>.</p>
<p>The decrypted IP address is <span style="font-family: courier new, courier, monospace;">80.85.155[.]80</span>. That C&amp;C server uses a self-signed certificate for the<span style="font-family: courier new, courier, monospace;"> facebookint[.]com</span> domain. This domain has been attributed to <a href="https://github.com/Azure/Azure-Sentinel/blob/master/Detections/MultipleDataSources/BariumDomainIOC112020.yaml" target="_blank" rel="noopener"><em>BARIUM</em></a> by Microsoft, which partially overlaps with what we define as Winnti Group. As this IP address is not the first one to be used by the malware, it is considered to be the fallback one.</p>
<p>The communication protocol used by SideWalk to communicate with its C&amp;C server is HTTPS and the format of the POST request headers sent to the C&amp;C can be seen in Figure 11.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-612565b3c5e10888949601" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
POST /M26RcKtVr5WniDVZ/5CDpKo5zmAYbTmFl HTTP/1.1
Cache-Control: no-cache
Connection: close
Pragma: no-cache
User-Agent: Mozilla/5.0 Chrome/72.0.3626.109 Safari/537.36
gtsid: zn3isN2C6bWsqYvO
gtuvid: 7651E459979F931D39EDC12D68384C21249A8DE265F3A925F6E289A2467BC47D
Content-Length: 120
Host: update.facebookint.workers.dev</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-612565b3c5e10888949601-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e10888949601-2">2</div><div class="crayon-num" data-line="crayon-612565b3c5e10888949601-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e10888949601-4">4</div><div class="crayon-num" data-line="crayon-612565b3c5e10888949601-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e10888949601-6">6</div><div class="crayon-num" data-line="crayon-612565b3c5e10888949601-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-612565b3c5e10888949601-8">8</div><div class="crayon-num" data-line="crayon-612565b3c5e10888949601-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-612565b3c5e10888949601-1"><span class="crayon-v">POST</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-v">M26RcKtVr5WniDVZ</span><span class="crayon-o">/</span><span class="crayon-cn">5CDpKo5zmAYbTmFl</span><span class="crayon-h"> </span><span class="crayon-v">HTTP</span><span class="crayon-o">/</span><span class="crayon-cn">1.1</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e10888949601-2"><span class="crayon-v">Cache</span><span class="crayon-o">-</span><span class="crayon-v">Control</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">no</span><span class="crayon-o">-</span><span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-612565b3c5e10888949601-3"><span class="crayon-v">Connection</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">close</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e10888949601-4"><span class="crayon-v">Pragma</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">no</span><span class="crayon-o">-</span><span class="crayon-e">cache</span></div><div class="crayon-line" id="crayon-612565b3c5e10888949601-5"><span class="crayon-v">User</span><span class="crayon-o">-</span><span class="crayon-v">Agent</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">Mozilla</span><span class="crayon-o">/</span><span class="crayon-cn">5.0</span><span class="crayon-h"> </span><span class="crayon-v">Chrome</span><span class="crayon-o">/</span><span class="crayon-cn">72.0.3626.109</span><span class="crayon-h"> </span><span class="crayon-v">Safari</span><span class="crayon-o">/</span><span class="crayon-cn">537.36</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e10888949601-6"><span class="crayon-v">gtsid</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">zn3isN2C6bWsqYvO</span></div><div class="crayon-line" id="crayon-612565b3c5e10888949601-7"><span class="crayon-v">gtuvid</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">7651E459979F931D39EDC12D68384C21249A8DE265F3A925F6E289A2467BC47D</span></div><div class="crayon-line crayon-striped-line" id="crayon-612565b3c5e10888949601-8"><span class="crayon-v">Content</span><span class="crayon-o">-</span><span class="crayon-v">Length</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">120</span></div><div class="crayon-line" id="crayon-612565b3c5e10888949601-9"><span class="crayon-v">Host</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">update</span><span class="crayon-sy">.</span><span class="crayon-v">facebookint</span><span class="crayon-sy">.</span><span class="crayon-v">workers</span><span class="crayon-sy">.</span><span class="crayon-v">dev</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p><em>Figure 11. Example of a POST request used by SideWalk</em></p>
<p>Both the URL and the values of the <span style="font-family: courier new, courier, monospace;">gtsid</span> and <span style="font-family: courier new, courier, monospace;">gtuvid</span> parameters are randomly generated. The <span style="font-family: courier new, courier, monospace;">Host</span> field is either the IP fetched from Google Docs, or is set to <span style="font-family: courier new, courier, monospace;">update.facebookint.workers[.]dev</span>. The data of the POST request is an encrypted payload. The format used by this request is the communication format used by SideWalk operators between C&amp;C server and infected machines, e.g., requests and responses. The format of the POST request data is shown in Figure 12.</p>
<div id="attachment_154203" style="width: 635px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-12.-Format-of-the-POST-request-data.png"><img class="wp-image-154203 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-12.-Format-of-the-POST-request-data.png" alt="" width="625" height="715" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-12.-Format-of-the-POST-request-data.png 625w, https://www.welivesecurity.com/wp-content/uploads/2021/08/Figure-12.-Format-of-the-POST-request-data-262x300.png 262w" sizes="(max-width: 625px) 100vw, 625px" /></a><p class="wp-caption-text"><em>Figure 12. Format of the POST request data</em></p></div>
<p>Note that this format is used for both the request and the response, meaning that when SideWalk handles the data sent back from the C&amp;C server, it parses it according to the same format. There is no particular similarity in the C&amp;C server communication side between CROSSWALK and SideWalk.</p>
<p>In this format, the fields are:</p>
<ul>
<li><strong>hash</strong>: the hash of the data from <span style="font-family: courier new, courier, monospace;">0x10</span> to <span style="font-family: courier new, courier, monospace;">total_size</span> of the payload. The hash algorithm is a custom hash combined of multiple MD5 calls on different portions of the hashed data.</li>
<li><strong>size</strong>: the size is equal to <span style="font-family: courier new, courier, monospace;">total_size &#8211; 0x0D</span>.</li>
<li><strong>key1, key2</strong>: ChaCha20 keys to encrypt Header Buffer and Data Buffer.</li>
<li><strong>parameter buffer</strong>: optional buffer (may be <span style="font-family: courier new, courier, monospace;">0&#8230;0</span>).</li>
<li><strong>victim ID</strong>: authentication information, which is the result of a custom hash of various machine information including Machine GUID and computer name.</li>
<li><strong>execution ID</strong>: before launching the threads, this ID is generated using <span style="font-family: courier new, courier, monospace;">CryptGenRandom</span>. It is different for each execution.</li>
<li><strong>command ID</strong> /<strong> response ID</strong>: ID of the action that has been handled by the malware when it is a request from the malware to the C&amp;C server, and the ID of the command to execute when it is a response from the C&amp;C server to the malware.</li>
<li><strong>counter</strong>: number of commands executed since the current SideWalk process inception.</li>
<li><strong>data</strong>: the ChaCha20-encrypted, compressed data fetched by the malware or sent by the C&amp;C server.</li>
<li><strong>compressed size</strong>: the size of the LZ4-compressed data.</li>
<li><strong>data size</strong>: the uncompressed data size.</li>
</ul>
<p>Header Buffer and Data Buffer are encrypted using the corresponding keys. The first one stands for the metadata to identify the machine that was compromised, and the second buffer corresponds to the actual data shared between the C&amp;C server and the malware. The details of these fields shown in Figure 12, are visible once decrypted.</p>
<h4><strong>Capabilities</strong></h4>
<p>When we started analyzing SideWalk, as its C&amp;C server was already down, some of the possible actions were not fully understandable without knowing the data sent by the C&amp;C server, yet most of the capabilities of the malware are documented in the following table.</p>
<p><em>Table 1. C&amp;C commands supported by SideWalk</em></p>

<table id="tablepress-986" class="tablepress tablepress-id-986">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Command ID (C&amp;C to malware)</th><th class="column-2">Response ID (malware to C&amp;C) </th><th class="column-3">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><strong>0x00</strong></td><td class="column-2">None</td><td class="column-3">Do nothing.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><strong>0x7C</strong></td><td class="column-2">0x79</td><td class="column-3">Load the plug-in (as shellcode) sent by the C&amp;C server.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><strong>0x82</strong></td><td class="column-2">0x83</td><td class="column-3">Collect information about running processes (owner SID, account name, process name, domain information).</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><strong>0x8E</strong></td><td class="column-2">0x8F</td><td class="column-3">Write the received data to the file located at <nobr><span style="font-family: courier new, courier, monospace;">%AllUsersProfile%\UTXP\nat\&lt;filename&gt;</span></nobr>, where <span style="font-family: courier new, courier, monospace;">filename</span> is a hash of the value returned by  <span style="font-family: courier new, courier, monospace;">VirtualAlloc</span>  at each execution of the malware.</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><strong>0x64</strong></td><td class="column-2">None</td><td rowspan="6" class="column-3">Call one of the plug-ins received from the C&amp;C server. Each command calls them differently using different arguments. In addition, the command 0x74 terminates all the threads.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><strong>0x74</strong></td><td class="column-2">None</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><strong>0x78</strong></td><td class="column-2">0x79 or 0x7B</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><strong>0x7E</strong></td><td class="column-2">None</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><strong>0x80</strong></td><td class="column-2">0x81</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><strong>default</strong></td><td class="column-2">None</td>
</tr>
</tbody>
</table>

<p>Note: As we didn’t retrieve any plug-ins from the C&amp;C server, it’s difficult to assess SideWalk’s full capabilities.</p>
<h3>The CROSSWALK connection</h3>
<p>Even though the SideWalk and CROSSWALK code is different, both families share multiple architectural similarities, with a similar anti-tampering technique, threading model and data layout, and the way this data is handled throughout execution. Feature-wise, both backdoors are modular and able to handle proxies to communicate properly with their C&amp;C servers.</p>
<p>These similarities are described below and summarized in a table at the end of this section.</p>
<p>Considering all these similarities, we believe SideWalk and CROSSWALK are most likely coded by the same developers.</p>
<h4><strong>Architecture</strong></h4>
<p>The threading model is very similar between SideWalk and CROSSWALK. The authors split tasks between threads and use <span style="font-family: courier new, courier, monospace;">PostThreadMessage</span> Windows API calls to communicate between them. For example, one thread is responsible for making a request, and once it gets the response, it transfers it to the appropriate thread.</p>
<p>The programming style is also very similar; a functional approach is used. A data structure stores the configuration, strings, and imports, and it is passed as an argument to all the functions that need it.</p>
<p>For example, here are a few function prototypes:</p>
<ul>
<li><span style="font-family: courier new, courier, monospace;">__int64 getMachineGuid(main_struct* main_struct, __int64 machineguid)</span></li>
<li><span style="font-family: courier new, courier, monospace;">__int64 writeBufferToFile(main_struct* main_struct, __int64 buffer, unsigned int nbBytes)</span></li>
<li><span style="font-family: courier new, courier, monospace;">__int64 recv(main_struct* main_struct, __int64 socket, unsigned int nbBytes, __int64 buffer)</span></li>
</ul>
<p>Both SideWalk and CROSSWALK are modular backdoors that can load additional modules sent by the C&amp;C server. The SideWalk module handling is implemented in a manner similar to CROSSWALK. Some of the possible module operations are execution, installation, and uninstallation.</p>
<h4><strong>Functionalities</strong></h4>
<p>Like CROSSWALK, during its initialization, SideWalk computes a 32-bit hash value of the shellcode at the very beginning of its execution using a ROR4 loop.</p>
<p>CROSSWALK and SideWalk gather similar artifacts; among them:</p>
<ul>
<li>IP configuration</li>
<li>OS version</li>
<li>Username</li>
<li>Computer name</li>
<li>Filename</li>
<li>Current process ID</li>
<li>Current time</li>
</ul>
<p>Proxy handling is the same in both CROSSWALK and SideWalk. Both use common, legitimate URLs (such as <a href="https://www.google.com/" target="_blank" rel="noopener"><em>https://www.google.com</em></a> or <a href="https://www.twitter.com/" target="_blank" rel="noopener"><em>https://www.twitter.com</em></a>) and a <span style="font-family: courier new, courier, monospace;">WinHttpGetIEProxyConfigForCurrentUser</span> Windows API call to retrieve the proxy configuration.</p>
<h4><strong>Data layout</strong></h4>
<p>SideWalk and CROSSWALK follow the same shellcode layout, with instructions followed by strings, IAT, and encrypted configuration data.</p>
<h4><strong>Data handling</strong></h4>
<p>SideWalk and CROSSWALK each process the data at the end of the shellcode in the same way:</p>
<ul>
<li>First, the data section is decrypted using a 16-byte XOR loop.</li>
<li>Then, function addresses from name hashes stored in the data section are resolved and stored in its main structure (pointing to the IAT in the data section).</li>
<li>Finally, its configuration that contains the C&amp;C server address is decrypted (although the decryption algorithm used by SideWalk is different).</li>
</ul>
<p><em>Table 2. Summary of the similarities between SideWalk and CROSSWALK</em></p>

<table id="tablepress-987" class="tablepress tablepress-id-987">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Category</th><th class="column-2">Feature</th><th class="column-3">Similarities</th><th class="column-4">Scarcity</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="3" class="column-1"><strong>Architecture</strong></td><td class="column-2">Threading model</td><td class="column-3">Multiple threads are used, each thread being responsible for specific actions:<br />
&nbsp;&nbsp;&nbsp;·	Making requests<br />
&nbsp;&nbsp;&nbsp;·	Handling responses and processing commands</td><td class="column-4">Low</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2">Programming style</td><td class="column-3">A main data structure is used to store all the backdoor configuration, strings and imports and passed as an argument to all the functions that need it.</td><td class="column-4"><strong>High</strong></td>
</tr>
<tr class="row-4 even">
	<td class="column-2">Module handling</td><td class="column-3">Installs, uninstalls, and executes modules in a similar manner to CROSSWALK.</td><td class="column-4"><strong>High</strong></td>
</tr>
<tr class="row-5 odd">
	<td rowspan="3" class="column-1"><strong>Functionality</strong></td><td class="column-2">Gathered information</td><td class="column-3">&nbsp;&nbsp;&nbsp;·	IP configuration<br />
&nbsp;&nbsp;&nbsp;·	OS version<br />
&nbsp;&nbsp;&nbsp;·	Username<br />
&nbsp;&nbsp;&nbsp;·	Computer name<br />
&nbsp;&nbsp;&nbsp;·	Filenames<br />
&nbsp;&nbsp;&nbsp;·	Current process ID<br />
&nbsp;&nbsp;&nbsp;·	Current time<br />
</td><td class="column-4">Low</td>
</tr>
<tr class="row-6 even">
	<td class="column-2">Networking</td><td class="column-3">Similar proxy handling</td><td class="column-4"><em>Medium</em></td>
</tr>
<tr class="row-7 odd">
	<td class="column-2">Anti-tampering</td><td class="column-3">Custom hash of the shellcode is computed and checked against a 32-bit reference value.</td><td class="column-4"><strong>High</strong></td>
</tr>
<tr class="row-8 even">
	<td rowspan="2" class="column-1"><strong>Configuration</strong></td><td class="column-2">Internal data handling</td><td class="column-3">&nbsp;&nbsp;&nbsp;·	Similar 16-byte XOR key decryption<br />
&nbsp;&nbsp;&nbsp;·	Similar IAT resolution (similar hash/address pair structure)<br />
&nbsp;&nbsp;&nbsp;·	Similar data processing order</td><td class="column-4"><strong>High</strong></td>
</tr>
<tr class="row-9 odd">
	<td class="column-2">Data layout</td><td class="column-3">Similar data structure layout with:<br />
&nbsp;&nbsp;&nbsp;·	Encrypted string pool<br />
&nbsp;&nbsp;&nbsp;·	IAT<br />
&nbsp;&nbsp;&nbsp;·	Encrypted C&amp;C configuration</td><td class="column-4"><strong>High</strong></td>
</tr>
</tbody>
</table>

<h2>Conclusion</h2>
<p>SideWalk is a previously undocumented backdoor used by the SparklingGoblin APT group. It was most likely produced by the same developers as those behind CROSSWALK, with which it shares many design structures and implementation details.</p>
<p>SparklingGoblin is a group with some level of connection to Winnti Group. It was very active in 2020 and the first half of 2021, compromising multiple organizations over a wide range of verticals around the world and with a particular focus on the academic sector and East Asia.</p>
<p><em>ESET Research is now offering a private APT intelligence report and data feed. For any inquiries about this new service, or research published on WLS, contact us at <a href="mailto:threatintel@eset.com">threatintel@eset.com</a>.</em></p>
<h2>Indicators of Compromise (IoCs)</h2>
<p>A comprehensive list of Indicators of Compromise and samples can be found in <a href="https://github.com/eset/malware-ioc/tree/master/sparklinggoblin" target="_blank" rel="noopener">our GitHub repository</a>.</p>
<h3>Samples</h3>
<p>Note that the SideWalk sample referenced below is not the one on which our analysis is based; the actual sample used during the compromise is the one discussed in detail in the text of this blogpost.</p>

<table id="tablepress-988" class="tablepress tablepress-id-988">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Description</th><th class="column-3">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">1077A3DC0D9CCFBB73BD9F2E6B72BC67ADDCF2AB</span></td><td class="column-2">InstallUtil-based .NET loader used to decrypt and load SideWalk</td><td class="column-3">MSIL/ShellcodeRunner.L.gen</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">153B8E46458BD65A68A89D258997E314FEF72181</span></td><td class="column-2">ChaCha20-based shellcode loader used to decrypt and load the SideWalk shellcode</td><td class="column-3">Win64/Agent.AQD</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">829AADBDE42DF14CE8ED06AC02AD697A6C9798FE</span></td><td class="column-2">SideWalk ChaCha20-encrypted shellcode</td><td class="column-3">N/A</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">9762BC1C4CB04FE8EAEEF50A4378A8D188D85360</span></td><td class="column-2">SideWalk decrypted shellcode</td><td class="column-3">Win64/Agent.AQD</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">EA44E9FBDBE5906A7FC469A988D83587E8E4B20D</span></td><td class="column-2">InstallUtil-based .NET loader used to decrypt and load Cobalt Strike</td><td class="column-3">MSIL/ShellcodeRunner.O</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">AA5B5F24BDFB049EF51BBB6246CB56CEC89752BF</span></td><td class="column-2">Cobalt Strike encrypted shellcode</td><td class="column-3">N/A</td>
</tr>
</tbody>
</table>

<h4><strong>Network</strong></h4>
<p><span style="font-family: courier new, courier, monospace;">update.facebookint.workers[.]dev</span><br />
<span style="font-family: courier new, courier, monospace;">cdn.cloudfiare.workers[.]dev</span><br />
<span style="font-family: courier new, courier, monospace;">104.21.49[.]220</span><br />
<span style="font-family: courier new, courier, monospace;">80.85.155[.]80</span><br />
<span style="font-family: courier new, courier, monospace;">193.38.54[.]110</span></p>
<h4><strong>Filenames</strong></h4>
<p><span style="font-family: courier new, courier, monospace;">C:\Windows\System32\Tasks\Microsoft\Windows\WindowsUpdate\WebService</span><br />
<span style="font-family: courier new, courier, monospace;">C:\windows\system32\tasks\Microsoft\Windows\Ras\RasTaskStart</span><br />
<span style="font-family: courier new, courier, monospace;">iislog.tmp</span><br />
<span style="font-family: courier new, courier, monospace;">mscorsecimpl.tlb</span><br />
<span style="font-family: courier new, courier, monospace;">C_25749.NLS</span><br />
<span style="font-family: courier new, courier, monospace;">Microsoft.WebService.targets</span></p>
<h4><strong>SSL certificate</strong></h4>

<table id="tablepress-989" class="tablepress tablepress-id-989">
<tbody class="row-hover">
<tr class="row-1 odd">
	<td class="column-1">Serial number</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">8E812FCAD3B3855DFD78980CEE0BEB71</span></td>
</tr>
<tr class="row-2 even">
	<td class="column-1">Fingerprint</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">D54AEB62D0102D0CC4B96CA9E5EAADE3846EC470</span></td>
</tr>
<tr class="row-3 odd">
	<td class="column-1">Subject CN</td><td class="column-2">CloudFlare Origin Certificate</td>
</tr>
<tr class="row-4 even">
	<td class="column-1">Subject O</td><td class="column-2">CloudFlare, Inc.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Subject L</td><td class="column-2">San Francisco</td>
</tr>
<tr class="row-6 even">
	<td class="column-1">Subject S</td><td class="column-2">California</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Subject C</td><td class="column-2">US</td>
</tr>
<tr class="row-8 even">
	<td class="column-1">Valid from</td><td class="column-2">2020-11-04 09:35:00</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">Valid to</td><td class="column-2">2035-11-01 09:35:00</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">X509v3 Subject Alternative Name</td><td class="column-2"><span style="font-family: courier new, courier, monospace;">DNS:*.facebookint.com</span><br />
<span style="font-family: courier new, courier, monospace;">DNS:facebookint.com</span></td>
</tr>
</tbody>
</table>

<h2>MITRE ATT&amp;CK techniques</h2>
<p>This table was built using <a href="https://attack.mitre.org/resources/versions/" target="_blank" rel="noopener">version 9</a> of the MITRE ATT&amp;CK framework<strong>.</strong></p>

<table id="tablepress-990" class="tablepress tablepress-id-990">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="5" class="column-1">Resource Development</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1583/001/" rel="noopener" target="_blank">T1583.001</a></td><td class="column-3">Acquire Infrastructure: Domains</td><td class="column-4">SparklingGoblin uses its    own domains.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1583/004/" rel="noopener" target="_blank">T1583.004</a></td><td class="column-3">Acquire Infrastructure: Server</td><td class="column-4">SparklingGoblin uses servers hosted by various providers for its C&amp;C servers.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1583/004/" rel="noopener" target="_blank">T1583.006</a></td><td class="column-3">Acquire Infrastructure: Web Services</td><td class="column-4">SparklingGoblin uses Cloudflare worker services as C&amp;C servers.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1587/001/" rel="noopener" target="_blank">T1587.001</a></td><td class="column-3">Develop Capabilities: Malware</td><td class="column-4">SparklingGoblin uses its own malware arsenal.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1587/003/" rel="noopener" target="_blank">T1587.003</a></td><td class="column-3">Develop Capabilities: Digital Certificates</td><td class="column-4">Sparkling uses self-signed SSL certificates.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1053/005/" rel="noopener" target="_blank">T1053.005</a></td><td class="column-3">Scheduled Task/Job: Scheduled Task</td><td class="column-4">SparklingGoblin’s .NET shellcode loaders are executed by a scheduled task.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="2" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1574/001/" rel="noopener" target="_blank">T1574.001</a></td><td class="column-3">Hijack Execution Flow: DLL Search Order Hijacking</td><td class="column-4">Some SparklingGoblin shellcode loaders persist by being installed at locations used for DLL search order hijacking.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1053/005/" rel="noopener" target="_blank">T1053.005</a></td><td class="column-3">Scheduled Task/Job: Scheduled Task</td><td class="column-4">SparklingGoblin’s .NET shellcode loaders persist as scheduled tasks.</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1134/001/" rel="noopener" target="_blank">T1134.001</a></td><td class="column-3">Access Token Manipulation: Token Impersonation/Theft</td><td class="column-4">SideWalk uses token impersonation before performing HTTP requests.</td>
</tr>
<tr class="row-11 odd">
	<td rowspan="3" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1140/" rel="noopener" target="_blank">T1140</a></td><td class="column-3">Deobfuscate/Decode Files or Information</td><td class="column-4">Most shellcode used by SparklingGoblin is stored encrypted on disk.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1055/012/" rel="noopener" target="_blank">T1055.012</a></td><td class="column-3">Process Injection: Process Hollowing</td><td class="column-4">Some SparklingGoblin loaders use process hollowing to execute their shellcode.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1218/004/" rel="noopener" target="_blank">T1218.004</a></td><td class="column-3">Signed Binary Proxy Execution: InstallUtil</td><td class="column-4">SparklingGoblin’s .NET loaders are executed by InstallUtil.</td>
</tr>
<tr class="row-14 even">
	<td rowspan="3" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1012/" rel="noopener" target="_blank">T1012</a></td><td class="column-3">Query Registry</td><td class="column-4">SideWalk queries the registry to get the proxy configuration.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">SideWalk and CROSSWALK collect various information about the compromised system.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1016/" rel="noopener" target="_blank">T1016</a></td><td class="column-3">System Network Configuration Discovery</td><td class="column-4">SideWalk and CROSSWALK retrieve the local proxy configuration.</td>
</tr>
<tr class="row-17 odd">
	<td rowspan="6" class="column-1">Command And Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1071/001/" rel="noopener" target="_blank">T1071.001</a></td><td class="column-3">Application Layer Protocol: Web Protocols</td><td class="column-4">SideWalk and CROSSWALK use HTTPS to communicate with C&amp;C servers.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1573/001/" rel="noopener" target="_blank">T1573.001</a></td><td class="column-3">Encrypted Channel: Symmetric Cryptography</td><td class="column-4">SideWalk uses a modified ChaCha20 implementation to communicate with C&amp;C servers.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1008/" rel="noopener" target="_blank">T1008</a></td><td class="column-3">Fallback Channels</td><td class="column-4">SideWalk uses a fallback IP address encrypted in a Google Docs document used as dead-drop resolver.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1090/" rel="noopener" target="_blank">T1090</a></td><td class="column-3">Proxy</td><td class="column-4">SideWalk and CROSSWALK can communicate properly when a proxy is used on the victim’s network.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1102/" rel="noopener" target="_blank">T1102</a></td><td class="column-3">Web Service</td><td class="column-4">SideWalk uses Cloudflare workers web services.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1102/001/" rel="noopener" target="_blank">T1102.001</a></td><td class="column-3">Web Service: Dead Drop Resolver</td><td class="column-4">SideWalk uses a Google Docs document as dead-drop resolver.</td>
</tr>
</tbody>
</table>

<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=sidewalk-may-be-as-dangerous-as-crosswalk/" target="_blank" rel="noopener"><img class="aligncenter wp-image-152551" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png" alt="" width="899" height="290" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png 918w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-300x97.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-768x248.png 768w" sizes="(max-width: 899px) 100vw, 899px" /></a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/tpassilly/" title="Thibaut Passilly">
                    Thibaut Passilly                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mtartare/" title="Mathieu Tartare">
                    Mathieu Tartare                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-08-24 19:59:01">24 Aug 2021 - 07:59PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/11/iiserpent-malware-driven-seo-fraud-service/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/iis-malware‑iiserpent-seo-fraud-623x415.jpg"
                                                         alt="The SideWalk may be as dangerous as the CROSSWALK">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/11/iiserpent-malware-driven-seo-fraud-service/">
                                                    IISerpent: Malware-driven SEO fraud as a service                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/09/iispy-complex-server-side-backdoor-antiforensic-features/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/iispy-iis-malware-backdoor-cyberespionage-623x415.jpg"
                                                         alt="The SideWalk may be as dangerous as the CROSSWALK">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/09/iispy-complex-server-side-backdoor-antiforensic-features/">
                                                    IISpy: A complex server-side backdoor with anti-forensic features                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/06/iistealer-server-side-threat-ecommerce-transactions/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/iistealer-iis-malware-credit-card-information-theft-1-623x415.jpg"
                                                         alt="The SideWalk may be as dangerous as the CROSSWALK">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/06/iistealer-server-side-threat-ecommerce-transactions/">
                                                    IIStealer: A server-side threat to e-commerce transactions                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/07/wls_anatomy-iis-malware-2021_1770540524_1000x667-623x432.jpg"
                                                         alt="The SideWalk may be as dangerous as the CROSSWALK">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/">
                                                    Anatomy of native IIS malware                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F24%2Fsidewalk-may-be-as-dangerous-as-crosswalk%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F24%2Fsidewalk-may-be-as-dangerous-as-crosswalk%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F24%2Fsidewalk-may-be-as-dangerous-as-crosswalk%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.4.1.0bbcde.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"154187 https:\/\/backend.welivesecurity.com\/?p=154187","disqusShortname":"welivesecurity","disqusTitle":"The SideWalk may be as dangerous as the CROSSWALK","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/08\/24\/sidewalk-may-be-as-dangerous-as-crosswalk\/","postId":"154187"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
