<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=09d01dd87b618f2315ce" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Marc-Etienne M.Léveillé',
        'ArticleCategory': 'COVID-19',
        'ArticleSection': '(not set)',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Flaw in the Quebec vaccine passport: analysis | WeLiveSecurity</title>
<meta name="description" content="ESET&#039;s cybersecurity expert Marc-Étienne Léveillé analyses in-depth the Quebec&#039;s vaccine proof apps VaxiCode and VaxiCode Verif."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/08/31/flaw-quebec-vaccine-passport-vaxicode-verif-analysis/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="fr_FR" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Flaw in the Quebec vaccine passport: analysis | WeLiveSecurity" />
<meta property="og:description" content="ESET&#039;s cybersecurity expert Marc-Étienne Léveillé analyses in-depth the Quebec&#039;s vaccine proof apps VaxiCode and VaxiCode Verif." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/08/31/flaw-quebec-vaccine-passport-vaxicode-verif-analysis/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="COVID-19" />
<meta property="article:published_time" content="2021-08-31T19:21:07+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/08/shutterstock_2001120401b-e1630427951672.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/08/shutterstock_2001120401b-e1630427951672.jpg" />
<meta property="og:image:width" content="889" />
<meta property="og:image:height" content="525" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET&#039;s cybersecurity expert Marc-Étienne Léveillé analyses in-depth the Quebec&#039;s vaccine proof apps VaxiCode and VaxiCode Verif." />
<meta name="twitter:title" content="Flaw in the Quebec vaccine passport: analysis | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/08/shutterstock_2001120401b-e1630427951672.jpg" />
<meta name="twitter:creator" content="@marc_etienne_" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" href="https://www.welivesecurity.com/fr/2021/08/31/faille-preuve-vaccination-quebec-vaxicode-verif/" hreflang="fr" />
<link rel="alternate" href="https://www.welivesecurity.com/2021/08/31/flaw-quebec-vaccine-passport-vaxicode-verif-analysis/" hreflang="en" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2021/08/31/faille-preuve-vaccination-quebec-vaxicode-verif/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/2021/08/31/faille-preuve-vaccination-quebec-vaxicode-verif/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/08/shutterstock_2001120401.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Flaw in the Quebec vaccine passport: analysis</h1>
<div class="excerpt">ESET's cybersecurity expert Marc-Étienne Léveillé analyses in-depth the Quebec's vaccine proof apps VaxiCode and VaxiCode Verif.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2013/06/Marc-Etienne-M.Leveille.png" alt="Marc-Etienne M.Léveillé">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-08-31 21:21:07">31 Aug 2021 - 09:21PM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F31%2Fflaw-quebec-vaccine-passport-vaxicode-verif-analysis%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F31%2Fflaw-quebec-vaccine-passport-vaxicode-verif-analysis%2F&text=Flaw in the Quebec vaccine passport: analysis%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F31%2Fflaw-quebec-vaccine-passport-vaxicode-verif-analysis%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>ESET&#8217;s cybersecurity expert Marc-Étienne Léveillé analyses in-depth the Quebec&#8217;s vaccine proof apps VaxiCode and VaxiCode Verif.</p>
                            </div>

                            <p>The launch of the mobile applications allowing the storage and verification of the vaccination passport by the Quebec government (VaxiCode and VaxiCode Verif) has caused a lot of ink to flow last week. It is with good reason; the VaxiCode Verif app will be used by all non-essential service merchants as of September 1, 2021.</p>
<p>Like many other experts, I analyzed the contents of the QR code as soon as I received it during my first vaccination last May. Last week, I also analyzed the two applications established by the Quebec government and developed by Akinox.</p>
<p>This blogpost explains how the vaccine passport system set up by the Quebec government works from a technical point of view, as well as details about the vulnerability we found in VaxiCode Verif that allowed the application to be forced to recognize non-government issued QR codes as valid. At this time, it is impossible to confirm that this is the same vulnerability found by &#8220;Louis&#8221; as reported by <a href="https://ici.radio-canada.ca/nouvelle/1819589/passeport-vaccinal-faille-application-vaxicode">Radio-Canada last Friday,</a> since no technical details have yet been released.</p>
<p>We informed Akinox about the vulnerability we found on Sunday, and we have confirmed that the VaxiCode Verif 1.0.2 update for iOS released in the last few days fixes the flaw. The Android version of the apps has not yet been analyzed, but VaxiCode and VaxiCode Verif use the <a href="https://expo.dev/">Expo</a> framework that allows iOS and Android apps to be produced using the same source code. Therefore, the applications on both platforms are probably equivalent.</p>
<h2>Let&#8217;s deep dive in the Quebec vaccine passport’s content</h2>
<p>First, let&#8217;s look at what the QR code contains. Generally speaking, a QR code includes only text. It is often a URL.</p>
<p><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_qr-final.jpg"><img class="aligncenter size-large wp-image-154422" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_qr-final-1024x472.jpg" alt="" width="1024" height="472" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_qr-final-1024x472.jpg 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_qr-final-300x138.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_qr-final-768x354.jpg 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p>But let&#8217;s go back to the Quebec vaccine passport application. We notice that the URL contained in this QR code begins with &#8220;sh:/&#8221;. &#8220;shc&#8221; is actually an acronym for <a href="https://smarthealth.cards/">SMART Health Cards</a>, a specification that defines a format for exchanging information about a person&#8217;s vaccination status. This specification was born in 2021 with the objective of being able to issue this famous vaccine passport and to be able to verify its veracity. This is the same standard that has been chosen by several American states, including California, New York and Louisiana. The development of this specification is being spearheaded by the <a href="https://vci.org/about">Vaccination Credential Initiative</a>, a coalition of public and private organizations working to enable the secure deployment of the passport around the world. Akinox, the company that developed VaxiCode and VaxiCode Verif for the Quebec government, is a member of this organization.</p>
<p>The specification describes how to decode the numbers in the URL into readable content.</p>
<p><a href="https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_jwt-final.jpg"><img class="aligncenter size-large wp-image-154421" src="https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_jwt-final-1024x304.jpg" alt="" width="1024" height="304" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_jwt-final-1024x304.jpg 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_jwt-final-300x89.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/08/el_barto_jwt-final-768x228.jpg 768w" sizes="(max-width: 1024px) 100vw, 1024px" /></a></p>
<p>The information is decoded into a JSON Web Token (JWT), or more specifically a JSON Web Signature (JWS) since it is a signed token. The SHC specification did not reinvent the wheel: JWT is an existing technology for exchanging encrypted or digitally signed information.</p>
<p>If you would like to know more about the contents of your vaccine passport, you can easily inspected it from a mobile device using an <a href="https://fproulx.github.io/shc-covid19-decoder/">online tool</a> developed by François Proulx.</p>
<h2>Should these informations be encrypted?</h2>
<p>Many have suggested encrypting the information in the QR code. This may seem like a good way to protect it; however, it would be much too easy to decipher this information. The information must be understood by VeriCode Veri, so the application should contain the decryption key. Once the key is extracted, anyone could decrypt the QR codes. This would give a false impression of security and lead to more criticism from the public.</p>
<p>For these reasons, the CHS protocol does not provide an encryption method. However, it does require a digital signature.</p>
<h2>How the digital signature works?</h2>
<p>The digital signature is based on <a href="https://en.wikipedia.org/wiki/Public-key_cryptography#:~:text=Public-key%20cryptography%2C%20or%20asymmetric%20cryptography%2C%20is%20a%20cryptographic,never%20be%20known%20by%20any%20except%20the%20owner%29.">asymmetric cryptography</a>, which means that a key pair is used. This pair is composed of a private key, which only the issuer (here, the Government of Quebec) has in its possession to sign data, and a so-called public key, which verifies that the signature has been made with the private key.</p>
<p>Asymmetric cryptography is used, among other things, to encrypt communications on the Internet. There are no known attacks to sign without having the private key or to guess the private key from the public key.</p>
<p>This also means that the priority is to protect this private key at all costs. Compromising this key would allow the generation of cryptographically valid QR codes. This is not the case with the flaw we found: we did not need the private key to forge a vaccine proof that VaxiCode Verif deemed valid. Rather, the problem was in the implementation of the verification algorithm in VaxiCode Verif.</p>
<h2>What exactly was the flaw in VaxiCode Verif?</h2>
<p>The SMART Health Cards specification was designed to allow for the possibility of multiple vaccine evidence issuers. This reflects the reality that each country or region is responsible for issuing its own evidence. Therefore, each government has its own pair of keys to sign and verify passports.</p>
<p>The CHS specification requires the issuing entity to make its public key(s) available on the Internet. The vaccine proof contains a URL to the issuer&#8217;s website in the &#8220;iss&#8221; (short for <em>issuer</em>) field. A verifying application should find the issuer&#8217;s public key(s) by concatenating &#8220;.well-known/jwks.json&#8221; to this URL.</p>
<p>The <a href="https://spec.smarthealth.cards/#trust">specification does <em>not</em></a> define (at least for now) a way to determine if the issuer is trustworthy.</p>
<p>Akinox has chosen to include the Quebec government&#8217;s public key in VaxiCode and VaxiCode Verif. The application uses this key when the issuer is the Quebec government (specifically if &#8220;iss&#8221; is &#8220;https://covid19.quebec.ca/PreuveVaccinaleApi/issuer&#8221;). However, the code to download third party issuer keys is still in the application, even though it is not required.</p>
<p>The vulnerability lies in the fact that once a public key is downloaded, it is used to validate any other passport, without checking if it matches the content of the issuer field (&#8220;iss&#8221;).</p>
<p>Here is an attack scenario to display a forged vaccine proof as valid:</p>
<ol>
<li>An attacker generates a key pair and makes the public key available at <a href="https://example.org/.well-known/jwks.json">https://example.org/.well-known/jwks.json</a></li>
<li>He generates two SMART Health Cards in the form of QR codes:
<ol>
<li>The first is created with arbitrary content, provided the &#8220;iss&#8221; is « <a href="https://example.org">https://example.org</a>».</li>
<li>The second one is created with the personal information of the person who wants to impersonate as vaccinated as well as the &#8220;iss&#8221; field pointing to the legitimate government domain, and signs it with the key generated in step 1.</li>
</ol>
</li>
<li>During a verification of the vaccine passport, the attacker first presents the first QR code. This validation will be rejected by VaxiCode Verif, but will force the application to download the attacker&#8217;s public key and add it to its trusted keychain.</li>
<li>The attacker will then present the second QR code, which will be validated as legitimate by VaxiCode Verif.</li>
</ol>
<p>The version 1.0.2 available since Sunday on the Apple App Store fixes the problem. This update completely removes the functionality of downloading public keys from the issuer&#8217;s URL.</p>
<h2>What could have been done better?</h2>
<p>The authorities and developers responsible for deploying the vaccine proof are under a restriction that is difficult to mitigate: time. The entire development and deployment of proof of vaccination in Quebec was done in a few months. While there have been some shortcomings, the system is working.</p>
<p>Quebec government may have missed a good opportunity to publish the source code of the applications it produced for the sake of transparency. After all, there is nothing to hide and nothing secret about these applications. The rapid discovery of flaws has shown that analysis by a larger number of experts improves the security of this type of application. The publication of the source code and its analysis by experts might have avoided scandals that could affect the public&#8217;s confidence, since the whole population would have been able to check the security by itself.</p>
<p>Some people also feel that the personal data contained in the Quebec vaccine passport is excessive. In this regard, it would have been possible to produce a lighter version of the passport containing less information. That said, this lighter version could potentially be unusable outside of Quebec, since the rules for determining whether a person is protected can change from region to region (which vaccines are considered valid, how many doses, etc.).</p>
<p>This is <a href="https://www.bag.admin.ch/bag/en/home/krankheiten/ausbrueche-epidemien-pandemien/aktuelle-ausbrueche-epidemien/novel-cov/covid-zertifikat.html#-518758716">what Switzerland chose</a> with its &#8220;COVID light certificate&#8221;. It should also be noted that the source code of the Swiss applications has also been available for several months.</p>
<p>We did not test the servers allowing the issuance of vaccine passports, because we have neither the mandate nor the permission from the Quebec government or Akinox to do so. Unlike the analysis of the applications provided by Quebec, this would constitute an attack on a remote system that could result in a risk of service interruption.</p>
<h2>Conclusion</h2>
<p>Our analysis first looked at the development history of the CHS specification, which was developed internationally specifically for issuing COVID-19 vaccination confirmations. We then explained the importance of using asymmetric cryptography for signing data, and in this case, to ensure the validity of the vaccination proofs provided. However, we discovered a flaw in the implementation of the verification algorithm, which allowed vaccine proofs displayed as legitimate by VaxiCode Verif to be forged. We notified Akinox of this flaw, and it was fixed as soon as the application was updated, which was within a few days. Finally, we pointed out the potential benefits of greater transparency with respect to the source code of these applications.</p>
<p>As a result of this analysis, I believe that, although VaxiCode Verif had some problems at its release, the technologies on which the system is based are solid. The idea of using existing standards and technologies is in my opinion a good decision. It ensures both signature security and interoperability between regions using the SMART Health Cards protocol. In my opinion, a flaw in the system that denied a valid vaccine passport would have a much more serious impact than the reverse, and that is not the case here.</p>
<p>That the problem was fixed in just a few days shows that all parties want a secure system. There are always areas for improvement, but the use of the digital signature proposed by SHC is, to date, secure.</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-08-31 21:21:07">31 Aug 2021 - 09:21PM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/covid-19/" class="category-tag-btn">COVID-19</a>                                                <a href="https://www.welivesecurity.com/2021/08/31/vaccine-passports-is-your-personal-data-in-safe-hands/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/covid19-vaccine-passport-app-certificate-vaccination-623x415.jpg"
                                                         alt="Flaw in the Quebec vaccine passport: analysis">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/31/vaccine-passports-is-your-personal-data-in-safe-hands/">
                                                    Vaccine passports: Is your personal data in safe hands?                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/covid-19/" class="category-tag-btn">COVID-19</a>                                                <a href="https://www.welivesecurity.com/2021/08/18/health-authorities-40-countries-targeted-covid19-vaccine-scammers/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/interpol-covid19-vaccine-scams-authorities-623x415.jpg"
                                                         alt="Flaw in the Quebec vaccine passport: analysis">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/18/health-authorities-40-countries-targeted-covid19-vaccine-scammers/">
                                                    Health authorities in 40 countries targeted by COVID-19 vaccine scammers                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/covid-19/" class="category-tag-btn">COVID-19</a>                                                <a href="https://www.welivesecurity.com/2021/08/12/examining-threats-device-security-hybrid-workplace/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/hybrid-working-workplace-device-data-cybersecurity-623x415.jpg"
                                                         alt="Flaw in the Quebec vaccine passport: analysis">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/12/examining-threats-device-security-hybrid-workplace/">
                                                    Examining threats to device security in the hybrid workplace                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/covid-19/" class="category-tag-btn">COVID-19</a>                                                <a href="https://www.welivesecurity.com/2021/08/05/why-cloud-security-key-unlocking-value-hybrid-working/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/hybrid-working-cloud-security-key-unlocking-business-value-623x415.jpg"
                                                         alt="Flaw in the Quebec vaccine passport: analysis">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/05/why-cloud-security-key-unlocking-value-hybrid-working/">
                                                    Why cloud security is the key to unlocking value from hybrid working                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F31%2Fflaw-quebec-vaccine-passport-vaxicode-verif-analysis%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F31%2Fflaw-quebec-vaccine-passport-vaxicode-verif-analysis%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F08%2F31%2Fflaw-quebec-vaccine-passport-vaxicode-verif-analysis%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.4.1.0bbcde.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"154420 https:\/\/backend.welivesecurity.com\/?p=154420","disqusShortname":"welivesecurity","disqusTitle":"Flaw in the Quebec vaccine passport: analysis","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/08\/31\/flaw-quebec-vaccine-passport-vaxicode-verif-analysis\/","postId":"154420"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
