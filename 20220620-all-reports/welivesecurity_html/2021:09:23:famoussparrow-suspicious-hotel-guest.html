<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=09d01dd87b618f2315ce" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Tahseen Bin Taj',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>FamousSparrow: A&nbsp;suspicious hotel guest | WeLiveSecurity</title>
<meta name="description" content="ESET researchers uncover a cyberespionage group, FamousSparrow, that has targeted hotels, governments, and private companies worldwide since at least 2019."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/09/23/famoussparrow-suspicious-hotel-guest/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="FamousSparrow: A&nbsp;suspicious hotel guest | WeLiveSecurity" />
<meta property="og:description" content="ESET researchers uncover a cyberespionage group, FamousSparrow, that has targeted hotels, governments, and private companies worldwide since at least 2019." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/09/23/famoussparrow-suspicious-hotel-guest/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2021-09-23T09:30:19+00:00" />
<meta property="article:modified_time" content="2021-09-23T09:31:14+00:00" />
<meta property="og:updated_time" content="2021-09-23T09:31:14+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/09/eset-research-famoussparrow-apt-group-proxylogon.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/09/eset-research-famoussparrow-apt-group-proxylogon.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="415" />
<meta property="og:image:alt" content="eset-research-famoussparrow-apt-group-proxylogon" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET researchers uncover a cyberespionage group, FamousSparrow, that has targeted hotels, governments, and private companies worldwide since at least 2019." />
<meta name="twitter:title" content="FamousSparrow: A&nbsp;suspicious hotel guest | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/09/eset-research-famoussparrow-apt-group-proxylogon.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/2021/09/23/famoussparrow-suspicious-hotel-guest/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2021/09/23/famoussparrow-cyberspionage-statt-zimmer-service/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2021/09/23/famoussparrow-cyberspionage-statt-zimmer-service/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2021/09/23/famoussparrow-cyberspionage-statt-zimmer-service/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/09/famoussparrow-apt-group-targeting-hotels.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>FamousSparrow: A&nbsp;suspicious hotel guest</h1>
<div class="excerpt">Yet another APT group that exploited the ProxyLogon vulnerability in March 2021</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/tahseentaj/" title="Tahseen Bin Taj">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/09/Tahseen_Bin_Taj-222x179.jpg" alt="Tahseen Bin Taj">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/tahseentaj/" title="Tahseen Bin Taj">
                    Tahseen Bin Taj                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/02/Matthieu-Faou-222x179.jpg" alt="Matthieu Faou">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-09-23 11:30:19">23 Sep 2021 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F09%2F23%2Ffamoussparrow-suspicious-hotel-guest%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F09%2F23%2Ffamoussparrow-suspicious-hotel-guest%2F&text=FamousSparrow: A&nbsp;suspicious hotel guest%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F09%2F23%2Ffamoussparrow-suspicious-hotel-guest%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Yet another APT group that exploited the ProxyLogon vulnerability in March 2021</p>
                            </div>

                            <p>ESET researchers have uncovered a new cyberespionage group targeting hotels, governments, and private companies worldwide. We have named this group FamousSparrow and we believe it has been active since at least 2019.</p>
<p>Reviewing telemetry data during our investigation, we realized that FamousSparrow leveraged the Microsoft Exchange vulnerabilities known as ProxyLogon that <a href="https://www.welivesecurity.com/2021/03/10/exchange-servers-under-siege-10-apt-groups/" target="_blank" rel="noopener">we described extensively in March 2021</a>. As a reminder, this remote code execution vulnerability was used by more than 10 APT groups to take over Exchange mail servers worldwide. According to ESET telemetry, FamousSparrow started to exploit the vulnerabilities on March 3<sup>rd</sup>, 2021, the day following the release of the patch, so it is yet another APT group that had access to the ProxyLogon remote code execution vulnerability in March 2021.</p>
<p>In this blogpost we will discuss the attribution to FamousSparrow and the group’s victimology. This will be followed by a detailed technical analysis of the group’s main backdoor that we have named SparrowDoor.</p>
<h2>A note on attribution</h2>
<p>FamousSparrow is a group that we consider as the only current user of the custom backdoor, SparrowDoor (which we cover in detail in the later sections of this blogpost). It also uses two custom versions of Mimikatz (see the<em> <a href="#Indicators of Compromise">Indicators of Compromise</a></em> section) that could be used to connect incidents to this group.</p>
<p>While we consider FamousSparrow to be a separate entity, we found connections to other known APT groups. In one case, attackers deployed a variant of Motnug that is a loader used by <a href="https://www.welivesecurity.com/2021/08/24/sidewalk-may-be-as-dangerous-as-crosswalk/" target="_blank" rel="noopener">SparklingGoblin</a>. In another case, on a machine compromised by FamousSparrow, we found a running Metasploit with <span style="font-family: courier new, courier, monospace;">cdn.kkxx888666[.]com</span> as its C&amp;C server. This domain is related to a group known as <a href="https://documents.trendmicro.com/assets/white_papers/wp-uncovering-DRBcontrol.pdf" target="_blank" rel="noopener">DRDControl</a>.</p>
<h2>Victimology</h2>
<p>The group has been active since at least August 2019 and it mainly targets hotels worldwide. In addition, we have seen a few targets in other sectors such as governments, international organizations, engineering companies and law firms in the following countries:</p>
<ul>
<li>Brazil</li>
<li>Burkina Faso</li>
<li>South Africa</li>
<li>Canada</li>
<li>Israel</li>
<li>France</li>
<li>Guatemala</li>
<li>Lithuania</li>
<li>Saudi Arabia</li>
<li>Taiwan</li>
<li>Thailand</li>
<li>United Kingdom</li>
</ul>
<div id="attachment_155050" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-1.-Geographic-distribution-of-FamousSparrow-targets.png"><img class="wp-image-155050" src="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-1.-Geographic-distribution-of-FamousSparrow-targets-300x231.png" alt="Figure 1. Geographic distribution of FamousSparrow targets" width="750" height="577" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-1.-Geographic-distribution-of-FamousSparrow-targets-300x231.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-1.-Geographic-distribution-of-FamousSparrow-targets-768x591.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-1.-Geographic-distribution-of-FamousSparrow-targets-1024x788.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-1.-Geographic-distribution-of-FamousSparrow-targets.png 1429w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><em>Figure 1. Geographic distribution of FamousSparrow targets</em></p></div>
<h2>Compromise vector</h2>
<p>In a few cases, we were able to find the initial compromise vector used by FamousSparrow and these systems were compromised through vulnerable internet-facing web applications. We believe FamousSparrow exploited known remote code execution vulnerabilities in Microsoft Exchange (including ProxyLogon in March 2021), Microsoft SharePoint and Oracle Opera (business software for hotel management), which were used to drop various malicious samples.</p>
<p>Once the server is compromised, attackers deploy several custom tools:</p>
<ul>
<li>A Mimikatz variant</li>
<li>A small utility that drops <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/procdump">ProcDump</a> on disk and uses it to dump the <span style="font-family: courier new, courier, monospace;">lsass</span> process, probably in order to gather in-memory secrets, such as credentials</li>
<li><a href="http://www.unixwiz.net/tools/nbtscan.html" target="_blank" rel="noopener">Nbtscan</a>, a NetBIOS scanner</li>
<li>A loader for the SparrowDoor backdoor</li>
</ul>
<p>Through our telemetry, we were able to recover only the loader component (SHA-1: <span style="font-family: courier new, courier, monospace;">E2B0851E2E281CC7BCA3D6D9B2FA0C4B7AC5A02B</span>). We also found a very similar loader on VirusTotal (SHA-1: <span style="font-family: courier new, courier, monospace;">BB2F5B573AC7A761015DAAD0B7FF03B294DC60F6</span>) that allowed us to find the missing components, including SparrowDoor.</p>
<h2>SparrowDoor</h2>
<h3>Loader</h3>
<p>SparrowDoor is initially loaded via DLL search order hijacking, using three elements – a legitimate K7 Computing executable (<span style="font-family: courier new, courier, monospace;">Indexer.exe</span>) used as the DLL hijacking host, a malicious DLL (<span style="font-family: courier new, courier, monospace;">K7UI.dll</span>), and encrypted shellcode (<span style="font-family: courier new, courier, monospace;">MpSvc.dll</span>) – all of which are dropped in <span style="font-family: courier new, courier, monospace;">%PROGRAMDATA%\Software\</span>. It can be assumed that the command line argument used with the initial SparrowDoor execution, in order to set up persistence, is either nothing or anything but <span style="font-family: courier new, courier, monospace;">-i</span>, <span style="font-family: courier new, courier, monospace;">-k</span> or <span style="font-family: courier new, courier, monospace;">-d</span> (the functionalities of these three arguments are explained below). Once persistence is set up, SparrowDoor is executed with the <span style="font-family: courier new, courier, monospace;">-i</span> command line argument. Refer to Figure 2 for a brief overview of the flow of the initial loading process. If you would like an in-depth look into the loading process, continue reading!</p>
<div id="attachment_155051" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-2.-SparrowDoor-staging.png"><img class="wp-image-155051" src="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-2.-SparrowDoor-staging-174x300.png" alt="Figure 2. SparrowDoor staging" width="750" height="1290" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-2.-SparrowDoor-staging-174x300.png 174w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-2.-SparrowDoor-staging-768x1321.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-2.-SparrowDoor-staging-595x1024.png 595w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-2.-SparrowDoor-staging.png 872w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><em>Figure 2. SparrowDoor staging</em></p></div>
<p>The legitimate executable, <span style="font-family: courier new, courier, monospace;">Indexer.exe</span>, requires the library <span style="font-family: courier new, courier, monospace;">K7UI.dll</span> to operate. Therefore, the OS looks for the DLL file in directories in the prescribed load order. Since the directory where the <span style="font-family: courier new, courier, monospace;">Indexer.exe</span> file is stored is at the top priority in the load order, it is exposed to DLL search-order hijacking. And that is exactly how the malware gets loaded. <span style="font-family: courier new, courier, monospace;">Indexer.exe</span> loads the malicious <span style="font-family: courier new, courier, monospace;">K7UI.dll</span>, which in turn patches the code in <span style="font-family: courier new, courier, monospace;">Indexer.exe</span> (from <span style="font-family: courier new, courier, monospace;">call WinMain</span> to <span style="font-family: courier new, courier, monospace;">jmp K7UI.0x100010D0</span>) and then returns to <span style="font-family: courier new, courier, monospace;">Indexer.exe</span>. As a result of this, <span style="font-family: courier new, courier, monospace;">Indexer.exe</span> ends up running a subroutine in <span style="font-family: courier new, courier, monospace;">K7UI.dll</span> (located in the <span style="font-family: courier new, courier, monospace;">.text</span> section) instead of calling <span style="font-family: courier new, courier, monospace;">WinMain</span>. We will refer to this subroutine as <strong>launcher</strong>. The functionality of <strong>launcher</strong> is to load <span style="font-family: courier new, courier, monospace;">MpSvc.dll</span> (the encrypted shellcode) into memory from the directory that also stores <span style="font-family: courier new, courier, monospace;">Indexer.exe</span>, decrypt the content and then execute the shellcode.</p>
<p>The shellcode (<span style="font-family: courier new, courier, monospace;">MpSvc.dll</span>) is encrypted using four-byte XOR with the key being the first four bytes of the file.</p>
<p>The <span style="font-family: courier new, courier, monospace;">MpSvc.dll</span> shellcode loads various libraries responsible for building a PE structure and locates the addresses of the functions to be used. After that, it allocates RWX memory and copies various locations in the shellcode into it (in order to build the PE structure). It also resolves the imports of several functions from different libraries. Finally, it executes the newly built backdoor PE from the entry point. Interestingly, this rebuilt executable image has no PE headers, as shown in Figure 2, so the loader executes the backdoor by jumping to the entry point at a hardcoded offset within the allocated memory.</p>
<div id="attachment_155052" style="width: 706px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-3.-The-PE-header-is-missing-in-the-newly-built-backdoor-from-the-MpSvc.dll-shellcode.png"><img class="wp-image-155052 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-3.-The-PE-header-is-missing-in-the-newly-built-backdoor-from-the-MpSvc.dll-shellcode.png" alt="Figure 3. The PE header is missing in the newly built backdoor from the MpSvc.dll shellcode" width="696" height="959" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-3.-The-PE-header-is-missing-in-the-newly-built-backdoor-from-the-MpSvc.dll-shellcode.png 696w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-3.-The-PE-header-is-missing-in-the-newly-built-backdoor-from-the-MpSvc.dll-shellcode-218x300.png 218w" sizes="(max-width: 696px) 100vw, 696px" /></a><p class="wp-caption-text"><em>Figure 3. The PE header is missing in the newly built backdoor from the MpSvc.dll shellcode</em></p></div>
<h3>Backdooor</h3>
<p>The arguments passed to the backdoor are inherited from the arguments passed to <span style="font-family: courier new, courier, monospace;">Indexer.exe</span>, or to any other binary that gets the shellcode/backdoor injected. The tasks performed by the backdoor after an argument is specified are shown in Table 1.</p>
<p><em>Table 1. Actions performed based on the command line arguments provided to SparrowDoor</em></p>

<table id="tablepress-1000" class="tablepress tablepress-id-1000">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Argument</th><th class="column-2">Action</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">No argument or not matching the following</td><td class="column-2">Persistence is set through the registry Run key and a service, which is created and started using the configuration data (described in the next section) hardcoded in the binary. Finally, the backdoor is restarted with the <span style="font-family: courier new, courier, monospace;">-i</span> switch.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">-i</span></td><td class="column-2">The backdoor is restarted with the <span style="font-family: courier new, courier, monospace;">-k</span> switch.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">-k</span></td><td class="column-2">The backdoor interpreter (described later) is called with a  <strong>kill switch</strong>.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">-d</span></td><td class="column-2">The backdoor interpreter is called without a <strong>kill switch</strong>.</td>
</tr>
</tbody>
</table>

<p><em>Note:</em></p>
<ol>
<li><em>The <strong>kill switch</strong> gives the backdoor the privilege to uninstall or restart SparrowDoor.</em></li>
<li><em>The backdoor interpreter gets called regardless of the argument used because it will always end up with a <span style="font-family: courier new, courier, monospace;">-k</span> or <span style="font-family: courier new, courier, monospace;">-d</span> argument.</em></li>
</ol>
<h4><strong><em>Configuration data</em></strong></h4>
<p>The configuration is found in the binary and is decrypted using the multi-byte XOR key <span style="font-family: courier new, courier, monospace;">^&amp;32yUgf</span>. The configuration has the following format:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-614c671f81ffa335887088" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover wrap" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea  class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
struct config
{
     char domain[64];
     char user [64];
     char pass[64];
     char ip[64];
     char port[2];
     char serviceName[64];
     char serviceDisplayName[128];
     char serviceDescription[128];
};</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-614c671f81ffa335887088-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-614c671f81ffa335887088-2">2</div><div class="crayon-num" data-line="crayon-614c671f81ffa335887088-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-614c671f81ffa335887088-4">4</div><div class="crayon-num" data-line="crayon-614c671f81ffa335887088-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-614c671f81ffa335887088-6">6</div><div class="crayon-num" data-line="crayon-614c671f81ffa335887088-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-614c671f81ffa335887088-8">8</div><div class="crayon-num" data-line="crayon-614c671f81ffa335887088-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-614c671f81ffa335887088-10">10</div><div class="crayon-num" data-line="crayon-614c671f81ffa335887088-11">11</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-614c671f81ffa335887088-1"><span class="crayon-t">struct</span><span class="crayon-h"> </span><span class="crayon-e">config</span></div><div class="crayon-line crayon-striped-line" id="crayon-614c671f81ffa335887088-2"><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-614c671f81ffa335887088-3"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-v">domain</span><span class="crayon-sy">[</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-614c671f81ffa335887088-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-i">user</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-614c671f81ffa335887088-5"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-v">pass</span><span class="crayon-sy">[</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-614c671f81ffa335887088-6"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-v">ip</span><span class="crayon-sy">[</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-614c671f81ffa335887088-7"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-v">port</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-614c671f81ffa335887088-8"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-v">serviceName</span><span class="crayon-sy">[</span><span class="crayon-cn">64</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-614c671f81ffa335887088-9"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-v">serviceDisplayName</span><span class="crayon-sy">[</span><span class="crayon-cn">128</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-614c671f81ffa335887088-10"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-t">char</span><span class="crayon-h"> </span><span class="crayon-v">serviceDescription</span><span class="crayon-sy">[</span><span class="crayon-cn">128</span><span class="crayon-sy">]</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-614c671f81ffa335887088-11"><span class="crayon-sy">}</span><span class="crayon-sy">;</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>The decrypted values are shown in Table 2.</p>
<p><em>Table 2. The key-value pairs of the configuration along with a description of their purpose</em></p>

<table id="tablepress-1001" class="tablepress tablepress-id-1001">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Key</th><th class="column-2">Value</th><th class="column-3">Purpose</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">domain</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">credits.offices-analytics[.]com</span></td><td class="column-3">C&amp;C server domain</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">user</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">user</span></td><td rowspan="4" class="column-3">Proxy settings used to connect to C&amp;C server</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">pass</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">pass</span></td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">ip</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">127.1.1.1</span></td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">port</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">8080</span></td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">serviceName</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">WSearchIndex</span></td><td rowspan="3" class="column-3">Information used for creating a service to set up persistence. Also, note that the <span style="font-family: courier new, courier, monospace;">serviceName</span> is used as the value name under the Run key in the registry</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">serviceDisplayName</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Windows Search Index</span></td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">serviceDescription</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Provides content indexing, property caching, and search results for files, e-mail, and other content.</span></td>
</tr>
</tbody>
</table>

<p>The connections could be either through a proxy or not, and they connect to the C&amp;C server over port 443 (HTTPS). So, the communication should be encrypted using TLS. During the first attempt to contact the C&amp;C server, SparrowDoor checks whether a connection can be established without using a proxy, and if it can’t, then the data is sent through a proxy. All outgoing data is encrypted using the XOR key <span style="font-family: courier new, courier, monospace;">hH7@83#mi</span> and all incoming data is decrypted using the XOR key <span style="font-family: courier new, courier, monospace;">h*^4hFa</span>. The data has a structure that starts with a Command ID, followed by the length of the ensuing encrypted data, followed by the encrypted data.</p>
<p>Figure 4 shows an example of how the data is sent to the C&amp;C server (in this case it is sending system information), while Figure 5 shows the plaintext form of the same data payload.</p>
<div id="attachment_155054" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-4.-A-Wireshark-dump-showing-the-data-POSTed-by-the-backdoor.png"><img class="wp-image-155054" src="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-4.-A-Wireshark-dump-showing-the-data-POSTed-by-the-backdoor-300x201.png" alt="Figure 4. A Wireshark dump showing the data POSTed by the backdoor" width="750" height="503" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-4.-A-Wireshark-dump-showing-the-data-POSTed-by-the-backdoor-300x201.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-4.-A-Wireshark-dump-showing-the-data-POSTed-by-the-backdoor-768x515.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-4.-A-Wireshark-dump-showing-the-data-POSTed-by-the-backdoor-114x76.png 114w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-4.-A-Wireshark-dump-showing-the-data-POSTed-by-the-backdoor-97x65.png 97w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-4.-A-Wireshark-dump-showing-the-data-POSTed-by-the-backdoor.png 837w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><em>Figure 4. A Wireshark dump showing the data POSTed by the backdoor</em></p></div>
<div id="attachment_155055" style="width: 760px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-5.-The-decrypted-data-containing-system-information.png"><img class="wp-image-155055" src="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-5.-The-decrypted-data-containing-system-information-300x109.png" alt="Figure 5. The decrypted data containing system information" width="750" height="273" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-5.-The-decrypted-data-containing-system-information-300x109.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-5.-The-decrypted-data-containing-system-information-768x280.png 768w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-5.-The-decrypted-data-containing-system-information-1024x373.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/09/Figure-5.-The-decrypted-data-containing-system-information.png 1516w" sizes="(max-width: 750px) 100vw, 750px" /></a><p class="wp-caption-text"><em>Figure 5. The decrypted data containing system information</em></p></div>
<p><strong>Victim’s local IP address</strong> in this case can be converted to decimal, giving 192.168.42.1.</p>
<p><strong>Session ID</strong> is the Remote Desktop Services session ID associated with the backdoor process, found using the <a href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-processidtosessionid" target="_blank" rel="noopener">ProcessIdToSessionId</a> Windows API call.</p>
<p>The <strong>systemInfoHash</strong> is computed via the <a href="http://www.cse.yorku.ca/~oz/hash.html#sdbm" target="_blank" rel="noopener">sdbm hash algorithm</a>, using the username, computer name, host addresses and the session ID.</p>
<h4><em><strong>Backdoor interpreter function</strong></em></h4>
<p>Privilege escalation is performed in this function by adjusting the access token of the SparrowDoor process to enable <span style="font-family: courier new, courier, monospace;">SeDebugPrivilege</span>. After that, the <span style="font-family: courier new, courier, monospace;">shutdown</span> function (<span style="font-family: courier new, courier, monospace;">Ws2_32.dll</span>) is patched to prevent disabling sends and receives on a socket and the <span style="font-family: courier new, courier, monospace;">closesocket</span> function (<span style="font-family: courier new, courier, monospace;">Ws2_32.dll</span>) is patched to enable the <span style="font-family: courier new, courier, monospace;">DONT_LINGER</span> option first to close the socket without waiting for pending data to be sent or received. Finally, system information is sent to the C&amp;C server (as seen in Figures 4 and 5 above) to receive data back in return.</p>
<p>Based on the Command ID field in the data received from the C&amp;C server, the backdoor can perform different malicious actions that are detailed in Table 3.</p>
<p><em>Table 3. Actions performed by SparrowDoor when the corresponding Command IDs are received</em></p>

<table id="tablepress-1002" class="tablepress tablepress-id-1002">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Command&nbsp;ID</th><th class="column-2">Action</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x1C615632</span></td><td class="column-2">The current process is closed.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x1DE15F35</span></td><td class="column-2">A child <span style="font-family: courier new, courier, monospace;">svchost.exe</span> process is spawned with  <span style="font-family: courier new, courier, monospace;">processToken</span> information of the process (Process ID) specified by the C&amp;C server, with argument <span style="font-family: courier new, courier, monospace;">-d</span> and then the shellcode is injected into the process.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x1A6B561A</span></td><td class="column-2">A directory is created using the name provided by the C&amp;C server.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x18695638</span></td><td class="column-2">A file is renamed. Both the file to be renamed and the new name are provided by the C&amp;C server.</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x196A5629</span></td><td class="column-2">A file is deleted, as specified in the incoming data.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x17685647</span></td><td class="column-2">If length of the data is 1, and the data matches <span style="font-family: courier new, courier, monospace;">$</span>, then the length of  <strong>systemInfoHash  </strong>along with an array of drive types are sent.<br />
<br />
If length of the data is greater than 2 and the first 2 bytes of data match <span style="font-family: courier new, courier, monospace;">$\</span>, then information about the files in a specified directory is sent. The information included is the following: file attributes, file size and file write time.</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x15665665</span></td><td class="column-2">A new thread is created to exfiltrate the content of a specified file.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x16675656</span></td><td class="column-2">If the  <strong>kill switch</strong>  is activated, the current persistence settings (registry and service) are removed and the <span style="font-family: courier new, courier, monospace;">Indexer.exe</span> file is executed (to restart the dropper). If not, the backdoor loop is restarted.</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x14655674</span></td><td class="column-2">A new thread is created to write the data to a specified file.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x12635692 </span></td><td class="column-2">If the  <strong>kill switch</strong>  is activated, the persistence settings are removed, and all the files used by SparrowDoor (<span style="font-family: courier new, courier, monospace;">Indexer.exe</span>, <span style="font-family: courier new, courier, monospace;">K7UI.dll</span> and <span style="font-family: courier new, courier, monospace;">MpSvc.dll</span>) are removed. If not, the backdoor loop is restarted.</td>
</tr>
<tr class="row-12 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">0x13645683</span></td><td class="column-2">If the data matches <span style="font-family: courier new, courier, monospace;">"switch ”</span>, then the backdoor is restarted with the  <span style="font-family: courier new, courier, monospace;">-d</span> switch.<br />
<br />
If not, it spawns a <span style="font-family: courier new, courier, monospace;">cmd.exe</span> shell, and sets up named pipes for input and output (used by the C&amp;C server) to establish an interactive reverse shell.<br />
<br />
If the data matches <span style="font-family: courier new, courier, monospace;">Exit\r\n</span>, then the spawned shell is terminated.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">Other</td><td class="column-2">Restarts the backdoor loop.</td>
</tr>
</tbody>
</table>

<h2>Conclusion</h2>
<p>FamousSparrow is yet another APT group that had access to the ProxyLogon remote code execution vulnerability early in March 2021. It has a history of leveraging known vulnerabilities in server applications such as SharePoint and Oracle Opera. This is another reminder that it is critical to patch internet-facing applications quickly, or, if quick patching is not possible, to not expose them to the internet at all.</p>
<p>The targeting, which includes governments worldwide, suggests that FamousSparrow’s intent is espionage. We have highlighted some links to SparklingGoblin and DRBControl, but we don’t consider that these groups are the same.</p>
<p><em>A comprehensive list of Indicators of Compromise (IoCs) and samples can be found in </em><a href="https://github.com/eset/malware-ioc/tree/master/famoussparrow" target="_blank" rel="noopener"><em>our GitHub repository</em></a><em>.</em></p>
<p><em>For any inquiries, or to make sample submissions related to the subject, contact us at threatintel@eset.com.</em></p>
<h2>Indicators of Compromise<a id="Indicators of Compromise"></a></h2>

<table id="tablepress-1003" class="tablepress tablepress-id-1003">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET detection name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">B9601E60F87545441BF8579B2F62668C56507F4A</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">p64.exe<br />
debug.log</span></td><td class="column-3">Win64/Riskware.Mimikatz.H</td><td class="column-4">Mimikatz</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">4DF896624695EA2780552E9EA3C40661DC84EFC8</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">p64.exe<br />
debug.log</span></td><td class="column-3">Win64/Riskware.Mimikatz.H</td><td class="column-4">Mimikatz</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">76C430B55F180A85F4E1A1E40E4A2EA37DB97599</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">dump.exe</span></td><td class="column-3">Win64/Kryptik.BSQ</td><td class="column-4">Lsass dumper</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">873F98CAF234C3A8A9DB18343DAD7B42117E85D4</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">nbtscan.exe</span></td><td class="column-3">Win32/NetTool.Nbtscan.A</td><td class="column-4">Nbtscan</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">FDC44057E87D7C350E6DF84BB72541236A770BA2</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">1.cab</span></td><td class="column-3">Win32/FamousSparrow.A</td><td class="column-4">Dropper</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">C36ECD2E0F38294E1290F4B9B36F602167E33614</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">Indexer.exe</span></td><td class="column-3">-</td><td class="column-4">Legitimate K7 Computing binary</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">BB2F5B573AC7A761015DAAD0B7FF03B294DC60F6</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">K7UI.dll</span></td><td class="column-3">Win32/FamousSparrow.A</td><td class="column-4">Loader</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">23E228D5603B4802398B2E7419187AEF71FF9DD5</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">MpSvc.dll</span></td><td class="column-3"></td><td class="column-4">Encrypted shellcode</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">2560B7E28B322BB7A56D0B1DA1B2652E1EFE76EA</span></td><td class="column-2">-</td><td class="column-3">-</td><td class="column-4">Decrypted shellcode</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">E2B0851E2E281CC7BCA3D6D9B2FA0C4B7AC5A02B</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">K7UI.dll</span></td><td class="column-3">Win32/FamousSparrow.B</td><td class="column-4">Loader</td>
</tr>
</tbody>
</table>


<table id="tablepress-1004" class="tablepress tablepress-id-1004">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Domain</th><th class="column-2">IP address</th><th class="column-3">Comment</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">credits.offices-analytics[.]com</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">45.192.178[.]206</span></td><td class="column-3">SparrowDoor C&amp;C server</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">-</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">27.102.113[.]240</span></td><td class="column-3">Delivery domain</td>
</tr>
</tbody>
</table>

<h2>MITRE ATT&amp;CK techniques</h2>
<p>This table was built using <a href="https://attack.mitre.org/resources/versions/">version 9</a> of the MITRE ATT&amp;CK framework.</p>

<table id="tablepress-1005" class="tablepress tablepress-id-1005">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="3" class="column-1">Resource Development</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1588/005" rel="noopener" target="_blank">T1588.005</a></td><td class="column-3">Obtain Capabilities: Exploits</td><td class="column-4">FamousSparrow used RCE vulnerabilities against Microsoft Exchange, SharePoint and Oracle Opera.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1583/001" rel="noopener" target="_blank">T1583.001</a></td><td class="column-3">Acquire Infrastructure: Domains</td><td class="column-4">FamousSparrow purchased a domain at Hosting Concepts.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1583/004" rel="noopener" target="_blank">T1583.004</a></td><td class="column-3">Acquire Infrastructure: Server</td><td class="column-4">FamousSparrow rented servers at Shanghai Ruisu Network Technology and DAOU TECHNOLOGY.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1190" rel="noopener" target="_blank">T1190</a></td><td class="column-3">Exploit Public-Facing Application</td><td class="column-4">FamousSparrow used RCE vulnerabilities against Microsoft Exchange, SharePoint and Oracle Opera.</td>
</tr>
<tr class="row-6 even">
	<td rowspan="2" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1059/003" rel="noopener" target="_blank">T1059.003</a></td><td class="column-3">Command and Scripting Interpreter: Windows Command Shell</td><td class="column-4">FamousSparrow used <span style="font-family: courier new, courier, monospace;">cmd.exe</span>  to run commands to download and install SparrowDoor.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1203" rel="noopener" target="_blank">T1203</a></td><td class="column-3">Exploitation for Client Execution</td><td class="column-4">FamousSparrow used RCE vulnerabilities in Microsoft Exchange, SharePoint and Oracle Opera to install SparrowDoor.</td>
</tr>
<tr class="row-8 even">
	<td rowspan="3" class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1547/001" rel="noopener" target="_blank">T1547.001</a></td><td class="column-3">Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</td><td class="column-4">SparrowDoor achieves persistence through the HKCU Run registry value <span style="font-family: courier new, courier, monospace;">WSearchIndex = <Path>\Indexer.exe -i</span>  registry entry.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1543/003" rel="noopener" target="_blank">T1543.003</a></td><td class="column-3">Create or Modify System Process: Windows Service</td><td class="column-4">FamousSparrow installs SparrowDoor as a service named  <span style="font-family: courier new, courier, monospace;">WSearchIndex.</td>
</tr>
<tr class="row-10 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1574/001" rel="noopener" target="_blank">T1574.001</a></td><td class="column-3">Hijack Execution Flow: DLL Search Order Hijacking</td><td class="column-4">FamousSparrow loads the malicious <span style="font-family: courier new, courier, monospace;">K7UI.dll</span> through DLL search order hijacking.</td>
</tr>
<tr class="row-11 odd">
	<td rowspan="4" class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1055/001" rel="noopener" target="_blank">T1055.001</a></td><td class="column-3">Process Injection: Dynamic-link Library Injection</td><td class="column-4"><span style="font-family: courier new, courier, monospace;">MpSvc.dll</span> (shellcode) is injected into processes by SparrowDoor.</td>
</tr>
<tr class="row-12 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1134/002" rel="noopener" target="_blank">T1134.002</a></td><td class="column-3">Access Token Manipulation: Create Process with Token</td><td class="column-4">SparrowDoor creates processes with tokens of processes specified by the C&amp;C server, using the <span style="font-family: courier new, courier, monospace;">CreateProcessAsUserA</span> API.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1134" rel="noopener" target="_blank">T1134</a></td><td class="column-3">Access Token Manipulation</td><td class="column-4">SparrowDoor tries to adjust its token privileges to receive <span style="font-family: courier new, courier, monospace;">SeDebugPrivilege</span>.</td>
</tr>
<tr class="row-14 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1027" rel="noopener" target="_blank">T1027</a></td><td class="column-3">Obfuscated Files or Information</td><td class="column-4">The shellcode, <span style="font-family: courier new, courier, monospace;">MpSvc.dll</span>, is encrypted using XOR, along with the config embedded within SparrowDoor.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1">Credentials Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1003/" rel="noopener" target="_blank">T1003</a></td><td class="column-3">OS Credential Dumping</td><td class="column-4">FamousSparrow makes use of a custom Mimikatz version.</td>
</tr>
<tr class="row-16 even">
	<td rowspan="2" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1082" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">SparrowDoor collects the username, computername, RDP session ID, and drive types in the system and sends this data to the C&amp;C server.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1083" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">SparrowDoor can probe files in a specified directory obtaining their names, attributes, sizes and last modified times, and sends this data to the C&amp;C server.</td>
</tr>
<tr class="row-18 even">
	<td class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1005" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">SparrowDoor has the ability to read file contents and exfiltrate them to the C&amp;C server.</td>
</tr>
<tr class="row-19 odd">
	<td rowspan="2" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1071/001" rel="noopener" target="_blank">T1071.001</a></td><td class="column-3">Application Layer Protocol: Web Protocols</td><td class="column-4">SparrowDoor communicates with the C&amp;C server using the HTTPS protocol.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1573/001" rel="noopener" target="_blank">T1573.001</a></td><td class="column-3">Encrypted Channel: Symmetric Cryptography</td><td class="column-4">SparrowDoor encrypts/decrypts communications with its C&amp;C server using different multi-byte XOR keys.</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v9/techniques/T1041" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2 Channel</td><td class="column-4">SparrowDoor exfiltrates data over its C&amp;C channel.</td>
</tr>
</tbody>
</table>

<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=famoussparrow-suspicious-hotel-guest/" target="_blank" rel="noopener"><img class="aligncenter wp-image-152551" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png" alt="" width="899" height="290" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png 918w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-300x97.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-768x248.png 768w" sizes="(max-width: 899px) 100vw, 899px" /></a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/tahseentaj/" title="Tahseen Bin Taj">
                    Tahseen Bin Taj                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/mfaou/" title="Matthieu Faou">
                    Matthieu Faou                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-09-23 11:30:19">23 Sep 2021 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/09/17/numando-latam-banking-trojan/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/09/shutterstock_582222715-623x432-1.jpg"
                                                         alt="FamousSparrow: A&nbsp;suspicious hotel guest">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/09/17/numando-latam-banking-trojan/">
                                                    Numando: Count once, code twice                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/24/sidewalk-may-be-as-dangerous-as-crosswalk/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/winnti-group-sidewalk-backdoor-crosswalk-sparklinggoblin-623x415.jpg"
                                                         alt="FamousSparrow: A&nbsp;suspicious hotel guest">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/24/sidewalk-may-be-as-dangerous-as-crosswalk/">
                                                    The SideWalk may be as dangerous as the CROSSWALK                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/11/iiserpent-malware-driven-seo-fraud-service/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/iis-malware‑iiserpent-seo-fraud-623x415.jpg"
                                                         alt="FamousSparrow: A&nbsp;suspicious hotel guest">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/11/iiserpent-malware-driven-seo-fraud-service/">
                                                    IISerpent: Malware-driven SEO fraud as a service                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/09/iispy-complex-server-side-backdoor-antiforensic-features/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/08/iispy-iis-malware-backdoor-cyberespionage-623x415.jpg"
                                                         alt="FamousSparrow: A&nbsp;suspicious hotel guest">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/09/iispy-complex-server-side-backdoor-antiforensic-features/">
                                                    IISpy: A complex server-side backdoor with anti-forensic features                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F09%2F23%2Ffamoussparrow-suspicious-hotel-guest%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F09%2F23%2Ffamoussparrow-suspicious-hotel-guest%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F09%2F23%2Ffamoussparrow-suspicious-hotel-guest%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.4.1.0bbcde.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"154987 https:\/\/backend.welivesecurity.com\/?p=154987","disqusShortname":"welivesecurity","disqusTitle":"FamousSparrow: A\u00a0suspicious hotel guest","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/09\/23\/famoussparrow-suspicious-hotel-guest\/","postId":"154987"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
