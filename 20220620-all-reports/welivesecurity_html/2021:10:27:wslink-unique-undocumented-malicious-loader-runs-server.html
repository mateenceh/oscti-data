<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=09d01dd87b618f2315ce" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Vladislav Hrčka',
        'ArticleCategory': 'Malware',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Wslink: Unique and undocumented malicious loader that runs as a server | WeLiveSecurity</title>
<meta name="description" content="ESET research discovers a unique loader for Windows binaries that, unlike other such loaders, runs as a server and executes received modules in memory."/>
<link rel="canonical" href="https://www.welivesecurity.com/2021/10/27/wslink-unique-undocumented-malicious-loader-runs-server/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Wslink: Unique and undocumented malicious loader that runs as a server | WeLiveSecurity" />
<meta property="og:description" content="ESET research discovers a unique loader for Windows binaries that, unlike other such loaders, runs as a server and executes received modules in memory." />
<meta property="og:url" content="https://www.welivesecurity.com/2021/10/27/wslink-unique-undocumented-malicious-loader-runs-server/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2021-10-27T09:30:06+00:00" />
<meta property="article:modified_time" content="2021-10-27T09:47:26+00:00" />
<meta property="og:updated_time" content="2021-10-27T09:47:26+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/10/wslink-loader-malware-windows-eset-research.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2021/10/wslink-loader-malware-windows-eset-research.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="415" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="ESET research discovers a unique loader for Windows binaries that, unlike other such loaders, runs as a server and executes received modules in memory." />
<meta name="twitter:title" content="Wslink: Unique and undocumented malicious loader that runs as a server | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2021/10/wslink-loader-malware-windows-eset-research.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">
</head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="col-xs-12 mobile-search-input">
                        <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                    </div>
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="hidden-lg hidden-md hidden-sm hidden-xs col-xs-2 mobile-search imc">
                        <button class="imc">
                            <span class="icomoon icon-icon_search imc"></span>
                        </button>
                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                                <div class="hidden-lg hidden-md col-xs-12 imc">
                                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc dark col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                                </div>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
                <div class="row hidden-sm hidden-xs">
                    <form action="https://www.welivesecurity.com/" class="basic-searchform imc  col-md-12 col-sm-10 col-xs-12" method="get" role="search">
	<div class="search-input clearfix">
		<input type="text" name="s" value="" placeholder="Search..." class="imc">
		<button class="imc">
			<span class="icomoon icon-icon_search imc"></span>
		</button>
	</div>
</form>	                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2021/10/wslink-loader-malware-windows.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Wslink: Unique and undocumented malicious loader that runs as a server</h1>
<div class="excerpt">There are no code, functionality or operational similarities to suggest that this is a tool from a known threat actor</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/vhrcka/" title="Vladislav Hrčka">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2019/11/vladislav-hrcka-222x179.jpg" alt="Vladislav Hrčka">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/vhrcka/" title="Vladislav Hrčka">
                    Vladislav Hrčka                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2021-10-27 11:30:06">27 Oct 2021 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F10%2F27%2Fwslink-unique-undocumented-malicious-loader-runs-server%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F10%2F27%2Fwslink-unique-undocumented-malicious-loader-runs-server%2F&text=Wslink: Unique and undocumented malicious loader that runs as a server%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F10%2F27%2Fwslink-unique-undocumented-malicious-loader-runs-server%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>There are no code, functionality or operational similarities to suggest that this is a tool from a known threat actor</p>
                            </div>

                            <p>ESET researchers have discovered a unique and previously undescribed loader for Windows binaries that, unlike other such loaders, runs as a server and executes received modules in memory. We have named this new malware Wslink after one of its DLLs.</p>
<p>We have seen only a few hits in our telemetry in the past two years, with detections in Central Europe, North America, and the Middle East. The initial compromise vector is not known; most of the samples are packed with MPRESS and some parts of the code are virtualized. Unfortunately, so far we have been unable to obtain any of the modules it is supposed to receive. There are no code, functionality or operational similarities that suggest this is likely to be a tool from a known threat actor group.</p>
<p>The following sections contain analysis of the loader and our own implementation of its client, which was initially made to experiment with detection methods. This client’s source code might be of interest to beginners in malware analysis – it shows how one can reuse and interact with existing functions of previously analyzed malware. The very analysis could also serve as an informative resource documenting this threat for blue teamers.</p>
<h2>Technical analysis</h2>
<p>Wslink runs as a service and listens on all network interfaces on the port specified in the <span style="font-family: courier new, courier, monospace;">ServicePort</span> registry value of the service’s <span style="font-family: courier new, courier, monospace;">Parameters</span> key. The preceding component that registers the Wslink service is not known. Figure 1 depicts the code accepting incoming connections to that port.</p>
<div id="attachment_156130" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-1.-Hex-Rays-decompilation-of-the-loop-accepting-incoming-connections.jpg"><img class="wp-image-156130" src="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-1.-Hex-Rays-decompilation-of-the-loop-accepting-incoming-connections.jpg" alt="" width="700" height="514" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-1.-Hex-Rays-decompilation-of-the-loop-accepting-incoming-connections.jpg 707w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-1.-Hex-Rays-decompilation-of-the-loop-accepting-incoming-connections-300x220.jpg 300w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 1. Hex-Rays decompilation of the loop accepting incoming connections</em></p></div>
<p>Accepting a connection is followed by an RSA handshake with a hardcoded 2048-bit public key to securely exchange both the key and IV to be used for 256-bit AES in CBC mode (see Figure 2). The encrypted module is subsequently received with a unique identifier – signature – and an additional key for its decryption.</p>
<p>Interestingly, the most recently received encrypted module with its signature is stored globally, making it available to all clients. One can save traffic this way – transmit only the key if the signature of the module to be loaded matches the previous one.</p>
<div id="attachment_156131" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-2.-Hex-Rays-decompilation-of-receiving-the-module-and-its-signature.jpg"><img class="wp-image-156131" src="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-2.-Hex-Rays-decompilation-of-receiving-the-module-and-its-signature-300x188.jpg" alt="" width="700" height="439" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-2.-Hex-Rays-decompilation-of-receiving-the-module-and-its-signature-300x188.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-2.-Hex-Rays-decompilation-of-receiving-the-module-and-its-signature-768x481.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-2.-Hex-Rays-decompilation-of-receiving-the-module-and-its-signature-65x42.jpg 65w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-2.-Hex-Rays-decompilation-of-receiving-the-module-and-its-signature-275x172.jpg 275w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-2.-Hex-Rays-decompilation-of-receiving-the-module-and-its-signature.jpg 830w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 2. Hex-Rays decompilation of receiving the module and its signature</em></p></div>
<p>As seen in Figure 3, the decrypted module, which is a regular PE file, is loaded into memory using the <a href="https://github.com/fancycode/MemoryModule" target="_blank" rel="noopener">MemoryModule</a> library and its first export is finally executed. The functions for communication, socket, key and IV are passed in a parameter to the export, enabling the module to exchange messages over the already established connection.</p>
<div id="attachment_156132" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-3.-Hex-Rays-decompilation-of-code-executing-the-received-module-in-memory.jpg"><img class="wp-image-156132" src="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-3.-Hex-Rays-decompilation-of-code-executing-the-received-module-in-memory-300x185.jpg" alt="" width="700" height="431" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-3.-Hex-Rays-decompilation-of-code-executing-the-received-module-in-memory-300x185.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-3.-Hex-Rays-decompilation-of-code-executing-the-received-module-in-memory-768x473.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-3.-Hex-Rays-decompilation-of-code-executing-the-received-module-in-memory-1024x631.jpg 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-3.-Hex-Rays-decompilation-of-code-executing-the-received-module-in-memory.jpg 1057w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 3. Hex-Rays decompilation of code executing the received module in memory</em></p></div>
<h2>Implementation of the client</h2>
<p>Our own implementation of a Wslink client, described below, simply establishes a connection with a modified Wslink server and sends a module that is then decrypted and executed. As our client cannot know the private key matching the public key in any given Wslink server instance, we produced our own key pair and modified the server executable with the public key from that pair and used the private key in our Wslink client implementation.</p>
<p>This client enabled us to reproduce Wslink’s communication and search for unique patterns; it additionally confirmed our findings, because we could mimic its behavior.</p>
<p>Initially some functions for sending/receiving messages are obtained from the original sample (see Figure 4) – we can use them right away and do not have to reimplement them later.</p>
<div id="attachment_156133" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-4.-The-code-for-loading-functions-from-a-Wslink’s-sample.jpg"><img class="wp-image-156133" src="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-4.-The-code-for-loading-functions-from-a-Wslink’s-sample-300x60.jpg" alt="" width="700" height="139" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-4.-The-code-for-loading-functions-from-a-Wslink’s-sample-300x60.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-4.-The-code-for-loading-functions-from-a-Wslink’s-sample-768x152.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-4.-The-code-for-loading-functions-from-a-Wslink’s-sample.jpg 1008w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 4. The code for loading functions from a Wslink’s sample</em></p></div>
<p>Subsequently, our client reads the private RSA key to be used from a file and a connection to the specified IP and port is established. It is expected that an instance of Wslink already listens on the supplied address and port. Naturally, its embedded public key must also be replaced with one whose private key is known.</p>
<p>Our client and the Wslink server continue by performing the handshake that exchanges the key and IV to be used for AES encryption. This consists of three steps, as seen in Figure 5: sending a client hello, receiving the symmetric key with IV, and sending them back to verify successful decryption. From reversing the Wslink binary we learned that the only constraint of the hello message, apart from size 240 bytes, is that the second byte must be zero, so we just set it to all zeroes.</p>
<div id="attachment_156134" style="width: 710px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-5.-Our-client’s-code-for-the-RSA-handshake.jpg"><img class="wp-image-156134" src="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-5.-Our-client’s-code-for-the-RSA-handshake-300x147.jpg" alt="" width="700" height="344" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-5.-Our-client’s-code-for-the-RSA-handshake-300x147.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-5.-Our-client’s-code-for-the-RSA-handshake-768x377.jpg 768w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-5.-Our-client’s-code-for-the-RSA-handshake-1024x503.jpg 1024w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-5.-Our-client’s-code-for-the-RSA-handshake.jpg 1028w" sizes="(max-width: 700px) 100vw, 700px" /></a><p class="wp-caption-text"><em>Figure 5. Our client’s code for the RSA handshake</em></p></div>
<p>The final part is sending the module. As one can see in Figure 6, it consists of a few simple steps:</p>
<ul>
<li>receiving the signature of the previously loaded module – we decided not to do anything with it in our implementation, as it was not important for us</li>
<li>sending a hardcoded signature of the module</li>
<li>reading the module from a file, encrypting it (see Figure 7) and sending it</li>
<li>sending the encryption key of the module</li>
</ul>
<div id="attachment_156135" style="width: 669px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-6.-Our-client’s-code-for-sending-the-module.jpg"><img class="wp-image-156135" src="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-6.-Our-client’s-code-for-sending-the-module-300x201.jpg" alt="" width="659" height="441" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-6.-Our-client’s-code-for-sending-the-module-300x201.jpg 300w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-6.-Our-client’s-code-for-sending-the-module-65x42.jpg 65w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-6.-Our-client’s-code-for-sending-the-module-114x76.jpg 114w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-6.-Our-client’s-code-for-sending-the-module-97x65.jpg 97w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-6.-Our-client’s-code-for-sending-the-module.jpg 724w" sizes="(max-width: 659px) 100vw, 659px" /></a><p class="wp-caption-text"><em>Figure 6. Our client’s code for sending the module</em></p></div>
<div id="attachment_156136" style="width: 669px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-7.-Our-client’s-code-for-loading-and-encrypting-the-module.jpg"><img class="wp-image-156136 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-7.-Our-client’s-code-for-loading-and-encrypting-the-module.jpg" alt="" width="659" height="320" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-7.-Our-client’s-code-for-loading-and-encrypting-the-module.jpg 659w, https://www.welivesecurity.com/wp-content/uploads/2021/10/Figure-7.-Our-client’s-code-for-loading-and-encrypting-the-module-300x146.jpg 300w" sizes="(max-width: 659px) 100vw, 659px" /></a><p class="wp-caption-text"><em>Figure 7. Our client’s code for loading and encrypting the module</em></p></div>
<p>The full source code for our client is available in our <a href="https://github.com/eset/wslink-client" target="_blank" rel="noopener">WslinkClient</a> GitHub repository. Note that the code still requires a significant amount of work to be usable for malicious purposes and creating another loader from scratch would be easier.</p>
<h2>Conclusion</h2>
<p>Wslink is a simple yet remarkable loader that, unlike those we usually see, runs as a server and executes received modules in memory.</p>
<p>Interestingly, the modules reuse the loader’s functions for communication, keys and sockets; hence they do not have to initiate new outbound connections. Wslink additionally features a well-developed cryptographic protocol to protect the exchanged data.</p>
<h2>IoCs</h2>
<h3>Samples</h3>

<table id="tablepress-1020" class="tablepress tablepress-id-1020">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">ESET detection name</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">01257C3669179F754489F92947FBE0B57AEAE573</span></td><td rowspan="3" class="column-2">Win64/TrojanDownloader.Wslink</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">E6F36C66729A151F4F60F54012F242736BA24862</span></td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">39C4DE564352D7B6390BFD50B28AA9461C93FB32</span></td>
</tr>
</tbody>
</table>

<h3>MITRE ATT&amp;CK techniques</h3>
<p><em>This table was built using </em><a href="https://attack.mitre.org/resources/versions/" target="_blank" rel="noopener">version 9</a><em> of the ATT&amp;CK framework.</em></p>

<table id="tablepress-1021" class="tablepress tablepress-id-1021">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1">Enterprise</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1587/001/" rel="noopener" target="_blank">T1587.001</a></td><td class="column-3">Develop Capabilities: Malware</td><td class="column-4">Wslink is a custom PE loader.</td>
</tr>
<tr class="row-3 odd">
	<td rowspan="2" class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1129/" rel="noopener" target="_blank">T1129</a></td><td class="column-3">Shared Modules</td><td class="column-4">Wslink loads and executes DLLs in memory.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1569/002/" rel="noopener" target="_blank">T1569.002</a></td><td class="column-3">System Services: Service Execution</td><td class="column-4">Wslink runs as a service.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1">Obfuscated Files or Information</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1027/002/" rel="noopener" target="_blank">T1027.002</a></td><td class="column-3">Obfuscated Files or Information: Software Packing</td><td class="column-4">Wslink is packed with MPRESS and its code might be virtualized.</td>
</tr>
<tr class="row-6 even">
	<td rowspan="2" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/techniques/T1573/001/" rel="noopener" target="_blank">T1573.001</a></td><td class="column-3">Encrypted Channel: Symmetric Cryptography</td><td class="column-4">Wslink encrypts traffic with AES.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/techniques/T1573/002/" rel="noopener" target="_blank">T1573.002</a></td><td class="column-3">Encrypted Channel: Asymmetric Cryptography</td><td class="column-4">Wslink exchanges a symmetric key with RSA.</td>
</tr>
</tbody>
</table>


                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/vhrcka/" title="Vladislav Hrčka">
                    Vladislav Hrčka                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2021-10-27 11:30:06">27 Oct 2021 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/10/15/virus-bulletin-old-malware-never-dies-gets-more-targeted/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/10/virus-bulletin-old-malware-targeted-attacks-623x415.jpg"
                                                         alt="Wslink: Unique and undocumented malicious loader that runs as a server">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/10/15/virus-bulletin-old-malware-never-dies-gets-more-targeted/">
                                                    Virus Bulletin: Old malware never dies – it just gets more targeted                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/10/07/fontonlake-previously-unknown-malware-family-targeting-linux/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/10/wls_penguin-fontonlake_1000x667-623x432.jpg"
                                                         alt="Wslink: Unique and undocumented malicious loader that runs as a server">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/10/07/fontonlake-previously-unknown-malware-family-targeting-linux/">
                                                    FontOnLake: Previously unknown malware family targeting Linux                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/10/06/moon-hack-fake-safemoon-cryptocurrency-app-drops-malware-spy/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/09/falsa-app-criptomoneda-safemoon-descarga-malware-1.jpg"
                                                         alt="Wslink: Unique and undocumented malicious loader that runs as a server">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/10/06/moon-hack-fake-safemoon-cryptocurrency-app-drops-malware-spy/">
                                                    To the moon and hack: Fake SafeMoon app drops malware to spy on you                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/10/05/uefi-threats-moving-esp-introducing-especter-bootkit/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/10/especter-bootkit-uefi-esp-eset-research-623x415.jpg"
                                                         alt="Wslink: Unique and undocumented malicious loader that runs as a server">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/10/05/uefi-threats-moving-esp-introducing-especter-bootkit/">
                                                    UEFI threats moving to the ESP: Introducing ESPecter bootkit                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F10%2F27%2Fwslink-unique-undocumented-malicious-loader-runs-server%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F10%2F27%2Fwslink-unique-undocumented-malicious-loader-runs-server%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2021%2F10%2F27%2Fwslink-unique-undocumented-malicious-loader-runs-server%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.4.2.6281c4.pro.awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"156111 https:\/\/backend.welivesecurity.com\/?p=156111","disqusShortname":"welivesecurity","disqusTitle":"Wslink: Unique and undocumented malicious loader that runs as a server","disqusUrl":"https:\/\/www.welivesecurity.com\/2021\/10\/27\/wslink-unique-undocumented-malicious-loader-runs-server\/","postId":"156111"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
