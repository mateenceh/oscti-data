<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=09d01dd87b618f2315ce" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Marc-Etienne M.Léveillé',
        'ArticleCategory': 'ESET Research',
        'ArticleSection': 'Research',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Watering hole deploys new macOS malware, DazzleSpy, in Asia | WeLiveSecurity</title>
<meta name="description" content="The website of a Hong Kong pro-democracy radio station was compromised to serve a Safari exploit that installed cyberespionage malware on visitors’ Macs."/>
<link rel="canonical" href="https://www.welivesecurity.com/2022/01/25/watering-hole-deploys-new-macos-malware-dazzlespy-asia/" />
<meta property="og:locale" content="en_US" />
<meta property="og:locale:alternate" content="de_DE" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Watering hole deploys new macOS malware, DazzleSpy, in Asia | WeLiveSecurity" />
<meta property="og:description" content="The website of a Hong Kong pro-democracy radio station was compromised to serve a Safari exploit that installed cyberespionage malware on visitors’ Macs." />
<meta property="og:url" content="https://www.welivesecurity.com/2022/01/25/watering-hole-deploys-new-macos-malware-dazzlespy-asia/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:tag" content="exploit" />
<meta property="article:section" content="ESET Research" />
<meta property="article:published_time" content="2022-01-25T10:30:37+00:00" />
<meta property="article:modified_time" content="2022-02-15T05:19:00+00:00" />
<meta property="og:updated_time" content="2022-02-15T05:19:00+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2022/01/Watering-Hole-Landscape.png" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2022/01/Watering-Hole-Landscape.png" />
<meta property="og:image:width" content="1255" />
<meta property="og:image:height" content="657" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="The website of a Hong Kong pro-democracy radio station was compromised to serve a Safari exploit that installed cyberespionage malware on visitors’ Macs." />
<meta name="twitter:title" content="Watering hole deploys new macOS malware, DazzleSpy, in Asia | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2022/01/Watering-Hole-Landscape.png" />
<meta name="twitter:creator" content="@marc_etienne_" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-courier-new-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/courier-new.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" href="https://www.welivesecurity.com/2022/01/25/watering-hole-deploys-new-macos-malware-dazzlespy-asia/" hreflang="en" />
<link rel="alternate" href="https://www.welivesecurity.com/la-es/2022/01/25/ataque-watering-hole-despliega-dazzlespy-nuevo-malware-macos/" hreflang="es" />
<link rel="alternate" href="https://www.welivesecurity.com/deutsch/2022/01/26/neue-macos-malware-dazzlespy-ueber-webseite-verbreitet/" hreflang="de" />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">

<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="qcw62iqx3ygdgyrx542a-f-b1348d7a6-clientnsv4-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"32","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":17,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"60339ee0","ak.r":40197,"ak.a2":n,"ak.m":"dscr","ak.n":"ff","ak.bpcip":"128.173.237.0","ak.cport":36552,"ak.gh":"23.222.12.47","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1647832884","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==j/RfbV2S9HVC4NOq4V7q1XL8VAb5Z7KTT4rS6kXQpxf25WGGP2xrRbTd+NHJk280FZEK+Z0HMB5+H6KjldsS6NLQQma00643IplojKfbUOD0/94hJEtFnSJsTDMpeWuJOPV5ztWTM1K+Bgeaku5UeCc5WIVI6a66xmmH+6cTL85j/liNaZFKZyhogJObFtvxD75nVY1Oy0zw/+2t3eWOf4MEwQyXVV7xNEtHenrAPULha6ab3jN3tWwOkwWwI4sE95pRxmmlpQ+9yVWDv8bxKsEiMGmkzkDrbD/K0tCeWG3PjaMbYdXmV74axRQq6cvDv6beOT2jQo7fk760E8Hj9Do0aG0lnj/LGvBa6J7FrEO81gO8/raQ5Zgm/MUTjEnvrNrLTN7g988Bg+3r/1Aa1KoW6i87FvYPO54ZREq06Y4=","ak.pv":"11","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2022/01/25/ataque-watering-hole-despliega-dazzlespy-nuevo-malware-macos/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2022/01/26/neue-macos-malware-dazzlespy-ueber-webseite-verbreitet/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/">
                                            Ukraine Crisis – Digital Security Resource Center                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/we-live-progress/">
                                            We Live Progress                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/2022/01/25/ataque-watering-hole-despliega-dazzlespy-nuevo-malware-macos/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/2022/01/26/neue-macos-malware-dazzlespy-ueber-webseite-verbreitet/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2022/01/dazzlespy-macos-malware.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Watering hole deploys new macOS malware, DazzleSpy, in Asia</h1>
<div class="excerpt">Hong Kong pro-democracy radio station website compromised to serve a Safari exploit that installed cyberespionage malware on site visitors’ Macs</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2013/06/Marc-Etienne-M.Leveille.png" alt="Marc-Etienne M.Léveillé">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/acherepanov/" title="Anton Cherepanov">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2020/03/Anton_Cherepanov-222x179.jpg" alt="Anton Cherepanov">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/acherepanov/" title="Anton Cherepanov">
                    Anton Cherepanov                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2022-01-25 11:30:37">25 Jan 2022 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F01%2F25%2Fwatering-hole-deploys-new-macos-malware-dazzlespy-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F01%2F25%2Fwatering-hole-deploys-new-macos-malware-dazzlespy-asia%2F&text=Watering hole deploys new macOS malware, DazzleSpy, in Asia%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F01%2F25%2Fwatering-hole-deploys-new-macos-malware-dazzlespy-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Hong Kong pro-democracy radio station website compromised to serve a Safari exploit that installed cyberespionage malware on site visitors’ Macs</p>
                            </div>

                            <p>On November 11<sup>th</sup>, Google TAG published a <a href="https://blog.google/threat-analysis-group/analyzing-watering-hole-campaign-using-macos-exploits/" target="_blank" rel="noopener">blogpost</a> about watering-hole attacks leading to exploits for the Safari web browser running on macOS. ESET researchers had been investigating this campaign the week before that publication, uncovering additional details about the targets and malware used to compromise its victims. Here we provide a breakdown of the WebKit exploit used to compromise Mac users and an analysis of the payload, which is a new malware family targeting macOS. But first, let’s look at how victims came into contact with the malicious code in the first place.</p>
<h2>Targets</h2>
<p>It was <a href="https://twitter.com/felixaime/status/1459452296321024003" target="_blank" rel="noopener">reported</a> by Felix Aimé from SEKOIA.IO that one of the websites used to propagate the exploits was a fake website targeting Hong Kong activists. We can read on its home page “Liberate Hong Kong, the revolution of our times”. The very recent registration date of the <span style="font-family: 'courier new', courier, monospace;">fightforhk[.]com</span> domain, October 19<sup>th</sup>, 2021, and the fact that the website is no longer accessible, supports that idea. We could also confirm that the <a href="https://archive.org/" target="_blank" rel="noopener">Internet Archive</a> cached a copy of the web page on November 13<sup>th</sup>. This copy includes the malicious <span style="font-family: 'courier new', courier, monospace;">iframe</span>, as seen in Figure 1.</p>
<div id="attachment_158619" style="width: 785px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-1.-fightforhk.com-as-archived-by-the-Wayback-Machine-on-November-13th.png"><img class="wp-image-158619 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-1.-fightforhk.com-as-archived-by-the-Wayback-Machine-on-November-13th.png" alt="" width="775" height="717" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-1.-fightforhk.com-as-archived-by-the-Wayback-Machine-on-November-13th.png 775w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-1.-fightforhk.com-as-archived-by-the-Wayback-Machine-on-November-13th-300x278.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-1.-fightforhk.com-as-archived-by-the-Wayback-Machine-on-November-13th-768x711.png 768w" sizes="(max-width: 775px) 100vw, 775px" /></a><p class="wp-caption-text"><em>Figure 1. <span style="font-family: courier new, courier, monospace;">fightforhk[.]com</span>, as archived by the Wayback Machine on November 13th</em></p></div>
<p>ESET researchers found another website, this time legitimate but compromised, that also distributed the same exploit during the few months prior to the Google TAG publication: the online, Hong Kong, pro-democracy radio station <a href="https://en.wikipedia.org/wiki/D100_Radio" target="_blank" rel="noopener">D100</a>. As seen in Figure 2, an <span style="font-family: 'courier new', courier, monospace;">iframe</span> was injected into pages served by <span style="font-family: 'courier new', courier, monospace;">bc.d100[.]net</span> – the section of the website used by subscribers – between September 30<sup>th</sup> and November 4<sup>th</sup> 2021.</p>
<p>Both distribution methods have something in common: they attract visitors from Hong Kong with pro-democracy sympathies. It seems that they were the primary target of this threat.</p>
<div id="attachment_158620" style="width: 788px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-2.-Excerpt-of-https-bc.d100.-net-Product-Subscription-on-November-4th-2021.png"><img class="wp-image-158620" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-2.-Excerpt-of-https-bc.d100.-net-Product-Subscription-on-November-4th-2021-150x150.png" alt="" width="778" height="156" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-2.-Excerpt-of-https-bc.d100.-net-Product-Subscription-on-November-4th-2021-300x60.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-2.-Excerpt-of-https-bc.d100.-net-Product-Subscription-on-November-4th-2021-768x154.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-2.-Excerpt-of-https-bc.d100.-net-Product-Subscription-on-November-4th-2021-1024x205.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-2.-Excerpt-of-https-bc.d100.-net-Product-Subscription-on-November-4th-2021.png 1287w" sizes="(max-width: 778px) 100vw, 778px" /></a><p class="wp-caption-text"><em>Figure 2. Excerpt of <span style="font-family: courier new, courier, monospace;">https://bc.d100[.]net/Product/Subscription</span> on November 4th 2021</em></p></div>
<h2>The exploit chain</h2>
<p>As seen in Figure 3, the page hosted on the malicious <span style="font-family: 'courier new', courier, monospace;">amnestyhk[.]org</span> domain checks for the installed macOS version and redirects to the next stage if the browser is running on macOS 10.15.2 or newer.</p>
<div id="attachment_158615" style="width: 788px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-3.-Content-of-the-defaultaa.html-page-on-amnestyhk.org_.png"><img class="wp-image-158615" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-3.-Content-of-the-defaultaa.html-page-on-amnestyhk.org_-150x150.png" alt="" width="778" height="463" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-3.-Content-of-the-defaultaa.html-page-on-amnestyhk.org_-300x179.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-3.-Content-of-the-defaultaa.html-page-on-amnestyhk.org_-768x457.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-3.-Content-of-the-defaultaa.html-page-on-amnestyhk.org_-1024x610.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-3.-Content-of-the-defaultaa.html-page-on-amnestyhk.org_.png 1147w" sizes="(max-width: 778px) 100vw, 778px" /></a><p class="wp-caption-text"><em>Figure 3. Content of the <span style="font-family: courier new, courier, monospace;">defaultaa.html</span> page on <span style="font-family: courier new, courier, monospace;">amnestyhk[.]org</span></em></p></div>
<p>The next stage, named <span style="font-family: 'courier new', courier, monospace;">4ba29d5b72266b28.html</span> (see Figure 4) simply loads the JavaScript containing the exploit code – <span style="font-family: 'courier new', courier, monospace;">mac.js</span>.</p>
<div id="attachment_158616" style="width: 785px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-4.-Content-of-the-4ba29d5b72266b28.html-page.png"><img class="wp-image-158616" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-4.-Content-of-the-4ba29d5b72266b28.html-page-150x150.png" alt="" width="775" height="324" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-4.-Content-of-the-4ba29d5b72266b28.html-page-300x126.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-4.-Content-of-the-4ba29d5b72266b28.html-page-768x321.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-4.-Content-of-the-4ba29d5b72266b28.html-page-1024x428.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-4.-Content-of-the-4ba29d5b72266b28.html-page.png 1164w" sizes="(max-width: 775px) 100vw, 775px" /></a><p class="wp-caption-text"><em>Figure 4. Content of the 4ba29d5b72266b28.html page</em></p></div>
<p>Note that the script tag to load <span style="font-family: 'courier new', courier, monospace;">caps.js</span> has been commented out. The previous version of the exploit loaded <a href="https://alexaltea.github.io/capstone.js/" target="_blank" rel="noopener">Capstone.js</a> from that file, while in the new version, <span style="font-family: 'courier new', courier, monospace;">Capstone.js</span> is prepended to the exploit code in <span style="font-family: 'courier new', courier, monospace;">mac.js</span>.</p>
<h2>The WebKit exploit</h2>
<p>The exploit used to gain code execution in the browser is quite complex and had more than 1,000 lines of code once formatted nicely. It’s interesting to note that some code, which suggests the vulnerability could also have been exploited on iOS and even on PAC-enabled (<a href="https://developer.arm.com/documentation/102433/0100/Return-oriented-programming" target="_blank" rel="noopener">Pointer Authentication Code</a>) devices such as the iPhone XS and newer, has been commented out, as seen in Figure 5.</p>
<div id="attachment_158617" style="width: 785px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-5.-Excerpt-of-the-JavaScript-exploit-containing-comments-about-how-to-target-iOS-and-PAC-enabled-devices.png"><img class="wp-image-158617" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-5.-Excerpt-of-the-JavaScript-exploit-containing-comments-about-how-to-target-iOS-and-PAC-enabled-devices-150x150.png" alt="" width="775" height="247" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-5.-Excerpt-of-the-JavaScript-exploit-containing-comments-about-how-to-target-iOS-and-PAC-enabled-devices-300x95.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-5.-Excerpt-of-the-JavaScript-exploit-containing-comments-about-how-to-target-iOS-and-PAC-enabled-devices-768x244.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-5.-Excerpt-of-the-JavaScript-exploit-containing-comments-about-how-to-target-iOS-and-PAC-enabled-devices-1024x326.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-5.-Excerpt-of-the-JavaScript-exploit-containing-comments-about-how-to-target-iOS-and-PAC-enabled-devices.png 1222w" sizes="(max-width: 775px) 100vw, 775px" /></a><p class="wp-caption-text"><em>Figure 5. Excerpt of the JavaScript exploit containing comments about how to target iOS and PAC-enabled devices</em></p></div>
<p>We have confirmed that the <a href="https://github.com/WebKit/WebKit/commit/f4e35a4796f9570c860d39f2701b2a8213f2e10a#diff-cc796f83ce6dd05d2337dcccb59527826a3bdf8cfa3faa686af7b67a1af9bd39" target="_blank" rel="noopener">patch</a> identified by Google TAG does fix the vulnerability. While it is possible this vulnerability was assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-1789" target="_blank" rel="noopener">CVE-2021-1789</a>, we couldn’t confirm due to the lack of publicly available technical details. Below we outline our understanding of how the vulnerability affects Safari versions prior to 14.1.</p>
<p>The exploit implements two primitives to gain memory read and write access: one to leak the address of an object (<span style="font-family: 'courier new', courier, monospace;">addrof</span>) and one to create a fake JavaScript object from a given memory address (<span style="font-family: 'courier new', courier, monospace;">fakeobj</span>). Using these two functions, the exploit creates two arrays of different types that overlap in memory, and thus is able to set a value in one of them that is treated as a pointer when accessed using the other. The technique is well described by Samuel Groß in his <a href="http://www.phrack.org/issues/70/3.html#article" target="_blank" rel="noopener">multiple</a> <a href="https://googleprojectzero.blogspot.com/2020/09/jitsploitation-one.html" target="_blank" rel="noopener">publications</a> on the subject. Below we explain the vulnerability that made the leakage of object addresses possible.</p>
<p>The exploit relies on a side effect caused by modifying an object property to be accessible via a “getter” function while enumerating the object’s properties in JIT-compiled code. The JavaScript engine erroneously speculates that the value of the property is cached in an array and is not the result of calling the getter function. We have extracted the relevant part of the code that enables the <span style="font-family: 'courier new', courier, monospace;">addrof</span> primitive, which you can see in Figure 6. Comments starting with<span style="font-family: 'courier new', courier, monospace;"> (e)r</span> are from ESET Research.</p>
<div id="attachment_158618" style="width: 785px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-6.-Commented-excerpt-of-the-exploit-enabling-the-leak-of-object-addresses.png"><img class="wp-image-158618" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-6.-Commented-excerpt-of-the-exploit-enabling-the-leak-of-object-addresses-150x150.png" alt="" width="775" height="1295" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-6.-Commented-excerpt-of-the-exploit-enabling-the-leak-of-object-addresses-180x300.png 180w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-6.-Commented-excerpt-of-the-exploit-enabling-the-leak-of-object-addresses-768x1283.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-6.-Commented-excerpt-of-the-exploit-enabling-the-leak-of-object-addresses-613x1024.png 613w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-6.-Commented-excerpt-of-the-exploit-enabling-the-leak-of-object-addresses.png 1000w" sizes="(max-width: 775px) 100vw, 775px" /></a><p class="wp-caption-text"><em>Figure 6. Commented excerpt of the exploit enabling the leak of object addresses</em></p></div>
<p>The first corruption happening here is the result of <span style="font-family: 'courier new', courier, monospace;">bar(vic)</span>. The function will return a pointer to a JSCell object (to be more precise, a <a href="https://github.com/WebKit/WebKit/blob/3453222bf9861631d4b2f984bc8609ba1ef3f855/Source/JavaScriptCore/runtime/GetterSetter.h#L43" target="_blank" rel="noopener">GetterSetter</a>), which should never be accessible from the JavaScript code. Here is the result of <span style="font-family: 'courier new', courier, monospace;">describe(bar(vic))</span> in a JavaScriptCore console:</p>
<p style="margin-left: 10%; margin-right: 10%;"><span style="font-family: 'courier new', courier, monospace;"><strong>Cell</strong>: 0x7fffb34dc080 (0x7ffff38cc4c8:[0x3af5, <strong>GetterSetter</strong>, {}, NonArray, Leaf]), StructureID: 15093</span></p>
<p>This JSCell is then converted to a JSObject by calling the JavaScript <span style="font-family: 'courier new', courier, monospace;">Object</span> function. Internally, this results in calling the JSCell’s <span style="font-family: 'courier new', courier, monospace;">toObject</span> method. There is no implementation for converting a GetterSetter to a JSObject and the code will eventually fall back and <a href="https://github.com/WebKit/WebKit/blob/3453222bf9861631d4b2f984bc8609ba1ef3f855/Source/JavaScriptCore/runtime/JSCell.cpp#L178" target="_blank" rel="noopener">assume its type is a Symbol</a>. The GetterSetter will erroneously be cast to a <a href="https://tc39.es/ecma262/#sec-symbol-objects" target="_blank" rel="noopener">Symbol</a>. You may have noticed the assertion that the cell type is a Symbol before performing the cast in the code; however, the <span style="font-family: 'courier new', courier, monospace;">ASSERT</span> macro in WebKit is <a href="https://webkit.org/blog/5397/a-guide-to-assertion-macros-in-webkit/" target="_blank" rel="noopener">compiled out of release builds</a>.</p>
<p>In memory, the location of <span style="font-family: 'courier new', courier, monospace;">getter[0]</span> is the same as this corrupted symbol’s value. Thus, reassigning a value to <span style="font-family: 'courier new', courier, monospace;">getter[0]</span> will change the value of the symbol. Its value is fetched from JavaScript using its <span style="font-family: 'courier new', courier, monospace;">toString</span> method.</p>
<p>The updated JavaScriptCore code now checks whether the object <a href="https://github.com/WebKit/WebKit/blob/f4e35a4796f9570c860d39f2701b2a8213f2e10a/Source/JavaScriptCore/runtime/Structure.cpp#L1489" target="_blank" rel="noopener">contains properties with GetterSetter</a> after the property enumeration, before considering whether the object’s attribute can be accessed “quickly”.</p>
<p>Detailing the fake object creation would require an article of its own. In short, it abuses the same bug, although this time the object is manipulated in a way that the JIT-compiled code accesses an item that is out-of-bounds and returns an address that was carefully sprayed on the heap before the fetch.</p>
<p>The rest of the code allows bypassing mitigations, such as the <a href="https://labs.f-secure.com/archive/some-brief-notes-on-webkit-heap-hardening/" target="_blank" rel="noopener">Gigacage</a>, and loads the next stage.</p>
<p>As explained by Google TAG, the JavaScript loads a Mach-O executable file in memory. The rudimentary loader does not implement importing symbols from external libraries; instead, the addresses of <span style="font-family: 'courier new', courier, monospace;">dlopen</span> and <span style="font-family: 'courier new', courier, monospace;">dlsym</span> are patched into the loaded Mach-O. These can then be used from the executable to dynamically load and get the addresses of functions from external libraries.</p>
<h2>Privilege escalation to root</h2>
<p>Now that code execution has been gained, the next stage is a Mach-O that is loaded into memory and executed. This Mach-O exploits a local privilege escalation vulnerability to run the next stage as root. Our examination confirms Google’s analysis that the exploited vulnerability was described by Xinru Chi and Tielei Wang in a <a href="https://github.com/wangtielei/Slides/blob/main/zer0con21.pdf" target="_blank" rel="noopener">presentation at zer0con 2021</a>, but it was also <a href="https://github.com/wangtielei/Slides/blob/main/mosec21.pdf" target="_blank" rel="noopener">presented in more details at MOSEC 2021</a> by Tielei Wang. The vulnerability has been assigned <a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-30869" target="_blank" rel="noopener">CVE-2021-30869</a>. Figure 7 shows a call to a function Tielei Wang called <span style="font-family: 'courier new', courier, monospace;">adjust_port_type</span> in his last presentation. This function, responsible for changing the internal type of a Mach port, is implemented the same way in the Mach-O as was presented at MOSEC. Changing the type of a Mach port shouldn’t be possible unless a vulnerability exists.</p>
<div id="attachment_158623" style="width: 783px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-7.-Altering-the-port-type-from-IKOT_NAMED_ENTRY-to-IKOT_HOST_PRIV-to-gain-access-to-special-privileged-Mach-ports.png"><img class="wp-image-158623" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-7.-Altering-the-port-type-from-IKOT_NAMED_ENTRY-to-IKOT_HOST_PRIV-to-gain-access-to-special-privileged-Mach-ports-150x150.png" alt="" width="773" height="174" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-7.-Altering-the-port-type-from-IKOT_NAMED_ENTRY-to-IKOT_HOST_PRIV-to-gain-access-to-special-privileged-Mach-ports-300x68.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-7.-Altering-the-port-type-from-IKOT_NAMED_ENTRY-to-IKOT_HOST_PRIV-to-gain-access-to-special-privileged-Mach-ports-768x173.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-7.-Altering-the-port-type-from-IKOT_NAMED_ENTRY-to-IKOT_HOST_PRIV-to-gain-access-to-special-privileged-Mach-ports-1024x230.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-7.-Altering-the-port-type-from-IKOT_NAMED_ENTRY-to-IKOT_HOST_PRIV-to-gain-access-to-special-privileged-Mach-ports.png 1320w" sizes="(max-width: 773px) 100vw, 773px" /></a><p class="wp-caption-text"><em>Figure 7. Altering the port type from <span style="font-family: courier new, courier, monospace;">IKOT_NAMED_ENTRY</span> to <span style="font-family: courier new, courier, monospace;">IKOT_HOST_PRIV</span> to gain access to special (privileged) Mach ports</em></p></div>
<p>To summarize, the Mach-O does the following:</p>
<ol>
<li>Downloads a file from the URL supplied as an argument</li>
<li>Decrypts this file using AES-128-EBC and TEA with a custom delta</li>
<li>Writes the resulting file to <span style="font-family: 'courier new', courier, monospace;">$TMPDIR/airportpaird</span> and makes it executable</li>
<li>Uses the privilege escalation exploit to remove the <span style="font-family: 'courier new', courier, monospace;">com.apple.quarantineattribute</span> from the file to avoid asking the user to confirm the launch of the unsigned executable</li>
<li>Uses the same privilege escalation to launch the next stage with root privileges</li>
</ol>
<p>The decrypted payload is where our analysis differs the most from what was described by Google TAG: the payload delivered to vulnerable visitors to the D100 site was new macOS malware we&#8217;ve named DazzleSpy.</p>
<h2>DazzleSpy</h2>
<p>DazzleSpy is a full-featured backdoor that provides attackers a large set of functionalities to control, and exfiltrate files from, a compromised computer. Our sample is a Mach-O binary file compiled for x86_64 CPU architecture.</p>
<h3>Persistence</h3>
<p>In order to persist on the compromised device, the malware adds a Property List file (plist; see Figure 8) named <span style="font-family: 'courier new', courier, monospace;">com.apple.softwareupdate.plist</span> to the <span style="font-family: 'courier new', courier, monospace;">LaunchAgents</span> folder. The malware executable file is named <span style="font-family: 'courier new', courier, monospace;">softwareupdate</span> and saved in the <span style="font-family: 'courier new', courier, monospace;">$HOME/.local/</span> folder.</p>
<div id="attachment_158624" style="width: 785px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-8.-Property-List-file-in-LaunchAgents-folder.png"><img class="wp-image-158624" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-8.-Property-List-file-in-LaunchAgents-folder-150x150.png" alt="" width="775" height="609" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-8.-Property-List-file-in-LaunchAgents-folder-300x236.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-8.-Property-List-file-in-LaunchAgents-folder-768x603.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-8.-Property-List-file-in-LaunchAgents-folder.png 871w" sizes="(max-width: 775px) 100vw, 775px" /></a><p class="wp-caption-text"><em>Figure 8. Property List file in <span style="font-family: courier new, courier, monospace;">LaunchAgents</span> folder</em></p></div>
<h3>C&amp;C communications</h3>
<p>DazzleSpy connects to a hardcoded C&amp;C server; the IP address and port found in the sample we decrypted was <span style="font-family: 'courier new', courier, monospace;">88.218.192[.]128:5633</span>. At first, the malware performs a TLS handshake, then uses a custom protocol to exchange JSON objects to deliver commands from the C&amp;C server to compromised Macs. DazzleSpy’s binary contains an X.509 certificate used as a certificate authority (CA). It verifies that the server’s certificate is issued by that authority. In practice, the same self-signed certificate is used for both the CA and the C&amp;C server. The technique protects the malware’s communications from potential eavesdropping by refusing to send data if end-to-end encryption is not possible.</p>
<p>Table 1 contains the list of commands supported by DazzleSpy. The first column is the name of the command that must be present in the JSON object received from the C&amp;C server; many support optional or mandatory parameters.</p>
<p><em>Table 1. DazzleSpy C&amp;C commands</em></p>

<table id="tablepress-1071" class="tablepress tablepress-id-1071">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Command name </th><th class="column-2">Purpose</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">heartbeat</span></td><td class="column-2">Sends heartbeat response.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">info</span></td><td class="column-2">Collects information about compromised computer, including:<br />
<nobr>&emsp;•&emsp;Hardware UUID and Mac serial number<br />
<nobr>&emsp;•&emsp;Username<br />
<nobr>&emsp;•&emsp;Information about disks and their sizes<br />
<nobr>&emsp;•&emsp;macOS version<br />
<nobr>&emsp;•&emsp;Current date and time<br />
<nobr>&emsp;•&emsp;Wi-Fi SSID<br />
<nobr>&emsp;•&emsp;IP addresses<br />
<nobr>&emsp;•&emsp;Malware binary path and MD5 hash of the main executable<br />
<nobr>&emsp;•&emsp;Malware version<br />
<nobr>&emsp;•&emsp;System Integrity Protection status<br />
<nobr>&emsp;•&emsp;Current privileges<br />
<nobr>&emsp;•&emsp;Whether it’s possible to use <a href="https://support.apple.com/en-us/HT209600" rel="noopener" target="_blank">CVE-2019-8526</a> to dump the keychain</nobr></td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">searchFile</span></td><td class="column-2">Searches for the specified file on the compromised computer.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">scanFiles</span></td><td class="column-2">Enumerates files in <span style="font-family: courier new, courier, monospace;">Desktop</span>, <span style="font-family: courier new, courier, monospace;">Downloads</span>, and <span style="font-family: courier new, courier, monospace;">Documents</span> folders.</td>
</tr>
<tr class="row-6 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">cmd</span></td><td class="column-2">Executes the supplied shell command.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">restartCMD</span></td><td class="column-2">Restarts shell session.</td>
</tr>
<tr class="row-8 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">restart</span></td><td class="column-2">Depending on the supplied parameter: restarts C&amp;C command session, shell session or RDP session, or cleans possible malware traces (<span style="font-family: courier new, courier, monospace;">fsck_hfs.log</span> file and application logs).</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">processInfo</span></td><td class="column-2">Enumerates running processes.</td>
</tr>
<tr class="row-10 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">keychain</span></td><td class="column-2">Dumps the keychain using a CVE-2019-8526 exploit if the macOS version is lower than 10.14.4. The public <a href="https://github.com/LinusHenze/Keysteal" rel="noopener" target="_blank">KeySteal </a>implementation is used.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">downloadFileInfo</span></td><td class="column-2">Enumerates the supplied folder, or provides creation and modification timestamps and SHA-1 hash for a supplied filename.</td>
</tr>
<tr class="row-12 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">downloadFile</span></td><td class="column-2">Exfiltrates a file from the supplied path.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">file</span></td><td class="column-2">File operations: provides information, renames, removes, moves, or runs a file at the supplied path.</td>
</tr>
<tr class="row-14 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">uninstall</span></td><td class="column-2">Deletes itself from the compromised computer.</td>
</tr>
<tr class="row-15 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">RDPInfo</span></td><td class="column-2">Provides information about a remote screen session.</td>
</tr>
<tr class="row-16 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">RDP</span></td><td class="column-2">Starts or ends a remote screen session.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">mouseEvent</span></td><td class="column-2">Provides mouse events for a remote screen session.</td>
</tr>
<tr class="row-18 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">acceptFileInfo</span></td><td class="column-2">Prepares for file transfer (creates the folder at the supplied path, changes file attributes if it exists).</td>
</tr>
<tr class="row-19 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">acceptFile</span></td><td class="column-2">Writes the supplied file to disk. With additional parameters, updates itself or writes files required for exploiting the CVE-2019-8526 vulnerability.</td>
</tr>
<tr class="row-20 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">socks5</span></td><td class="column-2">Starts or ends SOCKS5 session (not implemented).</td>
</tr>
<tr class="row-21 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">recoveryInfo</span></td><td rowspan="2" class="column-2">These seem like file recovery functions that involve scanning a partition. These functions do not seem to work and are probably still in development; they contain lots of hardcoded values.</td>
</tr>
<tr class="row-22 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">recovery</span></td>
</tr>
</tbody>
</table>

<h2>Artifacts</h2>
<p>While analyzing the DazzleSpy binary we found a number of interesting artifacts that might suggest an internal name for the malware and the authors’ origin.</p>
<p>In several places (for example, see Figure 9) the malware refers to <span style="font-family: 'courier new', courier, monospace;">osxrk</span> and the string <span style="font-family: 'courier new', courier, monospace;">1.1.0</span> seems likely to be an internal version number.</p>
<div id="attachment_158625" style="width: 587px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-9.-Possible-internal-name-and-version-number-of-the-DazzleSpy-malware.png"><img class="wp-image-158625 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-9.-Possible-internal-name-and-version-number-of-the-DazzleSpy-malware.png" alt="" width="577" height="200" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-9.-Possible-internal-name-and-version-number-of-the-DazzleSpy-malware.png 577w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-9.-Possible-internal-name-and-version-number-of-the-DazzleSpy-malware-300x104.png 300w" sizes="(max-width: 577px) 100vw, 577px" /></a><p class="wp-caption-text"><em>Figure 9. Possible internal name and version number of the DazzleSpy malware</em></p></div>
<p>Moreover, it seems DazzleSpy’s authors were not so concerned about operational security as they have left the username <span style="font-family: 'courier new', courier, monospace;">wangping</span> in paths embedded in the binary. Figure 10 contains paths that reveal this username and internal module names.</p>
<div id="attachment_158626" style="width: 785px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-10.-Paths-embedded-in-the-DazzleSpy-binary.png"><img class="wp-image-158626" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-10.-Paths-embedded-in-the-DazzleSpy-binary-150x150.png" alt="" width="775" height="463" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-10.-Paths-embedded-in-the-DazzleSpy-binary-300x179.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-10.-Paths-embedded-in-the-DazzleSpy-binary-768x459.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-10.-Paths-embedded-in-the-DazzleSpy-binary.png 865w" sizes="(max-width: 775px) 100vw, 775px" /></a><p class="wp-caption-text"><em>Figure 10. Paths embedded in the DazzleSpy binary</em></p></div>
<p>Once the malware obtains the current date and time on a compromised computer, as you see in Figure 11, it converts the obtained date to the Asia/Shanghai time zone (aka China Standard Time), before sending it to the C&amp;C server.</p>
<div id="attachment_158621" style="width: 716px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-11.-Decompiled-code-of-the-getSystemDate-function.png"><img class="wp-image-158621 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-11.-Decompiled-code-of-the-getSystemDate-function.png" alt="" width="706" height="582" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-11.-Decompiled-code-of-the-getSystemDate-function.png 706w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-11.-Decompiled-code-of-the-getSystemDate-function-300x247.png 300w" sizes="(max-width: 706px) 100vw, 706px" /></a><p class="wp-caption-text"><em>Figure 11. Decompiled code of the <span style="font-family: courier new, courier, monospace;">getSystemDate</span> function</em></p></div>
<p>In addition, it should be noted that the DazzleSpy malware contains a number of internal messages in Chinese, for example as seen in Figure 12.</p>
<div id="attachment_158622" style="width: 681px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-12.-Internal-error-message-in-Chinese.png"><img class="wp-image-158622 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-12.-Internal-error-message-in-Chinese.png" alt="" width="671" height="227" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-12.-Internal-error-message-in-Chinese.png 671w, https://www.welivesecurity.com/wp-content/uploads/2022/01/Figure-12.-Internal-error-message-in-Chinese-300x101.png 300w" sizes="(max-width: 671px) 100vw, 671px" /></a><p class="wp-caption-text"><em>Figure 12. Internal error message in Chinese</em></p></div>
<h2>Conclusion</h2>
<p>Given the complexity of the exploits used in this campaign, we assess that the group behind this operation has strong technical capabilities. While there is information published online about the local privilege escalation (LPE) vulnerability used here, we couldn’t find anything about the specific WebKit vulnerability used to gain code execution in Safari. It’s also interesting that end-to-end encryption is enforced in DazzleSpy and it won’t communicate with its C&amp;C server if anyone tries to eavesdrop on the unencrypted transmission by inserting a TLS-inspection proxy between the compromised system and the C&amp;C server.</p>
<p>The watering-hole operations this group has pursued show that its targets are likely to be politically active, pro-democracy individuals in Hong Kong. This campaign has similarities with one from 2020 where LightSpy iOS malware (described by <a href="https://www.trendmicro.com/en_us/research/20/c/operation-poisoned-news--hong-kong-users-targeted-with-mobile-ma.html" target="_blank" rel="noopener">TrendMicro</a> and <a href="https://securelist.com/ios-exploit-chain-deploys-lightspy-malware/96407/" target="_blank" rel="noopener">Kaspersky</a>) was distributed the same way, using <span style="font-family: 'courier new', courier, monospace;">iframe</span> injection on websites for Hong Kong citizens leading to a WebKit exploit. We cannot confirm at this point whether both campaigns are from the same group, but ESET Research will continue to track and report on similar malicious activities.</p>
<h2>Indicators of Compromise (IoCs)</h2>
<h3>Samples</h3>

<table id="tablepress-1072" class="tablepress tablepress-id-1072">
<thead>
<tr class="row-1 odd">
	<th class="column-1">SHA-1</th><th class="column-2">Filename</th><th class="column-3">ESET detection name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">F3772A23595C0B51AE32D8E7D601ACBE530C7E97</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">mac.js</span></td><td class="column-3">JS/Exploit.Agent.NQK</td><td class="column-4">JavaScript code with WebKit exploit launching an LPE.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">95889E0EF3D31367583DD31FB5F25743FE92D81D</span></td><td class="column-2">N/A</td><td class="column-3">OSX/Exploit.Agent.C</td><td class="column-4">Mach-O file with LPE launching next stage.</td>
</tr>
<tr class="row-4 even">
	<td class="column-1"><span style="font-family: courier new, courier, monospace;">EE0678E58868EBD6603CC2E06A134680D2012C1B</span></td><td class="column-2"><span style="font-family: courier new, courier, monospace;">server.enc</span></td><td class="column-3">OSX/DazzleSpy</td><td class="column-4">DazzleSpy Mach-O after decryption of  <span style="font-family: courier new, courier, monospace;">server.enc</span>.</td>
</tr>
</tbody>
</table>

<h3>Filenames</h3>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">$HOME/Library/LaunchAgents/com.apple.softwareupdate.plist</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">$HOME/.local/softwareupdate</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">$HOME/.local/security.zip</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">$HOME/.local/security/keystealDaemon</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">$HOME/.local/security/libkeystealClient.dylib</span></li>
</ul>
<h3>Network</h3>
<h4>URLs of Safari exploit</h4>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">https://amnestyhk[.]org/ss/defaultaa.html</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">https://amnestyhk[.]org/ss/4ba29d5b72266b28.html</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">https://amnestyhk[.]org/ss/mac.js</span></li>
<li><span style="font-family: 'courier new', courier, monospace;">https://amnestyhk[.]org/ss/server.enc</span></li>
</ul>
<h4>DazzleSpy C&amp;C server</h4>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">88.218.192[.]128:5633</span></li>
</ul>
<h4>DazzleSpy CA certificate</h4>
<p>SHA-256: <span style="font-family: 'courier new', courier, monospace;">1F862B89CC5557F8309A6739DF30DC4AB0865668193FDFF70BA93F05D4F8C8B8</span></p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6237ee8a975e6538625590" class="crayon-syntax crayon-theme-classic crayon-font-courier-new crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
Certificate:
	Data:
		Version: 1 (0x0)
		Serial Number: 10557282746731470350 (0x928300b9284a1e0e)
	Signature Algorithm: sha256WithRSAEncryption
		Issuer: C=11, ST=11, L=11, O=11, OU=11, CN=11/emailAddress=11@qq.com
		Validity
			Not Before: May 18 07:26:17 2021 GMT
			Not After : May 16 07:26:17 2031 GMT
		Subject: C=11, ST=11, L=11, O=11, OU=11, CN=11/emailAddress=11@qq.com
        Subject Public Key Info:
			Public Key Algorithm: rsaEncryption
				Public-Key: (2048 bit)
				Modulus: …
				Exponent: 65537 (0x10001)
	Signature Algorithm: sha256WithRSAEncryption
-----BEGIN CERTIFICATE-----
MIIDTDCCAjQCCQCSgwC5KEoeDjANBgkqhkiG9w0BAQsFADBoMQswCQYDVQQGEwIx
MTELMAkGA1UECAwCMTExCzAJBgNVBAcMAjExMQswCQYDVQQKDAIxMTELMAkGA1UE
CwwCMTExCzAJBgNVBAMMAjExMRgwFgYJKoZIhvcNAQkBFgkxMUBxcS5jb20wHhcN
MjEwNTE4MDcyNjE3WhcNMzEwNTE2MDcyNjE3WjBoMQswCQYDVQQGEwIxMTELMAkG
A1UECAwCMTExCzAJBgNVBAcMAjExMQswCQYDVQQKDAIxMTELMAkGA1UECwwCMTEx
CzAJBgNVBAMMAjExMRgwFgYJKoZIhvcNAQkBFgkxMUBxcS5jb20wggEiMA0GCSqG
SIb3DQEBAQUAA4IBDwAwggEKAoIBAQDFfrP+LbCk9KhPH2gQ3V5lBWCpuM+yzBzn
ofL2RJiTMedP467Js4wzrP+qCkXs9STaOZCvYRFaCmfY9bG7PsrgqG90OHfVkttG
5xIdEpd5XPl+GYl/48ridpE7mgw+KO0oRxoyUO1if9nRXvHNGmx0C3i9Rb6ahynv
dEBAZVxeX20fDHMr0dvVe4TKst9g5W02o31zU54mx2f7m2Kgit+n+UsDA/uBRF/c
GcWsvQFVlcguFmBDt58t98BO5nEmI3iDEfUi8FTf2HVSS0LAYC83IkwZyWpML9Jn
uVg67KFKprNMmzBxDK0eDa9ZHObohj3iscM3IYXlCnicbOLYTCvRAgMBAAEwDQYJ
KoZIhvcNAQELBQADggEBAAvkJC5Fi8+Kz8roBhzCY3ayPLMMMj49aHGU/JDLZwsh
WSng5/eY7LrGkTqP0tKay/rrxQvyMeZftvB0DMCbxu0vndK/jTqruxS+ZXDkqyOb
ykU0Z6TqRZ/ltgcK9ii4R6PgUEynrJVZHtUHDtemulpHgPRjkFDA4emOui1kFdNT
gnUr0vgh12KlVNAm64UVh9kkneCTFZtYeCAGNw5kFknv5OgsjcaueqCsm3a3dxFq
7JqReIV1WDx+QEBXgM4itvQRY+d5pv5eOlz8sBzxFR7+Gh/Q9aJoPL+ZX7kouMEU
bKwsEwNCrWZWQu41ghFi/8MdqBxb2Nb9H4gCupqKdiI=
-----END CERTIFICATE-----</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-1">1</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-2">2</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-3">3</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-4">4</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-5">5</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-6">6</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-7">7</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-8">8</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-9">9</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-10">10</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-11">11</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-12">12</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-13">13</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-14">14</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-15">15</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-16">16</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-17">17</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-18">18</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-19">19</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-20">20</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-21">21</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-22">22</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-23">23</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-24">24</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-25">25</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-26">26</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-27">27</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-28">28</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-29">29</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-30">30</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-31">31</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-32">32</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-33">33</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-34">34</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-35">35</div><div class="crayon-num" data-line="crayon-6237ee8a975e6538625590-36">36</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6237ee8a975e6538625590-1">Certificate:</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-2">	Data:</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-3">		Version: 1 (0x0)</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-4">		Serial Number: 10557282746731470350 (0x928300b9284a1e0e)</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-5">	Signature Algorithm: sha256WithRSAEncryption</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-6">		Issuer: C=11, ST=11, L=11, O=11, OU=11, CN=11/emailAddress=11@qq.com</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-7">		Validity</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-8">			Not Before: May 18 07:26:17 2021 GMT</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-9">			Not After : May 16 07:26:17 2031 GMT</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-10">		Subject: C=11, ST=11, L=11, O=11, OU=11, CN=11/emailAddress=11@qq.com</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-11">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Subject Public Key Info:</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-12">			Public Key Algorithm: rsaEncryption</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-13">				Public-Key: (2048 bit)</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-14">				Modulus: …</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-15">				Exponent: 65537 (0x10001)</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-16">	Signature Algorithm: sha256WithRSAEncryption</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-17">-----BEGIN CERTIFICATE-----</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-18">MIIDTDCCAjQCCQCSgwC5KEoeDjANBgkqhkiG9w0BAQsFADBoMQswCQYDVQQGEwIx</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-19">MTELMAkGA1UECAwCMTExCzAJBgNVBAcMAjExMQswCQYDVQQKDAIxMTELMAkGA1UE</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-20">CwwCMTExCzAJBgNVBAMMAjExMRgwFgYJKoZIhvcNAQkBFgkxMUBxcS5jb20wHhcN</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-21">MjEwNTE4MDcyNjE3WhcNMzEwNTE2MDcyNjE3WjBoMQswCQYDVQQGEwIxMTELMAkG</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-22">A1UECAwCMTExCzAJBgNVBAcMAjExMQswCQYDVQQKDAIxMTELMAkGA1UECwwCMTEx</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-23">CzAJBgNVBAMMAjExMRgwFgYJKoZIhvcNAQkBFgkxMUBxcS5jb20wggEiMA0GCSqG</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-24">SIb3DQEBAQUAA4IBDwAwggEKAoIBAQDFfrP+LbCk9KhPH2gQ3V5lBWCpuM+yzBzn</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-25">ofL2RJiTMedP467Js4wzrP+qCkXs9STaOZCvYRFaCmfY9bG7PsrgqG90OHfVkttG</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-26">5xIdEpd5XPl+GYl/48ridpE7mgw+KO0oRxoyUO1if9nRXvHNGmx0C3i9Rb6ahynv</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-27">dEBAZVxeX20fDHMr0dvVe4TKst9g5W02o31zU54mx2f7m2Kgit+n+UsDA/uBRF/c</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-28">GcWsvQFVlcguFmBDt58t98BO5nEmI3iDEfUi8FTf2HVSS0LAYC83IkwZyWpML9Jn</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-29">uVg67KFKprNMmzBxDK0eDa9ZHObohj3iscM3IYXlCnicbOLYTCvRAgMBAAEwDQYJ</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-30">KoZIhvcNAQELBQADggEBAAvkJC5Fi8+Kz8roBhzCY3ayPLMMMj49aHGU/JDLZwsh</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-31">WSng5/eY7LrGkTqP0tKay/rrxQvyMeZftvB0DMCbxu0vndK/jTqruxS+ZXDkqyOb</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-32">ykU0Z6TqRZ/ltgcK9ii4R6PgUEynrJVZHtUHDtemulpHgPRjkFDA4emOui1kFdNT</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-33">gnUr0vgh12KlVNAm64UVh9kkneCTFZtYeCAGNw5kFknv5OgsjcaueqCsm3a3dxFq</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-34">7JqReIV1WDx+QEBXgM4itvQRY+d5pv5eOlz8sBzxFR7+Gh/Q9aJoPL+ZX7kouMEU</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-35">bKwsEwNCrWZWQu41ghFi/8MdqBxb2Nb9H4gCupqKdiI=</div><div class="crayon-line" id="crayon-6237ee8a975e6538625590-36">-----END CERTIFICATE-----</div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0001 seconds] -->
<p></p>
<h2>MITRE ATT&amp;CK techniques</h2>
<p><em>This table was built using <a href="https://attack.mitre.org/resources/versions/" target="_blank" rel="noopener">version 10</a> of the MITRE ATT&amp;CK framework.</em></p>

<table id="tablepress-1073" class="tablepress tablepress-id-1073">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Tactic</th><th class="column-2">ID</th><th class="column-3">Name</th><th class="column-4">Description</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="7" class="column-1">Resource Development</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1583/001" rel="noopener" target="_blank">T1583.001</a></td><td class="column-3">Acquire Infrastructure: Domains</td><td class="column-4">Domain names such as <span style="font-family: courier new, courier, monospace;">amnestyhq[.]org</span>  were acquired to use on compromised web servers.</td>
</tr>
<tr class="row-3 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1583/004" rel="noopener" target="_blank">T1583.004</a></td><td class="column-3">Acquire Infrastructure: Server</td><td class="column-4">Servers (or virtual servers) were rented to serve WebKit exploits and used as C&amp;C servers for DazzleSpy.</td>
</tr>
<tr class="row-4 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1584/004" rel="noopener" target="_blank">T1584.004</a></td><td class="column-3">Compromise Infrastructure: Server</td><td class="column-4">A legitimate website was compromised to add an  <span style="font-family: courier new, courier, monospace;">iframe</span>  loading malicious JavaScript code.</td>
</tr>
<tr class="row-5 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1587/001/" rel="noopener" target="_blank">T1587.001</a></td><td class="column-3">Develop Capabilities: Malware</td><td class="column-4">DazzleSpy is macOS malware developed to steal information from its victims.</td>
</tr>
<tr class="row-6 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1587/003/" rel="noopener" target="_blank">T1587.003</a></td><td class="column-3">Develop Capabilities: Digital Certificates</td><td class="column-4">DazzleSpy verifies the authenticity of its C&amp;C server using an X.509 certificate.</td>
</tr>
<tr class="row-7 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1587/004/" rel="noopener" target="_blank">T1587.004</a></td><td class="column-3">Develop Capabilities: Exploits</td><td class="column-4">An undocumented Safari exploit was used to compromise the targets.</td>
</tr>
<tr class="row-8 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1608/004/" rel="noopener" target="_blank">T1608.004</a></td><td class="column-3">Stage Capabilities: Drive-by Target</td><td class="column-4">This operation compromised a website that is likely to be visited by its targets, to distribute malware.</td>
</tr>
<tr class="row-9 odd">
	<td class="column-1">Initial Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1189/" rel="noopener" target="_blank">T1189</a></td><td class="column-3">Drive-by Compromise</td><td class="column-4">The compromised website served the exploit to visitors using Safari on a Mac.</td>
</tr>
<tr class="row-10 even">
	<td class="column-1">Execution</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1569/" rel="noopener" target="_blank">T1569</a></td><td class="column-3">System Services</td><td class="column-4">The exploit sends Mach messages to <span style="font-family: courier new, courier, monospace;">launchd</span>  to remove the quarantine flag and to <span style="font-family: courier new, courier, monospace;">kuncd</span> to launch the malware.</td>
</tr>
<tr class="row-11 odd">
	<td class="column-1">Persistence</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1543/001/" rel="noopener" target="_blank">T1543.001</a></td><td class="column-3">Create or Modify System Process: Launch Agent</td><td class="column-4">DazzleSpy persists by installing a Launch Agent.</td>
</tr>
<tr class="row-12 even">
	<td class="column-1">Privilege Escalation</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1068/" rel="noopener" target="_blank">T1068</a></td><td class="column-3">Exploitation for Privilege Escalation</td><td class="column-4">An LPE exploit for macOS is used to elevate privileges to root.</td>
</tr>
<tr class="row-13 odd">
	<td class="column-1">Defense Evasion</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1620/" rel="noopener" target="_blank">T1620</a></td><td class="column-3">Reflective Code Loading</td><td class="column-4">The LPE exploit downloading the next stage is loaded and executed in memory only.</td>
</tr>
<tr class="row-14 even">
	<td class="column-1">Credential Access</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1555/001/" rel="noopener" target="_blank">T1555.001</a></td><td class="column-3">Credentials from Password Stores: Keychain</td><td class="column-4">DazzleSpy can steal credentials from the macOS keychain.</td>
</tr>
<tr class="row-15 odd">
	<td rowspan="6" class="column-1">Discovery</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1083/" rel="noopener" target="_blank">T1083</a></td><td class="column-3">File and Directory Discovery</td><td class="column-4">DazzleSpy can be used to enumerate files in specific folders.</td>
</tr>
<tr class="row-16 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1057/" rel="noopener" target="_blank">T1057</a></td><td class="column-3">Process Discovery</td><td class="column-4">DazzleSpy can obtain the list of running processes.</td>
</tr>
<tr class="row-17 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1082/" rel="noopener" target="_blank">T1082</a></td><td class="column-3">System Information Discovery</td><td class="column-4">DazzleSpy can obtain the macOS version.</td>
</tr>
<tr class="row-18 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1016/" rel="noopener" target="_blank">T1016</a></td><td class="column-3">System Network Configuration Discovery</td><td class="column-4">DazzleSpy can obtain the IP address and Wi-Fi SSID.</td>
</tr>
<tr class="row-19 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1033/" rel="noopener" target="_blank">T1033</a></td><td class="column-3">System Owner/User Discovery</td><td class="column-4">DazzleSpy can obtain the current username from a compromised Mac.</td>
</tr>
<tr class="row-20 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1124/" rel="noopener" target="_blank">T1124</a></td><td class="column-3">System Time Discovery</td><td class="column-4">DazzleSpy can obtain the system time on a compromised Mac.</td>
</tr>
<tr class="row-21 odd">
	<td rowspan="2" class="column-1">Collection</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1005/" rel="noopener" target="_blank">T1005</a></td><td class="column-3">Data from Local System</td><td class="column-4">DazzleSpy can search for documents on the compromised system.</td>
</tr>
<tr class="row-22 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1113/" rel="noopener" target="_blank">T1113</a></td><td class="column-3">Screen Capture</td><td class="column-4">DazzleSpy has the ability to record screen activity.</td>
</tr>
<tr class="row-23 odd">
	<td rowspan="4" class="column-1">Command and Control</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1071/" rel="noopener" target="_blank">T1071</a></td><td class="column-3">Application Layer Protocol</td><td class="column-4">DazzleSpy uses a custom JSON-based protocol for its C&amp;C communications.</td>
</tr>
<tr class="row-24 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1132/001/" rel="noopener" target="_blank">T1132.001</a></td><td class="column-3">Data Encoding: Standard Encoding</td><td class="column-4">DazzleSpy uses base64 to encode parts of its C&amp;C communications.</td>
</tr>
<tr class="row-25 odd">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1573/" rel="noopener" target="_blank">T1573</a></td><td class="column-3">Encrypted Channel</td><td class="column-4">DazzleSpy uses TLS encryption.</td>
</tr>
<tr class="row-26 even">
	<td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1571/" rel="noopener" target="_blank">T1571</a></td><td class="column-3">Non-Standard Port</td><td class="column-4">DazzleSpy uses TCP port 5633.</td>
</tr>
<tr class="row-27 odd">
	<td class="column-1">Exfiltration</td><td class="column-2"><a href="https://attack.mitre.org/versions/v10/techniques/T1041/" rel="noopener" target="_blank">T1041</a></td><td class="column-3">Exfiltration Over C2 Channel</td><td class="column-4">DazzleSpy exfiltrates data over its C&amp;C communications channel.</td>
</tr>
</tbody>
</table>

<p><a class="no-fancy" href="https://www.eset.com/int/business/services/threat-intelligence/?utm_source=welivesecurity.com&amp;utm_medium=referral&amp;utm_campaign=wls-research&amp;utm_content=watering-hole-deploys-new-macos-malware-dazzlespy-asia" target="_blank" rel="noopener"><img class="aligncenter wp-image-152551" src="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png" alt="" width="899" height="290" srcset="https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta.png 918w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-300x97.png 300w, https://www.welivesecurity.com/wp-content/uploads/2021/07/bandook-bandidos-eti-cta-768x248.png 768w" sizes="(max-width: 899px) 100vw, 899px" /></a></p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/marc-etienne/" title="Marc-Etienne M.Léveillé">
                    Marc-Etienne M.Léveillé                </a>
            </div>
        </div>
                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/acherepanov/" title="Anton Cherepanov">
                    Anton Cherepanov                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2022-01-25 11:30:37">25 Jan 2022 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2022/01/18/donot-go-do-not-respawn/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/01/donot-team-malware-eset-research-623x415.jpg"
                                                         alt="Watering hole deploys new macOS malware, DazzleSpy, in Asia">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/01/18/donot-go-do-not-respawn/">
                                                    DoNot Go! Do not respawn!                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2022/01/11/signed-kernel-drivers-unguarded-gateway-windows-core/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/01/windows-kernel-drivers-signed-vulnerabilities-exploitation-623x416.jpg"
                                                         alt="Watering hole deploys new macOS malware, DazzleSpy, in Asia">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/01/11/signed-kernel-drivers-unguarded-gateway-windows-core/">
                                                    Signed kernel drivers – Unguarded gateway to Windows’ core                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2021/12/15/dirty-dozen-latin-america-amavaldo-zumanek/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/12/banking-trojans-latin-america-research-623x415.jpg"
                                                         alt="Watering hole deploys new macOS malware, DazzleSpy, in Asia">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/12/15/dirty-dozen-latin-america-amavaldo-zumanek/">
                                                    The dirty dozen of Latin America: From Amavaldo to Zumanek                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2021/12/02/launching-eset-research-podcast-peek-behind-scenes-eset-discoveries/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/12/eset-research-code-logo-thumbnail-623x432.png"
                                                         alt="Watering hole deploys new macOS malware, DazzleSpy, in Asia">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/12/02/launching-eset-research-podcast-peek-behind-scenes-eset-discoveries/">
                                                    Launching ESET Research Podcast: A peek behind the scenes of ESET discoveries                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F01%2F25%2Fwatering-hole-deploys-new-macos-malware-dazzlespy-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F01%2F25%2Fwatering-hole-deploys-new-macos-malware-dazzlespy-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F01%2F25%2Fwatering-hole-deploys-new-macos-malware-dazzlespy-asia%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.7.3.41514b.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"158449 https:\/\/backend.welivesecurity.com\/?p=158449","disqusShortname":"welivesecurity","disqusTitle":"Watering hole deploys new macOS malware, DazzleSpy, in Asia","disqusUrl":"https:\/\/www.welivesecurity.com\/2022\/01\/25\/watering-hole-deploys-new-macos-malware-dazzlespy-asia\/","postId":"158449"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
