<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=09d01dd87b618f2315ce" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Rene Holt',
        'ArticleCategory': 'secure coding',
        'ArticleSection': '(not set)',
        'cookie-bar-hq': true
    });

    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>Integer overflow: How does it occur and how can it be prevented? | WeLiveSecurity</title>
<meta name="description" content="What is an integer overflow vulnerability, how does it occur, what are its consequences, and how can it be prevented?"/>
<link rel="canonical" href="https://www.welivesecurity.com/2022/02/21/integer-overflow-how-it-occur-can-be-prevented/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Integer overflow: How does it occur and how can it be prevented? | WeLiveSecurity" />
<meta property="og:description" content="What is an integer overflow vulnerability, how does it occur, what are its consequences, and how can it be prevented?" />
<meta property="og:url" content="https://www.welivesecurity.com/2022/02/21/integer-overflow-how-it-occur-can-be-prevented/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="secure coding" />
<meta property="article:published_time" content="2022-02-21T10:30:19+00:00" />
<meta property="article:modified_time" content="2022-02-21T10:37:07+00:00" />
<meta property="og:updated_time" content="2022-02-21T10:37:07+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2022/02/WLS_Integer_Landscape.png" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2022/02/WLS_Integer_Landscape.png" />
<meta property="og:image:width" content="1255" />
<meta property="og:image:height" content="657" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="What is an integer overflow vulnerability, how does it occur, what are its consequences, and how can it be prevented?" />
<meta name="twitter:title" content="Integer overflow: How does it occur and how can it be prevented? | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2022/02/WLS_Integer_Landscape.png" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel='stylesheet' id='crayon-theme-classic-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/themes/classic/classic.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel='stylesheet' id='crayon-font-monaco-css'  href='https://www.welivesecurity.com/wp-content/plugins/crayon-syntax-highlighter/fonts/monaco.css?ver=_2.7.2_beta' type='text/css' media='all' />
<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">

<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="qcw62iqx3ygdgyrx542q-f-d7aeb4caf-clientnsv4-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"32","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":15,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"6033a160","ak.r":40197,"ak.a2":n,"ak.m":"dscr","ak.n":"ff","ak.bpcip":"128.173.237.0","ak.cport":36588,"ak.gh":"23.222.12.47","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1647832885","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==uYTzNslzSqQiz6LuO3D1mGa5QFCzjJhpdVQ/e2iWnWv8XEJ9PN4JCvr3NfsYKpMZuNNXUMXbYw/MNATk5mQVc6cPhlkd1ogmhUODpsC9aDBr/D1jKY/qDqC02xvYunWDuJojE/BnJ+7Cp/RW/KuAQGBoSYF2nj+pW90bf/cPXVy/yw0Gr/+4CsO1blvfsRUaMIaJTDRc5BM/Wf3cI2fzVr6ZGug3DHd2rlv5PIbkWNVVPnexvPUz3DkvXZvTjPdMVeXg9Ik34y3aHcxb4GzTxQLpMkky3hIPl1+QrHosixnKSjOHjNCLiEeSP/TWcYUCNxxHoLQozYaydSQgYrxFCScOkhkI39NDrGerxuS/U2d/tzQFzE8Bpg6zkVXvia3U1amUdgnBruZgeBClIgZZ/pXETK6DvsKLRb1j7Jr18r4=","ak.pv":"11","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/">
                                            Ukraine Crisis – Digital Security Resource Center                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/we-live-progress/">
                                            We Live Progress                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/podcasts/">
                                            Podcasts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2022/02/integer-overflow-vulnerability-attack.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>Integer overflow: How does it occur and how can it be prevented?</h1>
<div class="excerpt">Make no mistake, counting on a computer is not as easy as it may seem. Here’s what happens when a number gets “too big”.</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/rholt/" title="Rene Holt">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/10/Rene_Holt-222x179.jpg" alt="Rene Holt">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/rholt/" title="Rene Holt">
                    Rene Holt                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2022-02-21 11:30:19">21 Feb 2022 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F02%2F21%2Finteger-overflow-how-it-occur-can-be-prevented%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F02%2F21%2Finteger-overflow-how-it-occur-can-be-prevented%2F&text=Integer overflow: How does it occur and how can it be prevented?%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F02%2F21%2Finteger-overflow-how-it-occur-can-be-prevented%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Make no mistake, counting on a computer is not as easy as it may seem. Here’s what happens when a number gets “too big”.</p>
                            </div>

                            <p>For many people in the IT community, 2022 got off to a bad start after a bug in on-premises versions of Microsoft Exchange Server caused emails to become stuck en route due to a failed date check. Put simply, a bug subsequently dubbed Y2K22 (named in the style of the Y2K bug that spooked the world starting about a quarter century ago) caused the software to be unable to handle the date format for the year 2022. <a href="https://techcommunity.microsoft.com/t5/exchange-team-blog/email-stuck-in-exchange-on-premises-transport-queues/ba-p/3049447" target="_blank" rel="noopener">Microsoft’s fix</a>? Set the date on malware detection updates back to the fictional December 33<sup>rd</sup>, 2021, giving the date value enough “<abbr title="Exchange employs a date format that uses the last digits of the current year (22 for 2022), the month (01 for January), the date (01 for the first of the month), and the version number (0001 for version 1) stored together as a value in a 32-bit integer: 2201010001. However, the maximum value a signed 32-bit integer can store is 2147483647, which is too small to handle the change to the new year by a whopping 53.5 million. Microsoft’s fix was to set the date back to the fictional December 33rd, 2021 — 2112330001 — creating a generous buffer of about 35 million values before reaching the maximum.">breathing space</abbr>” before reaching the highest value the underlying integer type can hold.</p>
<p>Yet the real lesson for developers is that implementing your own date-handling code is too fraught with the risk of making such mistakes and coming up with strange fixes that would use fictional dates. So unless you are writing those routines for an operating system, a compiler, etc., you should always use standard date APIs.</p>
<p>Back in 2015, a bug of similar ilk was found to affect the software of Boeing’s 787 Dreamliner jet. Had it not been spotted and squashed in time, the bug could have led to a <a href="https://arstechnica.com/information-technology/2015/05/boeing-787-dreamliners-contain-a-potentially-catastrophic-software-bug/" target="_blank" rel="noopener">total loss of all AC electrical power</a>, even in midflight, on the aircraft after <abbr title="Why 248? Because that’s the highest value that a 32-bit signed integer can store, representing a maximum uptime of 2^31 – 1 or 2.1 billion centiseconds, which is about 248 days.">248 days of continuous power</abbr>. The solution to avoid pilots losing control of their airliner midair? Reboot your 787 before 248 days are up, or better, apply the patch.</p>
<p>So why did Microsoft need to pretend updates for its Exchange antimalware component were still from 2021? Why does a plane need to be turned off and back on just so it doesn’t crash? In both cases, the blame fell squarely on an integer overflow, a vulnerability that is a concern in all types of software, ranging from video games to GPS systems to aeronautics. In the <a href="https://cwe.mitre.org/top25/archive/2021/2021_cwe_top25.html" target="_blank" rel="noopener">2021 CWE Top 25 Most Dangerous Software Weaknesses</a> list, which looked at around 32,500 CVEs published in 2019 and 2020, integer overflow or wraparound ranked in twelfth place.</p>
<p>Are software developers so mathematically challenged that they can’t anticipate when they might be running out of numbers? The reality is more complex, in fact. Let’s look a little more deeply at how computers store and handle numbers to see how elusive an integer overflow can be.</p>
<h2>What is an integer?</h2>
<p>In mathematics, integers include positive numbers like 1, 2, and 3, the number 0, and negative numbers like −1, −2, and −3. Integers do not include fractions or decimals. That means the set of all integers can be represented with the following number line:</p>
<p><center><a href="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-1.png"><img class="aligncenter wp-image-159431" src="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-1-300x83.png" alt="" width="350" height="97" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-1-300x83.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-1.png 725w" sizes="(max-width: 350px) 100vw, 350px" /></a></center>&nbsp;</p>
<p>Commonly, a programming language has several integer variable types – each one stores a range of integer values depending on the number of bits that type uses on a particular machine. The more bits that an integer type consumes, the greater the values that can be stored therein.</p>
<p>Let’s consider the integer types in the C programming language, assuming bit sizes that we might expect on a typical x64 machine.</p>
<p>A <span style="font-family: 'courier new', courier, monospace;">char</span> consumes 8 bits of memory, meaning that it can store the following values:</p>
<p><center><a href="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-2.png"><img class="aligncenter wp-image-159432" src="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-2-300x83.png" alt="" width="350" height="97" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-2-300x83.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-2.png 725w" sizes="(max-width: 350px) 100vw, 350px" /></a></center>&nbsp;</p>
<p>Notice that a <span style="font-family: 'courier new', courier, monospace;">char</span> can only store values down to a minimum of -128 and up to a maximum of 127.</p>
<p>But there is another “mode” of the <span style="font-family: 'courier new', courier, monospace;">char</span> integer type that only stores non-negative integers:</p>
<p><center><a href="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-3.png"><img class="aligncenter wp-image-159433" src="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-3-300x83.png" alt="" width="350" height="97" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-3-300x83.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-3.png 724w" sizes="(max-width: 350px) 100vw, 350px" /></a></center>&nbsp;</p>
<p>Integer types have both signed and unsigned modes. Signed types can store negative values, whereas unsigned types cannot.</p>
<p>The following table shows some of the principal integer types in the programming language C, their sizes on a typical x64 machine, and the range of values they can store:</p>
<p><em>Table 1. Integer types, their typical sizes and ranges for the <a href="https://docs.microsoft.com/en-us/cpp/cpp/data-type-ranges?view=msvc-170" target="_blank" rel="noopener">Microsoft C++ (MSVC) compiler toolset</a></em></p>

<table id="tablepress-1079" class="tablepress tablepress-id-1079">
<thead>
<tr class="row-1 odd">
	<th class="column-1">Type</th><th class="column-2">Size (bit width)</th><th class="column-3">Range</th>
</tr>
</thead>
<tbody class="row-hover">
<tr class="row-2 even">
	<td rowspan="2" class="column-1"><span style="font-family: courier new, courier, monospace;">char</span></td><td rowspan="2" class="column-2">8</td><td class="column-3">signed: −128 to 127</td>
</tr>
<tr class="row-3 odd">
	<td class="column-3">unsigned: 0 to 255</td>
</tr>
<tr class="row-4 even">
	<td rowspan="2" class="column-1"><span style="font-family: courier new, courier, monospace;">short int</span></td><td rowspan="2" class="column-2">16</td><td class="column-3">signed: −32,768 to 32,767</td>
</tr>
<tr class="row-5 odd">
	<td class="column-3">unsigned: 0 to 65,535</td>
</tr>
<tr class="row-6 even">
	<td rowspan="2" class="column-1"><span style="font-family: courier new, courier, monospace;">int</span></td><td rowspan="2" class="column-2">32</td><td class="column-3">signed: −2,147,483,648 to 2,147,483,647</td>
</tr>
<tr class="row-7 odd">
	<td class="column-3">unsigned: 0 to 4,294,967,295</td>
</tr>
<tr class="row-8 even">
	<td rowspan="2" class="column-1"><span style="font-family: courier new, courier, monospace;">long long int</span></td><td rowspan="2" class="column-2">64</td><td class="column-3">signed: −9,223,372,036,854,775,808 to 9,223,372,036,854,775,807</td>
</tr>
<tr class="row-9 odd">
	<td class="column-3">unsigned: 0 to 18,446,744,073,709,551,615</td>
</tr>
</tbody>
</table>

<h2>What is an integer overflow?</h2>
<p>An integer overflow or wraparound happens when an attempt is made to store a value that is too large for an integer type. The range of values that can be stored in an integer type is better represented as a circular number line that wraps around. The circular number line for a signed char can be represented as the following:</p>
<p><center><a href="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-4.png"><img class="aligncenter wp-image-159434 size-full" src="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-4.png" alt="" width="429" height="510" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-4.png 429w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-4-252x300.png 252w" sizes="(max-width: 429px) 100vw, 429px" /></a></center>&nbsp;</p>
<p>If an attempt is made to store a number greater than 127 in a signed <span style="font-family: 'courier new', courier, monospace;">char</span>, the count wraps around to −128 and continues upwards, toward zero, from there. Thus, instead of what should be 128 the value −128 is stored, instead of 129 the value −127, and so on.</p>
<p>Looking at the problem in reverse, if an attempt is made to store a number less than -128 in a signed <span style="font-family: 'courier new', courier, monospace;">char</span>, the count wraps around to 127 and continues downwards, toward zero, from there. Thus, instead of what should be −129 the value 127 is stored, instead of −129 the value 126, and so on. This is sometimes called an <em>integer underflow</em>.</p>
<h2>Hunting down the elusive integer overflow</h2>
<p>Thinking of an integer overflow as a circle of values that wrap around makes it fairly easy to understand. However, it’s when we get down to the nitty gritty of “casting” integer types and porting and compiling programs that we can better understand some of the challenges involved in avoiding integer overflows.</p>
<h3>Watch your casts</h3>
<p>Sometimes it is useful, or even required, to store a value in a different type than the one originally used – <em>casting</em>, or “type conversion”, allows programmers to do that. Although some casts are safe, others are not because they can lead to integer overflows. A cast is considered safe when the original value is guaranteed to be preserved.</p>
<p>It is safe to cast a value stored in a smaller (in terms of bit width) integer type to a larger integer type within the same mode – from a smaller unsigned type to a larger unsigned type and from a smaller signed type to a larger signed type. Thus, it is safe to cast from a signed <span style="font-family: 'courier new', courier, monospace;">char</span> to a signed <span style="font-family: 'courier new', courier, monospace;">short int</span> because a signed <span style="font-family: 'courier new', courier, monospace;">short int</span> is large enough to store all the possible values that can be stored in a signed <span style="font-family: 'courier new', courier, monospace;">char</span>:</p>
<p><center><a href="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-5.png"><img class="aligncenter wp-image-159435" src="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-5-150x150.png" alt="" width="700" height="385" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-5-300x165.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-5-768x423.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-5-1024x563.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-5-143x79.png 143w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-5-298x165.png 298w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-5.png 1425w" sizes="(max-width: 700px) 100vw, 700px" /></a></center>&nbsp;</p>
<p>Casting between signed and unsigned integers is a red flag for integer overflows as the values cannot be guaranteed to remain the same. When casting from a signed type to an unsigned type (even if it’s larger) an integer overflow can happen because unsigned types cannot store negative values:</p>
<p><center><a href="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-6.png"><img class="wp-image-159436 aligncenter" src="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-6-150x150.png" alt="" width="700" height="395" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-6-300x169.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-6-768x433.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-6-1024x577.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/02/Figure-6.png 1373w" sizes="(max-width: 700px) 100vw, 700px" /></a></center>&nbsp;</p>
<p>All the negative signed <span style="font-family: 'courier new', courier, monospace;">char</span> values to the left of the red line in the image above from −128 to −1 will cause an integer overflow and become high positive values when cast to an unsigned type. −128 becomes 128, −127 becomes 129, and so on.</p>
<p>In reverse, when casting from an unsigned type to a signed type <em>of the same size</em>, an integer overflow can happen because the upper half of the positive values that can be stored in an unsigned type exceed the maximum value that can be stored in a signed type of that size.</p>
<p>All the high positive unsigned <span style="font-family: 'courier new', courier, monospace;">char</span> values to the left of the red line in the above image from 128 to 255 will cause an integer overflow and become negative values when cast to a signed type of the same size. 128 becomes −128, 129 becomes −127, and so on.</p>
<p>Casting from an unsigned typed to a signed type <em>of a larger size</em> is more forgiving because it carries no risk of an integer overflow: all the values that can be stored in a smaller unsigned type can also be stored in a larger signed type.</p>
<h3>Implicit upcasts: Beware of the “prejudice” for 32 bits</h3>
<p>Although having the ability to explicitly cast integer types is useful, it is important to be aware of how compilers implicitly upcast the operands of operators (arithmetic, binary, Boolean, and unary). In many cases, these implicit upcasts help prevent integer overflows because they promote operands to larger-sized integer types before operating on them — indeed, the underlying hardware commonly requires operations to be done on operands of the same type and compilers will promote smaller-sized operands to larger ones to achieve this goal.</p>
<p>However, the rules for implicit upcasts favor 32-bit types, meaning that the consequences can at times be unexpected for the programmer. The rules follow a priority. First, if one or both of the operands is a 64-bit integer type (<span style="font-family: 'courier new', courier, monospace;">long long int</span>), the other operand is upcast to 64 bits, if it is not already one, and the result is a 64-bit type. Second, if one or both of the operands is a 32-bit integer type (<span style="font-family: 'courier new', courier, monospace;">int</span>), the other operand is upcast to a 32-bit type, if it is not already one, and the result is a 32-bit type.</p>
<p>Now here is the exception to this pattern that can easily trip up programmers. If one or both of the operands are 16-bit types (<span style="font-family: 'courier new', courier, monospace;">short int</span>) or 8-bit types (<span style="font-family: 'courier new', courier, monospace;">char</span>), the operands <em>are upcast</em> to 32 bits before the operation is performed and the result is a 32-bit type (<span style="font-family: 'courier new', courier, monospace;">int</span>). The only operators that are an exception to this behavior are the pre- and postfix increment and decrement operators (++, &#8211;), which means that a 16-bit (<span style="font-family: 'courier new', courier, monospace;">short int</span>) operand, for instance, is not upcast and the result is also 16 bits.</p>
<p>The “prejudiced” upcast of 8-bit and 16-bit operands to 32-bits is critical to understand when making checks to prevent integer overflows. If you think you are adding two <span style="font-family: 'courier new', courier, monospace;">char</span> or two <span style="font-family: 'courier new', courier, monospace;">short int</span> types, you are mistaken because they are implicitly upcast to <span style="font-family: 'courier new', courier, monospace;">int</span> types and return an <span style="font-family: 'courier new', courier, monospace;">int</span> result. With a 32-bit result being returned by the operation, it is necessary to downcast the result to 16 or 8 bits before checking for an integer overflow. Otherwise, there is a risk of not detecting an integer overflow because an <span style="font-family: 'courier new', courier, monospace;">int</span> won’t overflow with the comparatively small values that a <span style="font-family: 'courier new', courier, monospace;">short int</span> or a <span style="font-family: 'courier new', courier, monospace;">char</span> might provide as operands.</p>
<h3>Code portability issues I – different compilers</h3>
<p>Creating different builds of a program that can run on different architectures is an important consideration at software design time. Not only can it be a headache to rewrite code that was poorly planned out for different builds, but it can also lead to integer overflows if care is not taken.</p>
<p>Compilers, which are used to build code for different target machines, are expected to support the standard of a programming language, but there are certain implementation details that are undefined and left to the decision of compiler developers. The sizes of integer types in C is one of those details with only a bare skeleton of guidance in the C language standard, meaning that not understanding the implementation details for your compiler and target machine is a recipe for possible disaster.</p>
<p>The number of bits consumed by each integer type described in Table 1 is the scheme used by the Microsoft C++ (MSVC) compiler toolset, which <a href="https://docs.microsoft.com/en-us/cpp/build/walkthrough-compiling-a-native-cpp-program-on-the-command-line?view=msvc-170" target="_blank" rel="noopener">includes a C compiler</a>, when targeting 32-bit, 64-bit, and ARM processors. However, different compilers that implement the C standard can use different schemes. Let’s consider an integer type called a <span style="font-family: 'courier new', courier, monospace;">long</span>.</p>
<p>For the MSVC compiler, a <span style="font-family: 'courier new', courier, monospace;">long</span> <a href="https://docs.microsoft.com/en-us/cpp/build/common-visual-cpp-64-bit-migration-issues?view=msvc-170" target="_blank" rel="noopener">consumes</a> 32 bits regardless of whether the build is for a 32-bit or 64-bit program. For the IBM XL C compiler, however, a long <a href="https://www.ibm.com/docs/en/xl-c-aix/13.1.2?topic=guide-using-32-bit-64-bit-modes">consumes</a> 32 bits in a 32-bit build and 64 bits in a 64-bit build. It is critical to know the sizes and maximum and minimum values an integer type can hold in order to check for integer overflows correctly for all your builds.</p>
<h3>Code portability issues II – different builds</h3>
<p>Another portability issue to watch out for is in the use of <span style="font-family: 'courier new', courier, monospace;">size_t</span>, which is an unsigned integer type, and <span style="font-family: 'courier new', courier, monospace;">ptrdiff_t</span>, which is a signed integer type. These types <a href="https://docs.microsoft.com/en-us/cpp/build/common-visual-cpp-64-bit-migration-issues?view=msvc-170" target="_blank" rel="noopener">consume</a> 32 bits in a 32-bit build and 64 bits in a 64-bit build for the MSVC compiler. A piece of code that decides whether to branch based on a comparison in which one of the operands is of one of these types could lead the program down different execution paths depending on whether it is part of a 32-bit build or a 64-bit build.</p>
<p>For example, in a 32-bit build, a comparison between a <span style="font-family: 'courier new', courier, monospace;">ptrdiff_t</span> and an unsigned int means that the compiler casts the <span style="font-family: 'courier new', courier, monospace;">ptrdiff_t</span> to an unsigned <span style="font-family: 'courier new', courier, monospace;">int</span> and so a negative value becomes a high positive value — an integer overflow that then leads to an unexpected path in the program being executed, or an access violation. But in a 64-bit build, the compiler upcasts the unsigned <span style="font-family: 'courier new', courier, monospace;">int</span> to a signed 64-bit type, meaning there is no integer overflow and the expected path in the program is executed.</p>
<h2>How an integer overflow leads to a buffer overflow</h2>
<p>The principal manner in which an integer overflow vulnerability can be exploited is by circumventing any checks that limit the length of data to be stored in a buffer so as to induce a <a href="https://www.welivesecurity.com/2021/12/06/what-are-buffer-overflow-attacks-how-are-they-thwarted/" target="_blank" rel="noopener">buffer overflow</a>. This opens the door to the vast array of buffer overflow exploitation techniques that lead to further problems like escalation of privilege and execution of arbitrary code.</p>
<p>Let’s consider the following contrived example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6237ebb8d08d4451668665" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-always" style=" margin-top: 12px; margin-bottom: 12px; margin-right: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">C</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
#include &lt;string.h&gt;
#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

int MAX_BUFFER_LENGTH = 11;     // [1]

char* initializeBuffer () {
	char* buffer = (char*) malloc(MAX_BUFFER_LENGTH * sizeof(char));

	if (buffer == NULL) {
		printf("Could not allocate memory on the heap\n");
	}

    return buffer;
}

int main(void) {
	signed int buffer_length;
	char* source_buffer = "0123456789";               // Arbitrary test data
	char* destination_buffer = NULL;

	buffer_length = -1;                               // Hypothetical attacker-controlled variable
	printf("buffer_length as a signed int is %d and implicitly cast to an unsigned int is %u\n", buffer_length, buffer_length);

	// [2] Faulty size check    
	if (buffer_length &gt; MAX_BUFFER_LENGTH) {        
		printf("Integer overflow detected\n");
	}
	else {
		destination_buffer = initializeBuffer();        
	
		// [3] Potential buffer overflow due to integer overflow
		strncpy(destination_buffer, source_buffer, buffer_length); 
		destination_buffer[buffer_length] = '\0';

        printf("Destination buffer contents: %s\n", destination_buffer);
	}

	free(destination_buffer);

	return 0;
}</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-2">2</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-4">4</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-6">6</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-8">8</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-10">10</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-12">12</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-14">14</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-16">16</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-18">18</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-20">20</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-22">22</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-24">24</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-26">26</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-28">28</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-30">30</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-32">32</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-34">34</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-36">36</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-38">38</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-40">40</div><div class="crayon-num" data-line="crayon-6237ebb8d08d4451668665-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08d4451668665-42">42</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-1"><span class="crayon-p">#include &lt;string.h&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-2"><span class="crayon-p">#include &lt;stdio.h&gt;</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-3"><span class="crayon-p">#include &lt;stdlib.h&gt;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-4">&nbsp;</div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-5"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">MAX_BUFFER_LENGTH</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// [1]</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-6">&nbsp;</div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-7"><span class="crayon-t">char</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-e">initializeBuffer</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-8"><span class="crayon-h">	</span><span class="crayon-t">char</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">buffer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-t">char</span><span class="crayon-o">*</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-r">malloc</span><span class="crayon-sy">(</span><span class="crayon-v">MAX_BUFFER_LENGTH</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-r">sizeof</span><span class="crayon-sy">(</span><span class="crayon-t">char</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-10"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">buffer</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-t">NULL</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-11"><span class="crayon-h">		</span><span class="crayon-r">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"Could not allocate memory on the heap\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-12"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-13">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-14"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-v">buffer</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-15"><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-16">&nbsp;</div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-17"><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-e">main</span><span class="crayon-sy">(</span><span class="crayon-t">void</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-18"><span class="crayon-h">	</span><span class="crayon-t">signed</span><span class="crayon-h"> </span><span class="crayon-t">int</span><span class="crayon-h"> </span><span class="crayon-v">buffer_length</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-19"><span class="crayon-h">	</span><span class="crayon-t">char</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">source_buffer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"0123456789"</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Arbitrary test data</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-20"><span class="crayon-h">	</span><span class="crayon-t">char</span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">destination_buffer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-t">NULL</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-21">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-22"><span class="crayon-h">	</span><span class="crayon-v">buffer_length</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-cn">1</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span class="crayon-c">// Hypothetical attacker-controlled variable</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-23"><span class="crayon-h">	</span><span class="crayon-r">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"buffer_length as a signed int is %d and implicitly cast to an unsigned int is %u\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">buffer_length</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">buffer_length</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-24">&nbsp;</div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-25"><span class="crayon-h">	</span><span class="crayon-c">// [2] Faulty size check&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-26"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">buffer_length</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">MAX_BUFFER_LENGTH</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-27"><span class="crayon-h">		</span><span class="crayon-r">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"Integer overflow detected\n"</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-28"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-29"><span class="crayon-h">	</span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-30"><span class="crayon-h">		</span><span class="crayon-v">destination_buffer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">initializeBuffer</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-31"><span class="crayon-h">	</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-32"><span class="crayon-h">		</span><span class="crayon-c">// [3] Potential buffer overflow due to integer overflow</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-33"><span class="crayon-h">		</span><span class="crayon-e">strncpy</span><span class="crayon-sy">(</span><span class="crayon-v">destination_buffer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">source_buffer</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">buffer_length</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-34"><span class="crayon-h">		</span><span class="crayon-v">destination_buffer</span><span class="crayon-sy">[</span><span class="crayon-v">buffer_length</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">'\0'</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-36"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-r">printf</span><span class="crayon-sy">(</span><span class="crayon-s">"Destination buffer contents: %s\n"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">destination_buffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-37"><span class="crayon-h">	</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-38">&nbsp;</div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-39"><span class="crayon-h">	</span><span class="crayon-e">free</span><span class="crayon-sy">(</span><span class="crayon-v">destination_buffer</span><span class="crayon-sy">)</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-40">&nbsp;</div><div class="crayon-line" id="crayon-6237ebb8d08d4451668665-41"><span class="crayon-h">	</span><span class="crayon-st">return</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">;</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08d4451668665-42"><span class="crayon-sy">}</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0011 seconds] -->
<p><em>Not accustomed to C? Run this code right in your browser with a <a href="https://colab.research.google.com/github/reneholt/secure-coding/blob/main/Integer_overflow.ipynb" target="_blank" rel="noopener">notebook</a> in Google Colab.</em></p>
<p>At [2], there is no check for negative values of <span style="font-family: 'courier new', courier, monospace;">buffer_length</span> meaning that it passes the check. Furthermore, the <span style="font-family: 'courier new', courier, monospace;">MAX_BUFFER_LENGTH</span> is a signed <span style="font-family: 'courier new', courier, monospace;">int</span>, but it should have been declared at [1] as an unsigned integer type because negative values should never be used when assigning buffer lengths. As an unsigned integer type, the compiler would have implicitly cast the buffer_length to an unsigned int at the check at [2] leading to detection of the integer overflow.</p>
<p>But with the −1 stored in <span style="font-family: 'courier new', courier, monospace;">buffer_length</span> slipping past the check and the compiler implicitly casting it as an unsigned <span style="font-family: 'courier new', courier, monospace;">int</span> in the <span style="font-family: 'courier new', courier, monospace;">initializeBuffer</span> function at [3] instead, it overflows to a high positive value of around 4 billion, quite beyond the maximum expected buffer length of 11.</p>
<p>This integer overflow then leads directly to a buffer overflow because <span style="font-family: 'courier new', courier, monospace;">strncpy</span> attempts to make a copy of around 4GB of data from the source buffer into the destination buffer. Thus, even though an attempt is made to prevent a buffer overflow with the size check at [2], the check is made incorrectly and an integer overflow occurs that leads directly to a buffer overflow.</p>
<p>When handling casts between signed and unsigned integer types, it’s not enough to make a size check for a value that is greater than the expected maximum value. It’s also critical to check for a value that is less than the expected minimum value:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-6237ebb8d08ea063857577" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style=" margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important;">
		
			<div class="crayon-toolbar" data-settings=" mouseover hide delay" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title"></span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="dblclick" readonly style="-moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4; font-size: 12px !important; line-height: 15px !important;">
// [2] Corrected size check
if (buffer_length &lt; 0 || buffer_length &gt; MAX_BUFFER_LENGTH) {</textarea></div>
			<div class="crayon-main" style="">
				<table class="crayon-table">
					<tr class="crayon-row">
				<td class="crayon-nums " data-settings="hide">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-6237ebb8d08ea063857577-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-6237ebb8d08ea063857577-2">2</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-6237ebb8d08ea063857577-1"><span class="crayon-c">// [2] Corrected size check</span></div><div class="crayon-line crayon-striped-line" id="crayon-6237ebb8d08ea063857577-2"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">buffer_length</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-h"> </span><span class="crayon-o">||</span><span class="crayon-h"> </span><span class="crayon-v">buffer_length</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">MAX_BUFFER_LENGTH</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-sy">{</span></div></div></td>
					</tr>
				</table>
			</div>
		</div>
<!-- [Format Time: 0.0002 seconds] -->
<p></p>
<h2>Rules of thumb</h2>
<p>Various strategies can be employed to check for and handle possible integer overflows in your code, some of which have a trade-off in portability vs. speed. Without considering those here, keep in mind at least the following guidelines:</p>
<ul>
<li>Prefer using unsigned integer types whenever possible. Remember, there is no sense in using a signed integer type to allocate memory because a negative value is never valid in this situation.</li>
<li>Review and test your code by writing out all casts explicitly to see more easily where implicit casts might cause integer overflows.</li>
<li>Turn on any options available in your compilers that can help identify certain types of integer overflows. For example, the GCC compiler has an <a href="https://gcc.gnu.org/onlinedocs/gcc-4.5.1/gcc/Code-Gen-Options.html" target="_blank" rel="noopener">-ftrapv</a> option that checks for signed integer overflows.</li>
</ul>
<p>Integer overflows are not a problem that is going to disappear anytime soon. Indeed, there are many older Unix-like systems that have a similar bug to Y2K22 “scheduled” to appear in 2038, which is hence called Y2K38. Before 64-bit systems were commonplace, 32-bit systems ruled the land, meaning that Unix time was stored as a signed 32-bit integer. Because Unix time begins counting seconds from 00:00:00 UTC on January 1, 1970, 32-bit time can only take us a few hours into January 19, 2038 before wrapping around. Luckily, knowing of the problem ahead of time allows us to prepare and update many vulnerable systems before we roll around the circle and slide back to 1901.</p>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/rholt/" title="Rene Holt">
                    Rene Holt                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2022-02-21 11:30:19">21 Feb 2022 - 11:30AM</time>
                                    </span>
                                </div>
                            
                            <div class="widgets row">
                                <div class="col-md-12 col-sm-12 col-xs-12">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                                        <h3><span class="text">Newsletter</span></h3>
                                    </div>
                                </div>
                                <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
                                    		<div class="heading-line col-md-12 no-padding sidebar-item clearfix">
			<h3>
				<span class="text">Newsletter</span>
			</h3>

			<form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
				<div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button>
						Submit					</button>
				</div>
			</form>
		</div>
                                </div>
                            </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/secure-coding/" class="category-tag-btn">secure coding</a>                                                <a href="https://www.welivesecurity.com/2021/12/06/what-are-buffer-overflow-attacks-how-are-they-thwarted/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/12/buffer-overflow-vulnerability-attack-623x415.jpg"
                                                         alt="Integer overflow: How does it occur and how can it be prevented?">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/12/06/what-are-buffer-overflow-attacks-how-are-they-thwarted/">
                                                    What are buffer overflow attacks and how are they thwarted?                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/secure-coding/" class="category-tag-btn">secure coding</a>                                                <a href="https://www.welivesecurity.com/2018/09/13/programmers-day-resources-audit-code/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/09/día-programador-recursos-auditar-codigo.jpg"
                                                         alt="Integer overflow: How does it occur and how can it be prevented?">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/09/13/programmers-day-resources-audit-code/">
                                                    Programmer's Day: Resources to audit your code                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/secure-coding/" class="category-tag-btn">secure coding</a>                                                <a href="https://www.welivesecurity.com/2018/08/13/cramming-code-bugs-secure/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/08/CrammingCode_Bugs-623x432.jpg"
                                                         alt="Integer overflow: How does it occur and how can it be prevented?">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/08/13/cramming-code-bugs-secure/">
                                                    Can cramming code with bugs make it more secure? Some think so                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/secure-coding/" class="category-tag-btn">secure coding</a>                                                <a href="https://www.welivesecurity.com/2018/07/05/five-tips-pentesters-ios/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2018/06/consejos-pentesters-iOS.jpg"
                                                         alt="Integer overflow: How does it occur and how can it be prevented?">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2018/07/05/five-tips-pentesters-ios/">
                                                    Five tips for pentesters in iOS                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F02%2F21%2Finteger-overflow-how-it-occur-can-be-prevented%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F02%2F21%2Finteger-overflow-how-it-occur-can-be-prevented%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F02%2F21%2Finteger-overflow-how-it-occur-can-be-prevented%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.7.3.41514b.pro.azeu -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"159397 https:\/\/backend.welivesecurity.com\/?p=159397","disqusShortname":"welivesecurity","disqusTitle":"Integer overflow: How does it occur and how can it be prevented?","disqusUrl":"https:\/\/www.welivesecurity.com\/2022\/02\/21\/integer-overflow-how-it-occur-can-be-prevented\/","postId":"159397"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/tablepress/js/jquery.datatables.min.js?ver=1.9.1'></script>
<script type="text/javascript">
jQuery(document).ready(function($){
$('#tablepress-1079').dataTable({"order":[],"orderClasses":false,"stripeClasses":["even","odd"],"pagingType":"simple"});
});
</script>    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
