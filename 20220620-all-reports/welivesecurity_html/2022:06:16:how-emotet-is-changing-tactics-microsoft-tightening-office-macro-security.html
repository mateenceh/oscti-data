<!doctype html>
<html lang="en-US" prefix="og: http://ogp.me/ns#">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <meta name="google-site-verification" content="_b2avZwzr79oru6lM2Ddae1fNpSIbPaP0H0WNkc2x3k"/>
    <meta name="msvalidate.01" content="CE77828A466C2513F660017CFCB6BA13"/>
    <link rel="icon" href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/favicon.ico">

    

            
    
    <link href="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/css/main.css?id=b3e7fe8a6c3736dca145" rel="stylesheet">
    <script type="text/javascript"> var appInsights=window.appInsights||function(a){ function b(a){c[a]=function(){var b=arguments;c.queue.push(function(){c[a].apply(c,b)})}}var c={config:a},d=document,e=window;setTimeout(function(){var b=d.createElement("script");b.src=a.url||"https://az416426.vo.msecnd.net/scripts/a/ai.0.js",d.getElementsByTagName("script")[0].parentNode.appendChild(b)});try{c.cookie=d.cookie}catch(a){}c.queue=[];for(var f=["Event","Exception","Metric","PageView","Trace","Dependency"];f.length;)b("track"+f.pop());if(b("setAuthenticatedUserContext"),b("clearAuthenticatedUserContext"),b("startTrackEvent"),b("stopTrackEvent"),b("startTrackPage"),b("stopTrackPage"),b("flush"),!a.disableExceptionTracking){f="onerror",b("_"+f);var g=e[f];e[f]=function(a,b,d,e,h){var i=g&&g(a,b,d,e,h);return!0!==i&&c["_"+f](a,b,d,e,h),i}}return c }({ instrumentationKey:"dcb460fe-684e-4d39-bfcd-d3a6f2710a32" }); window.appInsights=appInsights,appInsights.queue&&0===appInsights.queue.length&&appInsights.trackPageView(); </script>
    <script>
        window.dataLayer = window.dataLayer || [];
    window.dataLayer.push({
        'Author': 'Rene Holt',
        'ArticleCategory': 'Malware',
        'ArticleSection': '(not set)',
        'cookie-bar-hq': true
    });
</script>
<script>
    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-PMDGSM');
</script>

<!-- This site is optimized with the Yoast SEO plugin v9.2 - https://yoast.com/wordpress/plugins/seo/ -->
<title>How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security | WeLiveSecurity</title>
<meta name="description" content="Emotet malware is back with ferocious vigor, according to recent ESET data. Will it survive the stricter controls on macro-enabled documents?"/>
<link rel="canonical" href="https://www.welivesecurity.com/2022/06/16/how-emotet-is-changing-tactics-microsoft-tightening-office-macro-security/" />
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="article" />
<meta property="og:title" content="How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security | WeLiveSecurity" />
<meta property="og:description" content="Emotet malware is back with ferocious vigor, according to recent ESET data. Will it survive the stricter controls on macro-enabled documents?" />
<meta property="og:url" content="https://www.welivesecurity.com/2022/06/16/how-emotet-is-changing-tactics-microsoft-tightening-office-macro-security/" />
<meta property="og:site_name" content="WeLiveSecurity" />
<meta property="article:section" content="Malware" />
<meta property="article:published_time" content="2022-06-16T09:30:53+00:00" />
<meta property="article:modified_time" content="2022-06-16T09:32:28+00:00" />
<meta property="og:updated_time" content="2022-06-16T09:32:28+00:00" />
<meta property="og:image" content="https://www.welivesecurity.com/wp-content/uploads/2022/06/emotet-malware-botnet-macros-mark-web.jpg" />
<meta property="og:image:secure_url" content="https://www.welivesecurity.com/wp-content/uploads/2022/06/emotet-malware-botnet-macros-mark-web.jpg" />
<meta property="og:image:width" content="623" />
<meta property="og:image:height" content="415" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Emotet malware is back with ferocious vigor, according to recent ESET data. Will it survive the stricter controls on macro-enabled documents?" />
<meta name="twitter:title" content="How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security | WeLiveSecurity" />
<meta name="twitter:site" content="@welivesecurity" />
<meta name="twitter:image" content="https://www.welivesecurity.com/wp-content/uploads/2022/06/emotet-malware-botnet-macros-mark-web.jpg" />
<meta name="twitter:creator" content="@welivesecurity" />
<!-- / Yoast SEO plugin. -->

<link rel="alternate" type="application/rss+xml" title="WeLiveSecurity RSS 2.0 Feed" href="/rss-configurator/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
        <link id="cookie-style" rel="stylesheet" type="text/css" href="https://assets.esetstatic.com/3PS/cookiebar.min.css">

<script>(window.BOOMR_mq=window.BOOMR_mq||[]).push(["addVar",{"rua.upush":"false","rua.cpush":"false","rua.upre":"false","rua.cpre":"false","rua.uprl":"false","rua.cprl":"false","rua.cprf":"false","rua.trans":"","rua.cook":"false","rua.ims":"false","rua.ufprl":"false","rua.cfprl":"false","rua.isuxp":"false","rua.texp":"norulematch"}]);</script>
                              <script>!function(e){var n="https://s.go-mpulse.net/boomerang/";if("False"=="True")e.BOOMR_config=e.BOOMR_config||{},e.BOOMR_config.PageParams=e.BOOMR_config.PageParams||{},e.BOOMR_config.PageParams.pci=!0,n="https://s2.go-mpulse.net/boomerang/";if(window.BOOMR_API_key="7R9SM-QGSYF-QDLJK-UETXR-SPM6B",function(){function e(){if(!o){var e=document.createElement("script");e.id="boomr-scr-as",e.src=window.BOOMR.url,e.async=!0,i.parentNode.appendChild(e),o=!0}}function t(e){o=!0;var n,t,a,r,d=document,O=window;if(window.BOOMR.snippetMethod=e?"if":"i",t=function(e,n){var t=d.createElement("script");t.id=n||"boomr-if-as",t.src=window.BOOMR.url,BOOMR_lstart=(new Date).getTime(),e=e||d.body,e.appendChild(t)},!window.addEventListener&&window.attachEvent&&navigator.userAgent.match(/MSIE [67]\./))return window.BOOMR.snippetMethod="s",void t(i.parentNode,"boomr-async");a=document.createElement("IFRAME"),a.src="about:blank",a.title="",a.role="presentation",a.loading="eager",r=(a.frameElement||a).style,r.width=0,r.height=0,r.border=0,r.display="none",i.parentNode.appendChild(a);try{O=a.contentWindow,d=O.document.open()}catch(_){n=document.domain,a.src="javascript:var d=document.open();d.domain='"+n+"';void(0);",O=a.contentWindow,d=O.document.open()}if(n)d._boomrl=function(){this.domain=n,t()},d.write("<bo"+"dy onload='document._boomrl();'>");else if(O._boomrl=function(){t()},O.addEventListener)O.addEventListener("load",O._boomrl,!1);else if(O.attachEvent)O.attachEvent("onload",O._boomrl);d.close()}function a(e){window.BOOMR_onload=e&&e.timeStamp||(new Date).getTime()}if(!window.BOOMR||!window.BOOMR.version&&!window.BOOMR.snippetExecuted){window.BOOMR=window.BOOMR||{},window.BOOMR.snippetStart=(new Date).getTime(),window.BOOMR.snippetExecuted=!0,window.BOOMR.snippetVersion=12,window.BOOMR.url=n+"7R9SM-QGSYF-QDLJK-UETXR-SPM6B";var i=document.currentScript||document.getElementsByTagName("script")[0],o=!1,r=document.createElement("link");if(r.relList&&"function"==typeof r.relList.supports&&r.relList.supports("preload")&&"as"in r)window.BOOMR.snippetMethod="p",r.href=window.BOOMR.url,r.rel="preload",r.as="script",r.addEventListener("load",e),r.addEventListener("error",function(){t(!0)}),setTimeout(function(){if(!o)t(!0)},3e3),BOOMR_lstart=(new Date).getTime(),i.parentNode.appendChild(r);else t(!1);if(window.addEventListener)window.addEventListener("load",a,!1);else if(window.attachEvent)window.attachEvent("onload",a)}}(),"".length>0)if(e&&"performance"in e&&e.performance&&"function"==typeof e.performance.setResourceTimingBufferSize)e.performance.setResourceTimingBufferSize();!function(){if(BOOMR=e.BOOMR||{},BOOMR.plugins=BOOMR.plugins||{},!BOOMR.plugins.AK){var n=""=="true"?1:0,t="",a="qcw62iqx3veqwyvllqaq-f-48cc49300-clientnsv4-s.akamaihd.net",i="false"=="true"?2:1,o={"ak.v":"32","ak.cp":"1251022","ak.ai":parseInt("757730",10),"ak.ol":"0","ak.cr":14,"ak.ipv":4,"ak.proto":"http/1.1","ak.rid":"5b5f569e","ak.r":34010,"ak.a2":n,"ak.m":"dscr","ak.n":"ff","ak.bpcip":"128.173.237.0","ak.cport":52680,"ak.gh":"23.221.73.7","ak.quicv":"","ak.tlsv":"tls1.3","ak.0rtt":"","ak.csrc":"-","ak.acc":"reno","ak.t":"1655397377","ak.ak":"hOBiQwZUYzCg5VSAfCLimQ==o4Pa1a5PVt2NXM8sDyxvxDZup05TN2M19jfjYNVHvYmSJ3PfqnNFhKvWNWg8mYvj9bs7FjGFMJstG8+4LpC0Dt830Us6thn9rzjS7NLjXACFC5UG1Bon2asSpQT3pDZK2PrSLBtu3VuDEkS2UaoDkEFnsmKkldirnhp0nQj0qBlhJWMARBwU4XgDFBTazoNW7XU08yqT0iQNN2IYr//EWcL07IkuOqdZyt51ZHYZI4aCqu7c86FzrmyGe/P0Oqt8oAuPXUxuGEdsBLS1MbEZhvEo/RZc78HmuaItsrMeurXYOJ2KO32UNJkwU/x3mPBqCLDqdHaFkvcOJKZ99+aT6MG3YVKT0ardp/nwEa3OU1hU6ogjk+wVkqwHWuLZscRtIMO/JcWysGzsTPlMFtrpf19BBLvS4sGOUABTcQ7weiw=","ak.pv":"11","ak.dpoabenc":"","ak.tf":i};if(""!==t)o["ak.ruds"]=t;var r={i:!1,av:function(n){var t="http.initiator";if(n&&(!n[t]||"spa_hard"===n[t]))o["ak.feo"]=void 0!==e.aFeoApplied?1:0,BOOMR.addVar(o)},rv:function(){var e=["ak.bpcip","ak.cport","ak.cr","ak.csrc","ak.gh","ak.ipv","ak.m","ak.n","ak.ol","ak.proto","ak.quicv","ak.tlsv","ak.0rtt","ak.r","ak.acc","ak.t","ak.tf"];BOOMR.removeVar(e)}};BOOMR.plugins.AK={akVars:o,akDNSPreFetchDomain:a,init:function(){if(!r.i){var e=BOOMR.subscribe;e("before_beacon",r.av,null,null),e("onbeacon",r.rv,null,null),r.i=!0}return this},is_complete:function(){return!0}}}}()}(window);</script></head>
<body class="no-js single wide">
<noscript>
	<iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PMDGSM" height="0" width="0" style="display:none;visibility:hidden"></iframe>
</noscript>

<div class="main">
    <header id="site-header" class="container">
        <div class="row">
            <div class="col-md-4 col-sm-12 col-xs-12 pull-right" id="header-nav">
                <div class="row">
                    <div class="hidden-lg hidden-md col-sm-7 col-xs-8 hidden-xxs">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
                    <div class="col-md-8 hidden-sm hidden-xs languages">
                        <div class="dropdown">
	<button class="btn btn-default dropdown-toggle" type="button" id="main-language-picker" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
    	<span class="text">In English</span>
    	<span class="icomoon icon-icon_arrow"></span>
  	</button>
  	<ul class="dropdown-menu" aria-labelledby="main-language-picker">
            <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
      	</ul>
</div>                    </div>
                    <div class="col-md-4 col-sm-2 col-xs-3 menu-trigger">
                        <div class="menu-btn">
	<span class="text">Menu</span>
	<button type="button" id="menu-trigger" class="tcon tcon-menu--xcross" aria-label="toggle menu">
        <span class="wrapper">
            <span class="tcon-menu__lines" aria-hidden="true"></span>
            <span class="tcon-visuallyhidden">toggle menu</span>
        </span>
    </button>
</div>                    </div>
                    <div class="col-md-12 col-sm-12 col-xs-12 imc" id="main-menu">
                        <nav class="menu clearfix imc">
                            <ul class="col-md-12 col-sm-6 col-xs-6 imc">
                                                                    <li class="">
                                        <a href="/">
                                            All Posts                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="http://welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/">
                                            Ukraine Crisis – Digital Security Resource Center                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/we-live-progress/">
                                            We Live Progress                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/research">
                                            Research                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="/category/how-to/">
                                            How To                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/media/videos/">
                                            Videos                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/conference-papers/">
                                            Conference Materials                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/white-papers/">
                                            White Papers                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/threat-reports/">
                                            Threat Reports                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/papers/magazine/">
                                            Magazine                                        </a>
                                    </li>
                                                                    <li class="">
                                        <a href="https://www.welivesecurity.com/our-experts/">
                                            Our Experts                                        </a>
                                    </li>
                                                            </ul>

                            <div class="col-md-12 col-sm-6 col-xs-6 imc">
                                <ul class="languages hidden-lg hidden-md hidden-xxs col-xs-12 imc">
                                        <li>
        <a href="/br/" title="Em Português">
            Em Português        </a>
    </li>
        <li>
        <a href="/fr/" title="En français">
            En français        </a>
    </li>
        <li>
        <a href="/la-es/" title="En Español">
            En Español        </a>
    </li>
        <li>
        <a href="/deutsch/" title="In Deutsch">
            In Deutsch        </a>
    </li>
                                    </ul>
                            </div>
                        </nav>
                    </div>
                    <div class="menu-overlay col-md-12 col-sm-12 col-xs-12 imc">
                        <div class="inner imc"></div>
                    </div>
                </div>
            </div>
            <div class="col-md-5 hidden-sm hidden-xs pull-left" id="header-logo">
                <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                <span class="slogan hidden-sm hidden-xs">
						Award-winning news, views, and insight from the ESET <strong>security community</strong>					</span>
            </div>
        </div>
    </header>
        <section id="article-detail">
            <div class="hero-wide" style="background-image: url('../../../../wp-content/uploads/2022/06/emotet-malware-botnet-macros.jpg'); background-position: 50% 50%;">
    <div class="text-wrapper">
        <div class="container promo-text">
            <div class="col-md-11 col-sm-11 col-xs-12 no-padding">
                <h1>How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security</h1>
<div class="excerpt">Emotet malware is back with ferocious vigor, according to ESET telemetry in the first four months of 2022. Will it survive the ever-tightening controls on macro-enabled documents?</div>
<div class="post-meta">
    <div class="wls-authors">
                <div class="wls-author with-avatar">
                            <div class="wls-author-avatar">
                    <a href="https://www.welivesecurity.com/author/rholt/" title="Rene Holt">
                        <img src="https://www.welivesecurity.com/wp-content/uploads/2021/10/Rene_Holt-222x179.jpg" alt="Rene Holt">
                    </a>
                </div>
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/rholt/" title="Rene Holt">
                    Rene Holt                </a>
            </div>
        </div>
            </div>
    <span class="meta">
		<span class="strong">
			<time datetime="2022-06-16 11:30:53">16 Jun 2022 - 11:30AM</time>
		</span>
			</span>
</div>
            </div>
        </div>
    </div>
</div>

            <div class="content">
                <div class="social-wrapper" id="social-sharer">
                    <span class="text">Share</span>
	<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F06%2F16%2Fhow-emotet-is-changing-tactics-microsoft-tightening-office-macro-security%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
		<span class="icomoon icon-icon_fb"></span>
	</a>
	<a class="share-twitter" href="https://twitter.com/intent/tweet?&url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F06%2F16%2Fhow-emotet-is-changing-tactics-microsoft-tightening-office-macro-security%2F&text=How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security%0A&via=welivesecurity" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
		<span class="icomoon icon-icon_tw"></span>
	</a>
	<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F06%2F16%2Fhow-emotet-is-changing-tactics-microsoft-tightening-office-macro-security%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
		<span class="icomoon icon-icon_in"></span>
	</a>
                </div>
                <div class="container">
                    <div class="row">
                        <div class="col-md-1 col-sm-1 hidden-xs">

                        </div>
                        <div class="col-md-10 col-sm-10 col-xs-12 formatted">

                            <div class="excerpt wide">
                                <p>Emotet malware is back with ferocious vigor, according to ESET telemetry in the first four months of 2022. Will it survive the ever-tightening controls on macro-enabled documents?</p>
                            </div>

                            <p>One of the key findings from the <a href="https://www.welivesecurity.com/2022/06/02/eset-threat-report-t12022/" target="_blank" rel="noopener">ESET Threat Report T1 2022</a> is that the Emotet botnet has risen, Phoenix-like, from the ashes, pumping out vast amounts of spam in March and April 2022, to the point that its detections grew more than a hundredfold in the first four months of 2022 compared to the last four months of 2021. Much of this activity involved Word documents tainted with malicious macros.</p>
<div id="attachment_163021" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-1.-Emotet-detections-in-ESET-telemetry.png"><img class="wp-image-163021" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-1.-Emotet-detections-in-ESET-telemetry-300x181.png" alt="" width="800" height="484" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-1.-Emotet-detections-in-ESET-telemetry-300x181.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-1.-Emotet-detections-in-ESET-telemetry-768x464.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-1.-Emotet-detections-in-ESET-telemetry-1024x619.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-1.-Emotet-detections-in-ESET-telemetry.png 1358w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 1. Emotet detections in ESET telemetry</em></p></div>
<p>Because Microsoft is <a href="https://techcommunity.microsoft.com/t5/microsoft-365-blog/helping-users-stay-safe-blocking-internet-macros-by-default-in/ba-p/3071805" target="_blank" rel="noopener">tightening up the default handling</a> of macro-enabled files, finagling recipients into clicking “Enable Content” will not remain a viable tactic for long. What does this mean for Emotet? Could this extremely pervasive threat even sink into oblivion barely a few months after it shook off the effects of the <a href="https://www.welivesecurity.com/2021/01/28/emotet-botnet-disrupted-global-operation/" target="_blank" rel="noopener">law enforcement operation</a> hailed as one of the largest of its kind ever?</p>
<p>Not so fast – Emotet’s operators aren’t known for resting on their laurels.</p>
<p><em><div class="update-block"></em></p>
<h2><em>Emotet – a macro view</em></h2>
<p><em>First sighted as a banking trojan in June 2014, Emotet has since changed drastically into a crime-as-a-service platform, selling access to compromised systems to other criminal groups. Thus, once Emotet is running on a computer, it typically downloads and executes other strains of malware, such as Dridex, Gootkit, IcedId, Nymaim, Qbot, TrickBot, Ursnif, and Zbot.</em></p>
<p><em>Emotet has a modular program design, with a main module that is disseminated through vast spam campaigns that distribute emails containing malicious Microsoft Word documents. Emotet then uses additional modules to:</em></p>
<ul>
<li><em>spread further by assembling and delivering spam emails</em></li>
<li><em>spread to nearby, insecure Wi-Fi networks by compromising connected users</em></li>
<li><em>brute-force network share usernames and passwords</em></li>
<li><em>turn compromised systems into proxies within its command-and-control infrastructure</em></li>
<li><em>abuse legitimate Nirsoft applications, such as MailPassView and WebBrowserView, that can recover passwords from popular email clients and web browsers, respectively.</em></li>
<li><em>steal email addresses and names from the compromised system’s Microsoft Outlook instance</em></li>
<li><em>steal all email messages and attachments from compromised systems</em></li>
</ul>
<p><em>In 2018, Emotet resuscitated an effective technique – email thread hijacking – to increase the likelihood of a potential victim opening the email attachments. It started stealing email conversations found in compromised systems’ inboxes and reusing them in its spam campaigns. This is, of course, a very effective way of adding legitimacy to a malicious email:</em></p>
<p style="text-align: center;"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-2.-Emotet’s-operators-use-macro-enabled-Word-documents-to-deliver-malware.png"><img class="aligncenter wp-image-163022" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-2.-Emotet’s-operators-use-macro-enabled-Word-documents-to-deliver-malware-300x106.png" alt="" width="900" height="319" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-2.-Emotet’s-operators-use-macro-enabled-Word-documents-to-deliver-malware-300x106.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-2.-Emotet’s-operators-use-macro-enabled-Word-documents-to-deliver-malware-768x273.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-2.-Emotet’s-operators-use-macro-enabled-Word-documents-to-deliver-malware-420x149.png 420w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-2.-Emotet’s-operators-use-macro-enabled-Word-documents-to-deliver-malware.png 989w" sizes="(max-width: 900px) 100vw, 900px" /></a><small><em>Figure 2. Emotet’s operators use macro-enabled Word documents to deliver malware</em></small></p>
<p><em>Should the victim extract the macro-laden Word document from the ZIP archive, open it, and then click “Enable Content”, the malicious macros can run, ultimately downloading Emotet. </em></p>
<p><em>Microsoft’s move (on February 30<sup>th</sup>, 2022, so to say) to </em><a href="https://techcommunity.microsoft.com/t5/microsoft-365-blog/helping-users-stay-safe-blocking-internet-macros-by-default-in/ba-p/3071805" target="_blank" rel="noopener"><em>throw out the “Enable Content” button</em></a><em> came at a time for Emotet when, after recovering from </em><a href="https://www.welivesecurity.com/2021/01/28/emotet-botnet-disrupted-global-operation/" target="_blank" rel="noopener"><em>last year’s takedown efforts</em></a><em>, it had been </em><a href="https://www.welivesecurity.com/2022/06/02/eset-threat-report-t12022/" target="_blank" rel="noopener"><em>churning out spam campaigns en masse</em></a><em> in March and April 2022. Taking note of the change, Emotet’s developers have shifted to experimenting with different techniques to replace their dependence on macros as the initial code stage of their malware delivery platform.</em></p>
<p><em></div></em></p>
<h2>Emotet shifting techniques</h2>
<p>Between April 26<sup>th</sup> and May 2<sup>nd</sup>, 2022, ESET researchers picked up a <a href="https://twitter.com/ESETresearch/status/1518923380782739458" target="_blank" rel="noopener">test campaign</a> run by Emotet operators where they replaced the typical Microsoft Word document with a shortcut (LNK) file as the malicious attachment.</p>
<div id="attachment_163028" style="width: 910px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-3.-A-malicious-email-sent-by-Emotets-operators.png"><img class="wp-image-163028" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-3.-A-malicious-email-sent-by-Emotets-operators-300x179.png" alt="" width="900" height="537" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-3.-A-malicious-email-sent-by-Emotets-operators-300x179.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-3.-A-malicious-email-sent-by-Emotets-operators-768x458.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-3.-A-malicious-email-sent-by-Emotets-operators-1024x611.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-3.-A-malicious-email-sent-by-Emotets-operators.png 1440w" sizes="(max-width: 900px) 100vw, 900px" /></a><p class="wp-caption-text"><em>Figure 3. A malicious email sent by Emotet&#8217;s operators</em></p></div>
<div id="attachment_163036" style="width: 910px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-4.Another-malicious-email-sent-by-Emotets-operators.png"><img class="wp-image-163036" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-4.Another-malicious-email-sent-by-Emotets-operators-300x171.png" alt="" width="900" height="513" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-4.Another-malicious-email-sent-by-Emotets-operators-300x171.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-4.Another-malicious-email-sent-by-Emotets-operators-768x437.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-4.Another-malicious-email-sent-by-Emotets-operators-1024x583.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-4.Another-malicious-email-sent-by-Emotets-operators.png 1443w" sizes="(max-width: 900px) 100vw, 900px" /></a><p class="wp-caption-text"><em>Figure 4. Another malicious email sent by Emotet&#8217;s operators</em></p></div>
<div id="attachment_163037" style="width: 910px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-5.Yet-another-malicious-email-sent-by-Emotets-operators.png"><img class="wp-image-163037" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-5.Yet-another-malicious-email-sent-by-Emotets-operators-300x161.png" alt="" width="900" height="484" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-5.Yet-another-malicious-email-sent-by-Emotets-operators-300x161.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-5.Yet-another-malicious-email-sent-by-Emotets-operators-768x413.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-5.Yet-another-malicious-email-sent-by-Emotets-operators-1024x550.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-5.Yet-another-malicious-email-sent-by-Emotets-operators.png 1440w" sizes="(max-width: 900px) 100vw, 900px" /></a><p class="wp-caption-text"><em>Figure 5. Yet another malicious email sent by Emotet&#8217;s operators</em></p></div>
<div id="attachment_163038" style="width: 910px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-6.And-another-malicious-email-sent-by-Emotets-operators.png"><img class="wp-image-163038" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-6.And-another-malicious-email-sent-by-Emotets-operators-300x188.png" alt="" width="900" height="564" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-6.And-another-malicious-email-sent-by-Emotets-operators-300x188.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-6.And-another-malicious-email-sent-by-Emotets-operators-768x482.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-6.And-another-malicious-email-sent-by-Emotets-operators-65x42.png 65w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-6.And-another-malicious-email-sent-by-Emotets-operators-275x172.png 275w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-6.And-another-malicious-email-sent-by-Emotets-operators.png 869w" sizes="(max-width: 900px) 100vw, 900px" /></a><p class="wp-caption-text"><em>Figure 6. And another malicious email sent by Emotet&#8217;s operators</em></p></div>
<p>When double-clicked, a shortcut file can launch a target resource, in this case, a PowerShell script that downloaded and executed Emotet:</p>
<div id="attachment_163027" style="width: 878px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-7.-Emotet’s-operators-use-shortcut-LNK-files-to-deliver-malware.png"><img class="wp-image-163027" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-7.-Emotet’s-operators-use-shortcut-LNK-files-to-deliver-malware-300x89.png" alt="" width="868" height="259" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-7.-Emotet’s-operators-use-shortcut-LNK-files-to-deliver-malware-300x89.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-7.-Emotet’s-operators-use-shortcut-LNK-files-to-deliver-malware-768x229.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-7.-Emotet’s-operators-use-shortcut-LNK-files-to-deliver-malware-1024x305.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-7.-Emotet’s-operators-use-shortcut-LNK-files-to-deliver-malware.png 1212w" sizes="(max-width: 868px) 100vw, 868px" /></a><p class="wp-caption-text"><em>Figure 7. Emotet’s operators use shortcut (LNK) files to deliver malware</em></p></div>
<p>Most <a href="https://www.welivesecurity.com/2022/06/02/eset-threat-report-t12022/">detections</a> were in Japan (28%), Italy (16%), and Mexico (11%).</p>
<p>In an earlier test campaign between April 4<sup>th</sup> and April 19<sup>th</sup>, the Emotet operators attracted victims to a ZIP archive, stored on OneDrive, containing Microsoft Excel Add-in (XLL) files, which are used to add custom functions to Excel. If extracted and executed, these files dropped and ran Emotet.</p>
<p>When Emotet’s operators first resurrected their botnet from the takedown efforts in late 2021, another <a href="https://www.bleepingcomputer.com/news/security/emotet-now-drops-cobalt-strike-fast-forwards-ransomware-attacks/" target="_blank" rel="noopener">campaign was discovered</a> that uses <a href="https://malpedia.caad.fkie.fraunhofer.de/details/win.cobalt_strike" target="_blank" rel="noopener">Cobalt Strike Beacon</a>, a popular pentesting tool. By using a Beacon, the Emotet operators can decrease the time to deploy their final payload – often ransomware.</p>
<h2>Mitigating macro malware</h2>
<p>Emailing documents that contain macros is both a common occurrence in corporate environments and can serve as a technique to deliver malware when those macros are malicious. Recognizing this potential abuse of macros, during the heyday of Word 97 Microsoft introduced the first built-in security feature in Word that blocked Visual Basic for Applications (VBA) macros from running:</p>
<div id="attachment_163039" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-8.-The-default-behavior-of-Word-97-when-opening-a-document-containing-a-VBA-macro.png"><img class="wp-image-163039" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-8.-The-default-behavior-of-Word-97-when-opening-a-document-containing-a-VBA-macro.png" alt="" width="600" height="253" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-8.-The-default-behavior-of-Word-97-when-opening-a-document-containing-a-VBA-macro.png 774w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-8.-The-default-behavior-of-Word-97-when-opening-a-document-containing-a-VBA-macro-300x126.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-8.-The-default-behavior-of-Word-97-when-opening-a-document-containing-a-VBA-macro-768x323.png 768w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><em>Figure 8. The default behavior of Word 97 when opening a document containing a VBA macro</em></p></div>
<p>This feature continued to be developed in later versions of Office, now probably most familiar via the yellow Message Bar with the “Enable Content” button <a href="https://web.archive.org/web/20120411120021/http:/office.microsoft.com:80/en-us/word-help/enable-or-disable-macros-in-office-files-HA010354316.aspx?CTT=3">introduced in Office 2010</a>:</p>
<div id="attachment_163040" style="width: 610px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-9.-The-Enable-Content-button-in-Excel-2010.png"><img class="wp-image-163040" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-9.-The-Enable-Content-button-in-Excel-2010-300x127.png" alt="" width="600" height="254" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-9.-The-Enable-Content-button-in-Excel-2010-300x127.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-9.-The-Enable-Content-button-in-Excel-2010.png 759w" sizes="(max-width: 600px) 100vw, 600px" /></a><p class="wp-caption-text"><em>Figure 9. The Enable Content button in Excel 2010</em></p></div>
<p>Since then, two clicks have been typically required to enable macros: first, clicking on “Enable Editing”, which removes the document from Protected View, a security feature in place <a href="https://docs.microsoft.com/en-us/archive/blogs/office2010/protected-view-in-office-2010">since Office 2010</a> that provides a read-only, sandboxed environment; second, clicking on “Enable Content”, which allows the macros to run. So long as an admin policy is not in place to prevent recipients from clicking through, the macros successfully load and run.</p>
<p>Although the blocking of macros helped limit the delivery of malware, malicious actors, such as the Emotet operators, adapted their efforts by focusing on duping victims into clicking through to enable macros.</p>
<p>With a <a href="https://docs.microsoft.com/en-us/DeployOffice/security/internet-macros-blocked#versions-of-office-affected-by-this-change" target="_blank" rel="noopener">phased rollout</a> starting in April 2022, Microsoft has been <a href="https://techcommunity.microsoft.com/t5/microsoft-365-blog/helping-users-stay-safe-blocking-internet-macros-by-default-in/ba-p/3071805" target="_blank" rel="noopener">tightening up the default handling</a> of macro-enabled files downloaded from the internet by entirely removing the option to click “Enable Content”. After this change is deployed, macros are still blocked from running as before. So in order to run them, either the data about the file’s zone – sometimes called the Mark of the Web – needs to be removed, or the file has to come from a zone with a higher level of trust than that of the internet. These are much more complex actions to socially engineer recipients into and should thus help stymie future spam campaigns.</p>
<p>Since the increased security benefit offered by this change is only as strong as the Mark of the Web, let’s dive deeper into what it is, how it is used to determine when to block macros from running, and how spammers attempt to bypass it.</p>
<h2>Deterring malware with the Mark of the Web</h2>
<p>The <a href="https://docs.microsoft.com/en-us/previous-versions/windows/internet-explorer/ie-developer/compatibility/ms537628(v=vs.85)" target="_blank" rel="noopener">Mark of the Web</a> refers to the comment added to HTML files (as well as to MHT and XML files) indicating their host URL:</p>
<div id="attachment_163041" style="width: 690px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-10.-Browsers-add-the-Mark-of-the-Web-to-HTML-files-downloaded-from-the-internet.png"><img class="wp-image-163041" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-10.-Browsers-add-the-Mark-of-the-Web-to-HTML-files-downloaded-from-the-internet-300x26.png" alt="" width="680" height="59" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-10.-Browsers-add-the-Mark-of-the-Web-to-HTML-files-downloaded-from-the-internet-300x26.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-10.-Browsers-add-the-Mark-of-the-Web-to-HTML-files-downloaded-from-the-internet-768x67.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-10.-Browsers-add-the-Mark-of-the-Web-to-HTML-files-downloaded-from-the-internet.png 912w" sizes="(max-width: 680px) 100vw, 680px" /></a><p class="wp-caption-text"><em>Figure 10. Browsers add the Mark of the Web to HTML files downloaded from the internet</em></p></div>
<p>This comment is automatically added by the Internet Explorer browser when the HTML file is being saved, or can be added manually by web site developers for testing or by other browsers and applications. The URL is then used to determine the level of trust assigned to the HTML file and any scripts or active content on which the URL might depend.</p>
<p>By default, every URL is treated as coming from the Internet zone: that is, as neither trusted nor untrusted. Although scripts and other active content embedded in the file can automatically run, they cannot access the local file system.</p>
<p>A URL could be added to different zones: the Restricted Sites zone for potentially unsafe content, or the Local Intranet and Trusted Sites zones for trusted content; there is also a Local Machine zone that, although it originally allowed scripts and ActiveX content to run automatically as trusted, was eventually equipped with a lockdown feature that prohibited such automatic execution.</p>
<p>Even before the demise of Internet Explorer, the Mark of the Web was also an informal name for the information about a file’s zone that the <a href="https://en.wikipedia.org/wiki/NTFS" target="_blank" rel="noopener">New Technology File System</a> (NTFS), the default file system of Windows NT-based operating systems, provides in an Alternate Data Stream (ADS). In NTFS, <a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-fscc/c54dec26-1551-4d3a-a0ea-4fa40f848eb3" target="_blank" rel="noopener">every file has an unnamed stream</a> with a stream type of $DATA that contains the expected content of the file when it is opened by a program that can handle its file type:</p>
<div id="attachment_163042" style="width: 910px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-11.-Opening-an-NTFS-file-normally.png"><img class="wp-image-163042" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-11.-Opening-an-NTFS-file-normally-300x62.png" alt="" width="900" height="186" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-11.-Opening-an-NTFS-file-normally-300x62.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-11.-Opening-an-NTFS-file-normally-768x159.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-11.-Opening-an-NTFS-file-normally-1024x212.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-11.-Opening-an-NTFS-file-normally.png 1140w" sizes="(max-width: 900px) 100vw, 900px" /></a><p class="wp-caption-text"><em>Figure 11. Opening an NTFS file normally</em></p></div>
<div id="attachment_163043" style="width: 910px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-12.-The-unnamed-default-stream-of-an-NTFS-file-contains-the-same-data-as-when-the-file-is-opened-normally.png"><img class="wp-image-163043" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-12.-The-unnamed-default-stream-of-an-NTFS-file-contains-the-same-data-as-when-the-file-is-opened-normally-300x14.png" alt="" width="900" height="41" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-12.-The-unnamed-default-stream-of-an-NTFS-file-contains-the-same-data-as-when-the-file-is-opened-normally-300x14.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-12.-The-unnamed-default-stream-of-an-NTFS-file-contains-the-same-data-as-when-the-file-is-opened-normally-768x35.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-12.-The-unnamed-default-stream-of-an-NTFS-file-contains-the-same-data-as-when-the-file-is-opened-normally-1024x47.png 1024w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-12.-The-unnamed-default-stream-of-an-NTFS-file-contains-the-same-data-as-when-the-file-is-opened-normally.png 1140w" sizes="(max-width: 900px) 100vw, 900px" /></a><p class="wp-caption-text"><em>Figure 12. The unnamed (default) stream of an NTFS file contains the same data as when the file is opened normally</em></p></div>
<p>The filename, the stream name, and the stream type are joined and delimited by colons. Thus, in the eyes of NTFS, <span style="font-family: 'courier new', courier, monospace;">filename.txt</span> is equivalent to <span style="font-family: 'courier new', courier, monospace;">filename.txt::$DATA</span>. Notice how there is no stream name, only a file name and a stream type.</p>
<p>On the other hand, the file’s zone is contained in a stream that looks like this: <span style="font-family: 'courier new', courier, monospace;">filename.txt:Zone.Identifier:$DATA</span>. The <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> is a well-known stream name that modern browsers and some other applications automatically add or propagate to files to indicate their zone: the internet, the intranet, the trusted zone, the restricted zone, or the local machine. Some applications, such as the Chrome browser, add the host URL and the referrer URL to the <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> as well:</p>
<div id="attachment_163044" style="width: 810px" class="wp-caption aligncenter"><a href="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-13.-Browsers-can-add-the-Zone.Identifier-stream-to-files-downloaded-from-the-internet-ZoneId3.png"><img class="wp-image-163044" src="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-13.-Browsers-can-add-the-Zone.Identifier-stream-to-files-downloaded-from-the-internet-ZoneId3-300x47.png" alt="" width="800" height="125" srcset="https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-13.-Browsers-can-add-the-Zone.Identifier-stream-to-files-downloaded-from-the-internet-ZoneId3-300x47.png 300w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-13.-Browsers-can-add-the-Zone.Identifier-stream-to-files-downloaded-from-the-internet-ZoneId3-768x120.png 768w, https://www.welivesecurity.com/wp-content/uploads/2022/06/Figure-13.-Browsers-can-add-the-Zone.Identifier-stream-to-files-downloaded-from-the-internet-ZoneId3.png 1009w" sizes="(max-width: 800px) 100vw, 800px" /></a><p class="wp-caption-text"><em>Figure 13. Browsers can add the <span style="font-family: courier new, courier, monospace;">Zone.Identifier</span> stream to files downloaded from the internet (ZoneId=3)</em></p></div>
<p>There are other known techniques to get around the Mark of the Web that the Emotet gang could try as well. It is possible to use container files, such as ISO disk images and VHDX files, or compressed/archive files, such as <span style="font-family: 'courier new', courier, monospace;">.arj</span> and <span style="font-family: 'courier new', courier, monospace;">.gzip</span> files that <a href="https://attack.mitre.org/techniques/T1553/005/" target="_blank" rel="noopener">do not propagate the Mark of the Web to files extracted from them</a>. Ultimately, should one of these techniques yield a satisfactory return on investment, we can expect Emotet to return with force.</p>
<h2>Abusing Alternate Data Streams</h2>
<p>An NTFS file can contain an arbitrary number of streams, meaning these can and have been put to malicious use. For example, the Winnti Group operators <a href="https://www.welivesecurity.com/wp-content/uploads/2019/10/ESET_Winnti.pdf" target="_blank" rel="noopener">stored a malicious, encrypted payload in a stream</a> they named <span style="font-family: 'courier new', courier, monospace;">NULL.DAT</span>. After decryption, the payload was either the PortReuse backdoor or the ShadowPad malware.</p>
<p>When the Turla operators deployed the Gazer backdoor against embassies and consulates around the world in 2016, the backdoor would <a href="https://www.welivesecurity.com/wp-content/uploads/2017/08/eset-gazer.pdf" target="_blank" rel="noopener">hide its files in streams</a> using <a href="https://en.wikipedia.org/wiki/Universally_unique_identifier" target="_blank" rel="noopener">GUIDs</a> as stream names when it couldn’t store them in the Windows registry.</p>
<p>Guildma also used streams as one method of <a href="https://www.welivesecurity.com/2020/03/05/guildma-devil-drives-electric/" target="_blank" rel="noopener">hiding its binary modules</a>, storing multiple files in the streams of a single file. Specifically, Guildma stored all of its malicious modules, including a couple of tools from Nirsoft for extracting saved credentials from popular email clients and web browsers, as the streams of the single <span style="font-family: 'courier new', courier, monospace;">desktop.ini</span> file:</p>
<ul>
<li><span style="font-family: 'courier new', courier, monospace;">desktop.ini:nauwuygiaa.jpg</span> (MailPassView)</li>
<li><span style="font-family: 'courier new', courier, monospace;">desktop.ini:nauwuygiab.jpg</span> (BrowserPassView)…</li>
</ul>
<p>For <a href="https://www.welivesecurity.com/wp-content/uploads/2021/12/eset_jumping_the_air_gap_wp.pdf" target="_blank" rel="noopener">targeting air-gapped networks</a>, malicious actors have used streams to hide malicious components within otherwise innocuous-looking files on USB drives. The streams could contain data being stolen and command-and-control instructions from the malicious operators. Considering that air-gapped networks lack an internet connection, clamping down on the use of USB devices and other portable storage devices travelling in and out of air-gapped networks is crucial for their continued security.</p>
<p>Some malware, like GoBotKR, can <a href="https://www.welivesecurity.com/2019/07/08/south-korean-users-backdoor-torrents/" target="_blank" rel="noopener">remove the <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> stream from files</a> to conceal the fact that they were downloaded from the internet zone. This entirely bypasses any protection that relies solely on the Mark of the Web to determine when to block macros from running.</p>
<p>Finally, spammers like the Emotet developers have taken a social engineering approach, attempting to trick recipients into enabling macros instead of removing the <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> stream or using streams to hide payloads – until now.</p>
<h2>Security tips</h2>
<p>Be aware that some software does not add or propagate the <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> stream, at least not consistently. For example, using 7-Zip to extract a <span style="font-family: 'courier new', courier, monospace;">.exe</span> file from an archive downloaded from the internet does not propagate the archive’s <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> to its contents, meaning that there is no Mark of the Web to trigger any security blocks or warnings if any of the extracted files are run. The <span style="font-family: 'courier new', courier, monospace;">Zone.Identifier</span> is propagated, however, by double-clicking on the <span style="font-family: 'courier new', courier, monospace;">.exe</span> from within the archive.</p>
<p>In light of the removal of the “Enable Content” button, a handy list that tracks whether file archivers support the Mark of the Web has been compiled in GitHub <a href="https://github.com/nmantani/archiver-MOTW-support-comparison" target="_blank" rel="noopener">here</a>.</p>
<p>For organizations that rely on macros as part of employees’ workflows, IT admins may need to <a href="https://docs.microsoft.com/en-us/DeployOffice/security/internet-macros-blocked#use-policies-to-manage-how-office-handles-macros">adjust the policies</a> for how Office handles macros. Furthermore, organizations should take advantage of this opportunity to review their security stance against threats vectoring via email with the following:</p>
<ul>
<li>Use an email security solution that can block phishing, spam, and other malicious emails from reaching inboxes.</li>
<li>Run phishing simulation exercises to test and renew employees’ security awareness.</li>
<li>Consider deploying a detection and response solution that can help track down whether the root cause of a cyberattack on your network was a malicious email or a different vector.</li>
</ul>
<p>The impending close of the era of the “Enable Content” button has two consequences. First, that users can expect better protection against malicious macros delivered via email. Second, that spammers like Emotet are adapting their favorite tactics to dupe their future victims. Should any of these experiments prove successful, we can expect new malicious campaigns to hit inboxes, meaning that continued vigilance for email-based threats should remain top of mind.</p>
<div class="update-block"><strong><em>Further reading:</em></strong><br />
<em><a href="https://www.welivesecurity.com/2022/06/02/eset-threat-report-t12022/">ESET Threat Report T 1 2022</a></em><br />
<em><a href="https://www.welivesecurity.com/2021/01/28/emotet-botnet-disrupted-global-operation/">Emotet botnet disrupted in global operation</a></em><br />
<em><a href="https://www.eset.com/blog/consumer/emotet-botnet-hits-quiet-patch-before-black-friday-the-calm-before-the-storm/">Emotet botnet hits quiet patch before Black Friday – the calm before the storm?</a></em><br />
<em><a href="https://www.welivesecurity.com/2020/09/16/emotet-quebec-department-justice-eset/">Emotet strikes Quebec’s Department of Justice: An ESET Analysis</a></em><br />
<em><a href="https://www.welivesecurity.com/2018/12/28/analysis-latest-emotet-propagation-campaign/">Analysis of the latest Emotet propagation campaign</a></em><br />
<em><a href="https://www.welivesecurity.com/2018/11/23/black-friday-special-emotet-filling-inboxes-infected-xml-macros/">Black Friday and Cyber Monday by Emotet: Filling inboxes with infected XML macros</a></em><br />
<em><a href="https://www.eset.com/blog/enterprise/emotet-trojan-frustrated-by-eset-protection/">Emotet trojan frustrated by ESET protection</a></em><br />
</div>

                            
                                                            <div class="dot">
                                    <span class="icomoon icon-icon_article_dot"></span>
                                </div>

                                <div class="meta">
                                    <div class="wls-authors wls-authors-footer">
                                                <div class="wls-author">
                        <div class="wls-author-name">
                <a href="https://www.welivesecurity.com/author/rholt/" title="Rene Holt">
                    Rene Holt                </a>
            </div>
        </div>
                                            </div>
                                    <span class="strong">
								        <time datetime="2022-06-16 11:30:53">16 Jun 2022 - 11:30AM</time>
                                    </span>
                                </div>
                            
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text"><em>Sign up to receive an email update whenever a new article is published in our <a href="https://www.welivesecurity.com/category/ukraine-crisis-digital-security-resource-center/" target="_blank" rel="noopener">Ukraine Crisis – Digital Security Resource Center</a></em></span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="TOPIC" value="We Live Security Ukraine Newsletter">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="button-flag">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>
                                <div class="widgets row">
        <div class="col-md-12 col-sm-12 col-xs-12">
            <div class="heading-line col-md-12 col-sm-12 col-xs-12 no-padding">
                <h3><span class="text">Newsletter</span></h3>
            </div>
        </div>
        <div class="col-md-6 col-sm-6 col-xs-12 newsletter-wrapper">
            <form action="https://enjoy.eset.com/pub/rf" class="basic-searchform col-md-12 col-sm-12 col-xs-12 no-padding newsletter" method="post" role="search">
                <div class="search-input clearfix">
                    <input type="text" name="EMAIL_ADDRESS_" value="" placeholder="Email...">
                    <input type="hidden" name="NEWSLETTER" value="We Live Security">

                    <input type="hidden" name="_ri_" value="X0Gzc2X%3DAQpglLjHJlTQGgXv4jDGEK4KW2uhw0qgUzfwuivmOJOPCgzgo9vsI3VwjpnpgHlpgneHmgJoXX0Gzc2X%3DAQpglLjHJlTQGzbD6yU2pAgzaJM16bkTA7tOwuivmOJOPCgzgo9vsI3">
                    <input type="hidden" name="_ei_" value="Ep2VKa8UKNIAPP_2GAEW0bY">
                    <input type="hidden" name="_di_" value="m0a5n0j02duo9clmm4btuu5av8rdtvqfqd03v1hallrvcob47ad0">
                    <input type="hidden" name="EMAIL_PERMISSION_STATUS_" value="O">
                    <input type="hidden" name="CONTACT_SOURCE_MOST_RECENT" value="WLS_Subscribe_Form">
                    <button class="">
                        Submit                    </button>
                </div>
            </form>
        </div>
    </div>

                                                            <div class="similar-articles row">
                                    <div class="heading-line col-md-12 col-sm-12 col-xs-12">
                                        <h3><span class="text">Similar Articles</span></h3>
                                    </div>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/eset-research/" class="category-tag-btn">ESET Research</a>                                                <a href="https://www.welivesecurity.com/2022/01/25/watering-hole-deploys-new-macos-malware-dazzlespy-asia/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2022/01/dazzlespy-malware-macos-623x415.jpg"
                                                         alt="How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2022/01/25/watering-hole-deploys-new-macos-malware-dazzlespy-asia/">
                                                    Watering hole deploys new macOS malware, DazzleSpy, in Asia                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/10/15/virus-bulletin-old-malware-never-dies-gets-more-targeted/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/10/virus-bulletin-old-malware-targeted-attacks-623x415.jpg"
                                                         alt="How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/10/15/virus-bulletin-old-malware-never-dies-gets-more-targeted/">
                                                    Virus Bulletin: Old malware never dies – it just gets more targeted                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/07/wls_anatomy-iis-malware-2021_1770540524_1000x667-623x432.jpg"
                                                         alt="How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/08/06/anatomy-native-iis-malware/">
                                                    Anatomy of native IIS malware                                                </a>
                                            </h4>
                                        </article>
                                                                            <article class="col-md-3 col-sm-3 col-xs-3">
                                            <div class="img-wrapper">
                                                <a href="https://www.welivesecurity.com/category/malware/" class="category-tag-btn">Malware</a>                                                <a href="https://www.welivesecurity.com/2021/07/20/url-shortener-services-android-malware-banking-sms-trojans/"
                                                   class="related-article-thumb">
                                                    <img class="col-xs-12 no-padding clickable"
                                                         src="https://www.welivesecurity.com/wp-content/uploads/2021/07/Android-URL-shortener-1-623x432.jpg"
                                                         alt="How Emotet is changing tactics in response to Microsoft’s tightening of Office macro security">
                                                </a>
                                            </div>
                                            <h4>
                                                <a href="https://www.welivesecurity.com/2021/07/20/url-shortener-services-android-malware-banking-sms-trojans/">
                                                    Some URL shortener services distribute Android malware, including banking or SMS trojans                                                </a>
                                            </h4>
                                        </article>
                                                                    </div>
                            
                            <div class="comments row">
                                <div class="heading-line col-xs-12">
                                    <h3><span class="text">Discussion</span></h3>
                                                                            
<div id="disqus_thread"></div>
                                                                    </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    	</div> 	<footer id="site-footer">
		<div class="container">
			<div class="row">
				<div class="col-md-2">
                    <div class="hidden-sm hidden-xs">
                        <div class="logo-wrapper footer clearfix">
                            <div class="dark clearfix">
                                <a href="https://www.welivesecurity.com/" class="wls">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-1.svg" alt="Welivesecurity.com">
                                </a>
                                <a href="https://www.eset.com" class="eset">
                                    <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-footer-2.svg" alt="by ESET">
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="hidden-lg hidden-md">
                        <div class="logo-wrapper clearfix">
    <div class="dark clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-dark-header-2.svg" alt="by ESET">
        </a>
    </div>
    <div class="light clearfix">
        <a href="https://www.welivesecurity.com/" class="wls">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-1.svg" alt="Welivesecurity.com">
        </a>
        <a href="https://www.eset.com" class="eset">
            <img src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/img/new-logo/eset-wls-light-header-2.svg" alt="by ESET">
        </a>
    </div>
</div>                    </div>
				</div>
				<nav id="footer" class="clearfix">
											<div class="mobile-block">
																<div class="col-md-2 col-md-offset-2">
										<ul>
																							<li>
													<a href="/">Home</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/about-us/">About Us</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/contact-us/">Contact Us</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/sitemap/">Sitemap</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/our-experts/">Our Experts</a>
												</li>
																							<li>
													<a href="https://eset.com">ESET</a>
												</li>
																					</ul>
									</div>
													</div>
											<div class="mobile-block">
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/research/">Research</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/category/how-to/">How To</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/categories/">Categories</a>
												</li>
																					</ul>
									</div>
																<div class="col-md-2 ">
										<ul>
																							<li>
													<a href="https://www.welivesecurity.com/rss-configurator/">RSS Configurator</a>
												</li>
																							<li>
													<a href="https://www.welivesecurity.com/news-widget-generator/">News Widget</a>
												</li>
																					</ul>
									</div>
													</div>
									</nav>
			</div>
			<div class="row">
				<div class="col-md-12 legal clearfix">
					<div class="wrap clearfix">
													<span>
								<a href="https://www.welivesecurity.com/privacy/">
									Privacy Policy								</a>
							</span>
													<span>
								<a href="https://www.welivesecurity.com/legal-information/">
									Legal Information								</a>
							</span>
											</div>
					<span class="copyright pull-right">Copyright &copy; ESET, All Rights Reserved</span>
				</div>
							</div>
		</div>
	</footer>
	
	<button id="back-to-top" class="animated-scroll" data-target="absoluteTop">
		<span class="icomoon icon-icon_arrow"></span>
		<span class="text">Back to top</span>
	</button>

			<div class="social-wrapper-mobile hidden-lg hidden-md hidden-sm" id="mobile-article-sharer">
			<div class="col-xs-12">
				<div class="icons" style="text-align: center;">
											<a class="share-facebook" href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F06%2F16%2Fhow-emotet-is-changing-tactics-microsoft-tightening-office-macro-security%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Facebook">
							<span class="icomoon icon-icon_fb"></span>
						</a>
											<a class="share-twitter" href="https://twitter.com/intent/tweet?https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F06%2F16%2Fhow-emotet-is-changing-tactics-microsoft-tightening-office-macro-security%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Twitter">
							<span class="icomoon icon-icon_tw"></span>
						</a>
											<a class="share-linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.welivesecurity.com%2F2022%2F06%2F16%2Fhow-emotet-is-changing-tactics-microsoft-tightening-office-macro-security%2F" target="blank" data-toggle="tooltip" data-placement="top" data-original-title="Share on Linkedin">
							<span class="icomoon icon-icon_in"></span>
						</a>
									</div>
			</div>
		</div>
	
	<script>
		var baseUrl = "https://www.welivesecurity.com/";
	</script>
	
			<script>
            !function(){if(-1==window.document.cookie.indexOf("user_rec=1")){function e(e,o){var t=document.createElement("img");t.setAttribute("style","display:none"),t.src=e+o,window.document.body.appendChild(t)}function o(){d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Default%20status&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=defaultStatus&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c)}function t(){console.log("GA and GTM are loaded."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=11",e(u,a),e(s,c)}function n(){var e=new Date;e.setTime(e.getTime()+63072e6);var o="expires="+e.toUTCString();window.document.cookie="user_rec=1; "+o+"; path=/"}var d,a,c,i,r,l="UA-76266002-27",g=window.location.href,s="https://cdn1.esetstatic.com/ESET/INT/assets/img/check.png",u="https://www.google-analytics.com/collect",w="wls",m=0,h=function e(){i=window.ga&&ga.create?1:0,r=window.google_tag_manager?1:0,m++,console.log("Timer: ",m),h=setTimeout(e,500)};window.document.addEventListener&&(d=1e6*Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=Script%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=scriptLoaded&z="+Math.floor(1e6*Math.random(0,1)),e(u,a),e(s,c),window.addEventListener("beforeunload",o),window.ga&&ga.create&&window.google_tag_manager?(t(),window.removeEventListener("beforeunload",o),n()):(setTimeout(h,500),setTimeout(function(){clearTimeout(h),i&&r?t():i&&!r?(console.log("GA is loaded and GTM is blocked."),d=ga.getAll()[0].get("clientId"),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20loaded,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=10",e(u,a),e(s,c)):!i&&r?(console.log("GA is blocked and GTM is loaded."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20loaded&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=01",e(u,a),e(s,c)):i||r||(console.log("GA is blocked and GTM is blocked."),d||Math.random(1e6,9999999),a="?v=1&cid="+d+"&tid="+l+"&dl="+g+"&t=event&ec=Tracking%20check%20-%20recurring&ea=GA%20blocked,%20GTM%20blocked&ni=1&cd1="+w+"&aip=1&z="+Math.floor(1e6*Math.random(0,1)),c="?country=wls&gcode=00",e(u,a),e(s,c)),window.removeEventListener("beforeunload",o),n()},1e4)))}}();
		</script>
	
	<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/js/main.js?id=fef3139dcedd23afc232"></script>
    <!-- Version: v1.9.0.9dc53e.pro.awus -->
    		<script type="text/javascript">
			var disqus_config = function () { 
				this.language = "en";
			};
			var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":"", "numsVisible": false};
			var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
		</script>
		<script src="https://www.welivesecurity.com/wp-content/themes/eset-wls-2018/assets/static/js/crayon.min.js"></script>

			
		
    <script>
    	Main.init();
    </script>

    <script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"welivesecurity"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"162997 https:\/\/backend.welivesecurity.com\/?p=162997","disqusShortname":"welivesecurity","disqusTitle":"How Emotet is changing tactics in response to Microsoft\u2019s tightening of Office macro security","disqusUrl":"https:\/\/www.welivesecurity.com\/2022\/06\/16\/how-emotet-is-changing-tactics-microsoft-tightening-office-macro-security\/","postId":"162997"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.welivesecurity.com/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
    <script src="https://assets.esetstatic.com/3PR/app.min.js"></script>
  </body>
</html>
